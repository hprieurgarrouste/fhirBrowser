(()=>{"use strict";var __webpack_modules__={616:(e,t,o)=>{o.d(t,{Z:()=>a});var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link href="'+i()(r)+'" rel="stylesheet"/> <style>#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}#bundleCnt{display:flex;flex-direction:column;height:100%;flex:auto;width:0}main{flex:1 1 auto;height:0;border-top:1px solid var(--border-color);border-bottom:1px solid var(--border-color)}#title{margin:0;overflow:hidden;text-overflow:ellipsis}#title::first-letter{text-transform:uppercase}#table{flex:auto}bundle-search-panel{border-left:1px solid var(--border-color);flex:none;transition:all .3s;width:400px}bundle-search-panel.hidden{transition:all .3s;margin-right:-400px}@media (max-width:480px){bundle-search-panel{background-color:var(--background-color,#fff);position:relative;width:100%}bundle-search-panel.hidden{margin-right:-100%}}</style> <div id="wrapper"> <div id="bundleCnt"> <header> <app-bar> <round-button id="help" title="Help" data-icon="help" slot="left"></round-button> <h3 slot="middle" id="title">Bundle</h3> <div class="toolbar" slot="right"> <round-button id="settingsDialogToggle" title="Settings" data-icon="view_column"></round-button> <round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></round-button> <round-button id="download" title="Download" data-icon="download"></round-button> <round-button id="searchToggle" title="Search" data-icon="search"></round-button> </div> </app-bar> </header> <main> <data-table id="table"></data-table> </main> <footer> <data-table-pagination id="pagination"> <round-button slot="arrows" id="paginationFirst" title="first" data-icon="first_page" disabled="disabled"></round-button> <round-button slot="arrows" id="paginationPrevious" title="previous" data-icon="chevron_left" disabled="disabled"></round-button> <round-button slot="arrows" id="paginationNext" title="next" data-icon="chevron_right" disabled="disabled"></round-button> <round-button slot="arrows" id="paginationLast" title="last" data-icon="last_page" disabled="disabled"/> </data-table-pagination> </footer> </div> <bundle-search-panel id="search" class="hidden"></bundle-search-panel> </div> <bundle-columns-dialog hidden></bundle-columns-dialog>'},466:(e,t,o)=>{o.d(t,{Z:()=>s});const s='<style>main{display:flex;flex-direction:row;height:100%;overflow:hidden}#form{flex:1 1 auto;overflow:auto;padding:1em}#form fieldset{border:0;padding:0}#form fieldset>input[type=text]{border:0 none;font-family:inherit;font-size:inherit;margin-bottom:1em;background-color:inherit}#form section{display:flex;flex-flow:row wrap;align-content:flex-start;gap:.2em 1em;border:0 none;background-color:inherit;min-height:50px}#form section.over,#form text-field.over,#form.drag fieldset.over,#form.drag.over{border:1px dashed #000;background-color:var(--hover-color,rgb(0 0 0 / 4%))}side-panel{border-left:1px solid var(--border-color)}</style> <main> <section id="form"></section> <side-panel data-title="Data" data-closable="false"> <linear-progress slot="main"></linear-progress> <app-list slot="main"></app-list> </side-panel> </main>'},612:(e,t,o)=>{o.d(t,{Z:()=>s});const s='<style>main{display:flex;flex-direction:column;height:100%}#form{flex:1 1 auto;height:auto;padding:1em;overflow-y:auto}#form fieldset{border:0;padding:0}#form legend{margin-bottom:1em;text-transform:lowercase}#form legend::first-letter{text-transform:uppercase}#form section{display:flex;flex-flow:row wrap;align-content:flex-start;gap:.2em 1em;border:0 none;background-color:inherit;min-height:50px}p{text-align:center;position:absolute;top:50%;left:50%;transform:translateX(-50%) translateY(-50%);color:var(--text-color-disabled)}</style> <main> <section id="form"></section> </main>'},91:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},131:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _templates_Bundle_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(616),_components_AppBar__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(856),_components_DataTable__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(699),_components_DataTablePagination__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(39),_components_LinearProgress__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(196),_BundleSearchPanel__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(675),_BundleColumnsDialog__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(566),_services_Fhir__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(916),_services_Snackbars__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(332),_services_Preferences__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(571);class Bundle extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_templates_Bundle_html__WEBPACK_IMPORTED_MODULE_0__.Z,this._resourceType=null,this._skip=0,this._pageSize=20,this._count=null,this._columns=null,this._filters=[],this._page=null,this._dateOptions={year:"numeric",month:"2-digit",day:"2-digit"},this._timeOptions={hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"},this._columnsDialog=null,this._source=null}connectedCallback(){this._shadow.getElementById("help").onclick=this.helpClick,this._shadow.querySelector("data-table-pagination").onclick=this.paginationClick;const e=this._shadow.getElementById("table");e.addEventListener("rowclick",this.onRowClick),e.onColumnReorder=this.handleColumnChanged,this._shadow.getElementById("searchToggle").addEventListener("click",(()=>{this._shadow.getElementById("search")?.classList.toggle("hidden")})),this._shadow.getElementById("copy").onclick=this.copyClick,this._shadow.getElementById("download").onclick=this.downloadClick,this._columnsDialog=this._shadow.querySelector("bundle-columns-dialog"),this._columnsDialog.onValidate=this.handleColumnSetup,this._shadow.getElementById("settingsDialogToggle").onclick=this.settingsDialogToggleClick}onRowClick=({detail:e})=>{const t=this._source.entry.find((({resource:t})=>t.id==e.resourceId));if(t){const e=t.fullUrl.replace(`${_services_Fhir__WEBPACK_IMPORTED_MODULE_7__.t.server.url}`,"");location.hash=`#${e}`}};handleColumnSetup=e=>{let t=this._columns.filter((t=>e.includes(t)));t.push(...e.filter((e=>!t.includes(e)))),this.handleColumnChanged(t)};handleColumnChanged=e=>{this._columns=e;const t=this._shadow.getElementById("table");t.clear(),this._columns.forEach((e=>t.addColumn(e))),this.parsePage(this._source);const o=_services_Preferences__WEBPACK_IMPORTED_MODULE_9__.y.get("columns",{});o[this._resourceType.type]=this._columns,_services_Preferences__WEBPACK_IMPORTED_MODULE_9__.y.set("columns",o)};settingsDialogToggleClick=()=>{this._columnsDialog.load(this._resourceType.type,this._columns),this._columnsDialog.hidden=!1};paginationClick=({target:e})=>{if("ROUND-BUTTON"!=e.nodeName)return;let t=e.dataset.url;t=t.replace(`${_services_Fhir__WEBPACK_IMPORTED_MODULE_7__.t.server.url}`,""),location.hash=`#${t}`};helpClick=()=>{window.open(_services_Fhir__WEBPACK_IMPORTED_MODULE_7__.t.helpUrl(this._resourceType.type),"FhirBrowserHelp")};copyClick=()=>{navigator.clipboard.writeText(JSON.stringify(this._page)).then((function(){_services_Snackbars__WEBPACK_IMPORTED_MODULE_8__.h.show("Copying to clipboard was successful")}),(function(e){console.error("Async: Could not copy text: ",e)}))};downloadClick=()=>{const e=`${this._resourceType.type}-${this._skip}`,t=new File([JSON.stringify(this._page)],e,{type:"data:text/json;charset=utf-8"}),o=URL.createObjectURL(t),s=document.createElement("a");s.href=o,s.download=`${e}.json`,this._shadow.appendChild(s),s.click(),this._shadow.removeChild(s),window.URL.revokeObjectURL(o)};get resourceType(){return this._resourceType}beautifyDate(e){const t=new Date(e);try{return`${t.toLocaleString(void 0,this._dateOptions)}<br>${t.toLocaleString(void 0,this._timeOptions)}`}catch(t){return e}}parsePage(data){if(data.entry){const dataTable=this._shadow.getElementById("table");data.entry.forEach((entry=>{let row={};this._columns.forEach((column=>{let value=entry.resource,path=column.split(".");path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx==path.length-1?value.join(", "):value[0]),!0)))),"meta.lastUpdated"===column&&(value=this.beautifyDate(value)),row[column]=value||""})),dataTable.addRow(entry.resource.id,row)}));const buttons={first:this._shadow.getElementById("paginationFirst"),previous:this._shadow.getElementById("paginationPrevious"),prev:this._shadow.getElementById("paginationPrevious"),next:this._shadow.getElementById("paginationNext"),last:this._shadow.getElementById("paginationLast")};Object.entries(buttons).forEach((([,e])=>{e.setAttribute("disabled",""),e.removeAttribute("data-relation"),e.removeAttribute("data-url")})),data.link?.forEach((({relation:e,url:t})=>{buttons[e]?.removeAttribute("disabled"),buttons[e]?.setAttribute("data-relation",e),buttons[e]?.setAttribute("data-url",t)}))}}set source(e){let t,o=!1;if(e.entry?.length){const s=[...new Set(e.entry.map((e=>e.resource.resourceType)))];o=1==s.length,t=o?s[0]:"Bundle"}else{const e=window.location.hash.replace("#/","").trim();t=RegExp(/^\w+/).exec(e)[0]}this._resourceType=_services_Fhir__WEBPACK_IMPORTED_MODULE_7__.t.server.capabilities.rest[0].resource.find((e=>e.type===t));let s=t;if(o){const e=_services_Preferences__WEBPACK_IMPORTED_MODULE_9__.y.get("columns",{});this._columns=e[t]||["id","meta.lastUpdated"],this._shadow.getElementById("settingsDialogToggle").hidden=!1,this._shadow.getElementById("search").hidden=!1}else this._shadow.getElementById("settingsDialogToggle").hidden=!0,this._shadow.getElementById("search").hidden=!0,this._columns=["resourceType","id"],"Bundle"==t&&(s=`${e.type} ${s.toLowerCase()}`);this._shadow.getElementById("title").innerText=s;const i=this._shadow.getElementById("table");i.clear(),this._columns.forEach((e=>i.addColumn(e))),this._source=e,this.parsePage(e)}}customElements.define("fhir-bundle",Bundle)},566:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link rel="stylesheet" href="'+i()(r)+'"> <style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}footer{border-top:1px solid var(--border-color);padding:.5em 1em;text-align:right;overflow:hidden}</style> <app-dialog id="settingsDialog" data-title="Settings"> <main> <linear-progress></linear-progress> <app-list></app-list> <footer> <app-button id="btnCancel" value="Cancel"></app-button> <app-button id="btnOk" value="Apply"></app-button> </footer> </main> </app-dialog>';o(627),o(937),o(251),o(196),o(72);class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{padding:.5em 1em;background-color:inherit;display:flex;flex-direction:row;align-items:center}main:hover,main[selected]{background-color:var(--hover-color,rgba(0,0,0,5%))}div{flex-grow:1}input[type=checkbox]{margin-left:1em}</style> <main> <div> <slot></slot> </div> <input type="checkbox"> </main>'}static get observedAttributes(){return["selected"]}attributeChangedCallback(e,t,o){"selected"===e&&(this._shadow.querySelector("input[type=checkbox]").checked=null!==o)}connectedCallback(){this.onclick=e=>{null!==this.getAttribute("selected")?this.removeAttribute("selected"):this.setAttribute("selected","")}}}customElements.define("list-row-check",n);var l=o(916);class d extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=a,this._resourceType=null,this._release=null,this._onValidate=()=>{},this._list=null}connectedCallback(){this._shadow.querySelector("app-dialog").onClose=this.appDialogClose,this._list=this._shadow.querySelector("app-list"),this._list.onFilter=this.appListFilter,this._shadow.getElementById("btnCancel").onclick=this.btnCancelClick,this._shadow.getElementById("btnOk").onclick=this.btnOkClick}btnOkClick=e=>{e.preventDefault(),e.stopPropagation(),this.hidden=!0;const t=Array.from(this._list.querySelectorAll("list-row-check[selected]")).map((e=>e.dataset.id));this._onValidate(t)};btnCancelClick=()=>{this.hidden=!0};appListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!e.dataset.id.toLowerCase().includes(t)}))};appDialogClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};get onValidate(){return this._onValidate}set onValidate(e){this._onValidate=e}checkValues=e=>{Array.from(this._list.querySelectorAll("list-row-check")).forEach((t=>{e.includes(t.dataset.id)?t.setAttribute("selected",""):t.removeAttribute("selected")}))};load=(e,t)=>{e!==this._resourceType||l.t.release!==this._release?(this._resourceType=e,this._release=l.t.release,this._list.clear(),this._shadow.querySelector("linear-progress").hidden=!1,function e(t,o){return new Promise((s=>{const i=[];l.t.structureDefinition(t).then((t=>{const r=[];t.snapshot.element.filter((e=>e.isSummary&&e.type)).forEach((t=>{const s=t.path.substr(t.path.indexOf(".")+1);if(!o.includes(`${s}.`)){const a=(o?`${o}.`:"")+s,n=t.type[0].code;n.match(/^([A-Z][a-z]+)+$/)?r.push(e(n,a)):i.push({id:a,path:a,short:t.short,type:n})}})),r.length>0?Promise.all(r).then((e=>{e.forEach((e=>i.push(...e))),s(i)})):s(i)}))}))}(e,"").then((e=>{e.sort(((e,t)=>e.path.localeCompare(t.path))),e.forEach((e=>{const t=document.createElement("list-item");t.setAttribute("data-primary",e.path),t.setAttribute("data-secondary",e.short);const o=document.createElement("list-row-check");o.setAttribute("data-id",e.id),o.appendChild(t),this._list.appendChild(o)})),this._shadow.querySelector("linear-progress").hidden=!0,this.checkValues(t)}))):this.checkValues(t)}}customElements.define("bundle-columns-dialog",d)},675:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link rel="stylesheet" href="'+i()(r)+'"> <style>section{display:flex;flex-direction:column;height:100%}main{border-bottom:1px solid var(--border-color);padding:.5em;overflow:hidden auto;flex:1 1 auto;height:0}footer{padding:9px 16px;text-align:center;overflow:hidden}@media (max-width:480px){.surface{left:0;right:unset;width:100%;max-width:unset;max-height:unset}.overlay{background-color:transparent}}</style> <side-panel data-title="Search"> <round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></round-button> <round-button id="clear" title="Clear" data-icon="clear_all" slot="appBarRight"></round-button> <section slot="main"> <main></main> <footer> <app-button id="apply" value="Search"></app-button> </footer> </section> </side-panel>';o(914);class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray;display:flex;flex-direction:row;flex-wrap:wrap}main:focus-within,main:focus-within input{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:4px 5px;max-width:120px;min-width:100px}input:focus{outline:0}</style> <main> <input type="date"> <input type="time"> </main>'}get value(){const e=this._shadow.querySelector('input[type="date"]');if(e.value){const t=this._shadow.querySelector('input[type="time"]');let o=new Date(`${e.value}T${t.value||"00:00"}`);return new Date(o.getTime()).toISOString()}return null}set value(e){this._shadow.querySelector('input[type="date"]').value="",this._shadow.querySelector('input[type="time"]').value=""}}customElements.define("bundle-search-date",n);class l extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px;width:90px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input placeholder="Modifier" list="FhirSearchFieldModifierList"> <datalist id="FhirSearchFieldModifierList"> <option value="contains"></option> <option value="exact"></option> </datalist> </main>'}get value(){return this._shadow.querySelector("input").value}set value(e){this._shadow.querySelector("input").value=e}}customElements.define("bundle-search-modifier",l);class d extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px;width:90px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input placeholder="Prefix" list="FhirSearchPrefixList"> <datalist id="FhirSearchPrefixList"> <option value="eq">Is equal to</option> <option value="ne">is not equal to</option> <option value="gt">is greater than</option> <option value="lt">is less than</option> <option value="ge">is greater or equal to</option> <option value="le">is less or equal to</option> </datalist> </main>'}get value(){return this._shadow.querySelector("input").value}set value(e){this._shadow.querySelector("input").value=e}}customElements.define("bundle-search-prefix",d);class c extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray;display:flex}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input type="text" spellcheck="false"> </main>'}connectedCallback(){let e=this.getAttribute("placeholder");e&&this._shadow.querySelector("input").setAttribute("placeholder",e)}get value(){return this._shadow.querySelector("input").value}set value(e){this._shadow.querySelector("input").value=e}}customElements.define("bundle-search-text",c);class h extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{margin-bottom:1em}fieldset{display:flex;flex-direction:row;border:none;padding:0;gap:1em}fieldset:focus-within legend{font-weight:700;color:var(--primary-color)}bundle-search-date,bundle-search-text{flex:auto}span{color:var(--text-color-disabled);font-size:small;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;padding-top:2px}</style> <main> <fieldset> <legend inert></legend> <slot></slot> </fieldset> <span inert></span> </main>"}clear(){this._shadow.querySelectorAll("bundle-search-text, bundle-search-date, bundle-search-modifier, bundle-search-prefix").forEach((e=>e.value=""))}set value(e){let t;const o=e.value.split("|"),s=e.name.split(":");switch(this._search.type){case"token":t=this._shadow.querySelector("bundle-search-text:not([data-type])"),o[1]?(this._shadow.querySelector('bundle-search-text[data-type="system"]').value=o[0],t.value=o[1]):t.value=o[0];break;case"string":case"reference":s[1]&&(this._shadow.querySelector("bundle-search-modifier").value=s[1]),t=this._shadow.querySelector("bundle-search-text"),t.value=e.value}}get value(){let e;switch(this._search.type){case"token":let t="";const o=this._shadow.querySelector('bundle-search-text[data-type="system"]');return o?.value&&(t=`${o.value}|`),e=this._shadow.querySelector("bundle-search-text:not([data-type])"),e?.value&&(t+=e.value),t?{name:this._search.name,value:t}:null;case"string":case"reference":if(e=this._shadow.querySelector("bundle-search-text"),e?.value){let t=this._search.name;const o=this._shadow.querySelector("bundle-search-modifier");return o?.value&&(t+=`:${o.value}`),{name:t,value:e.value}}break;case"date":case"datetime":if(e=this._shadow.querySelector("bundle-search-date"),e?.value){let t=e.value;const o=this._shadow.querySelector("bundle-search-prefix");return o?.value&&(t=o.value+t),{name:this._search.name,value:t}}}return null}get name(){return this._search.name}init(e){function t(e,t){let s=document.createElement("bundle-search-text");s.setAttribute("name",e.name),t&&s.setAttribute("placeholder",t),o.appendChild(s)}if("_format"===e.name)return!1;this._search=e,this._shadow.querySelector("legend").innerText=e.name,this._shadow.querySelector("span").innerText=e.documentation||"";const o=this._shadow.querySelector("fieldset");let s;if("_id"==e.name)t(e);else if("_filter"==e.name)t(e);else switch(e.type){case"token":!function(e){let t=document.createElement("bundle-search-text");t.setAttribute("placeholder","System"),t.setAttribute("data-type","system"),t.setAttribute("name",e.name),o.appendChild(t)}(e),t(e,"code");break;case"string":case"reference":!function(e){let t=document.createElement("bundle-search-modifier");t.setAttribute("data-name",e.name),o.appendChild(t)}(e),t(e);break;case"date":case"datetime":s=document.createElement("bundle-search-prefix"),s.setAttribute("data-name",e.name),o.appendChild(s),s=document.createElement("bundle-search-date"),s.setAttribute("name",e.name),o.appendChild(s);break;default:return!1}return!0}}customElements.define("bundle-search-item",h);var u=o(916);class p extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=a,this._resourceType=null}connectedCallback(){window.addEventListener("hashchange",this.locationHandler),this._shadow.querySelector("side-panel").onClose=this.sidePanelClose,this._shadow.getElementById("clear").addEventListener("click",this.clearClick),this._shadow.getElementById("help").addEventListener("click",this.helpClick),this._shadow.getElementById("apply").addEventListener("click",this.applyClick),this._shadow.querySelector("main").addEventListener("keydown",this.mainKeyDown),this.locationHandler()}mainKeyDown=e=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||this.applyClick(e)};applyClick=e=>{e.preventDefault(),e.stopPropagation(),window.matchMedia("(max-width: 480px)").matches&&this.classList.add("hidden");const t=[];this._shadow.querySelector("main").querySelectorAll("bundle-search-item").forEach((({value:e})=>{e&&t.push(`${e.name}=${encodeURIComponent(e.value)}`)})),location.hash=`#/${this._resourceType.type}?${t.length?t.join("&")+"&":""}_summary=true&_format=json&_count=20`};helpClick=e=>{window.open(u.t.helpUrl("search"),"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};clearClick=e=>{this.clear(),e.preventDefault(),e.stopPropagation()};sidePanelClose=e=>{this.classList.add("hidden"),e.preventDefault(),e.stopPropagation()};locationHandler=async()=>{let e=window.location.hash.replace("#/","").trim();if(!e||e.indexOf("/")>0)return;const t=e.split("?")[0];if(!t)return;for(;!u.t.server;)await s(1e3);const o=u.t.server.capabilities.rest[0].resource.find((e=>e.type===t));if(o){o.type!==this._resourceType?.type&&(this._resourceType=o,this.metadata=o),this.clear();const t=this._shadow.querySelector("main"),s=new URLSearchParams(e.replace(/^[^?]+\?/,""));Array.from(s).forEach((([e,o])=>{const s=e.split(":")[0],i=t.querySelector(`bundle-search-item[data-name="${s}"`);i&&(i.value={name:e,value:o})}))}function s(e){return new Promise((t=>{setTimeout(t,e)}))}};clear(){this._shadow.querySelector("main").querySelectorAll("bundle-search-item").forEach((e=>e.clear()))}set metadata(e){const t=this._shadow.querySelector("main");for(t.scrollTop=0;t.firstChild;)t.removeChild(t.lastChild);e?.searchParam.sort(((e,t)=>e.name.localeCompare(t.name))).forEach((e=>{const o=document.createElement("bundle-search-item");o.init(e)&&(o.setAttribute("data-name",e.name),t.appendChild(o))}))}}customElements.define("bundle-search-panel",p)},664:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _templates_ResourceTemplateEditor_html__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(466),_components_AppList__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(251),_components_SidePanel__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(59),_components_TextField__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(719),_services_Fhir__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(916);class ResourceTemplateEditor extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_templates_ResourceTemplateEditor_html__WEBPACK_IMPORTED_MODULE_4__.Z,this._resource=null,this._dragSrcEl=null,this._template=null}connectedCallback(){this._template=this._shadow.getElementById("form");const e=this._shadow.querySelector("main");e.ondragstart=this.onDragStart,e.ondragover=this.onDragOver,e.ondragenter=this.onDragEnter,e.ondragleave=this.onDragLeave,e.ondragend=this.onDragEnd,e.ondrop=this.onDragDrop,this._list=this._shadow.querySelector("app-list"),this._list.onFilter=this.dataListFilter,this._shadow.querySelector("side-panel").onClose=this.dataPanelClose,this._resource&&this.render()}dataPanelClose=()=>{this._shadow.querySelector("side-panel").hidden=!0};dataListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!e.dataset.id.toLowerCase().includes(t)}))};clear=()=>{for(;this._template.firstChild;)this._template.removeChild(this._template.lastChild)};buildTemplate=e=>{this.clear(),e.forEach((e=>{const t=this.createFieldset(e.label);e.row.forEach((e=>{const o=this.createSection();e.forEach((e=>{o.appendChild(this.createField(e.name,e.placeholder))})),t.appendChild(o)})),this._template.appendChild(t)}))};createFieldset=(e="unamed")=>{const t=document.createElement("fieldset");t.setAttribute("draggable","true");const o=document.createElement("input");return o.setAttribute("spellcheck","false"),o.type="text",o.classList.add("label"),o.value=e,t.appendChild(o),t};createSection=()=>{const e=document.createElement("section");return e.setAttribute("draggable","true"),e};createField=(e,t)=>{const o=document.createElement("text-field");return o.id=e,o.setAttribute("placeholder",t),o.setAttribute("readonly",""),o.setAttribute("draggable","true"),o};setValues=e=>{Array.from(this._shadow.querySelectorAll("text-field")).forEach((t=>{let o="";t.id&&(o=this.calcValue(e,t.id)),t.setAttribute("value",o)}))};calcValue=(resource,id)=>{let value=resource;const path=id.split(".");return path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx==path.length-1?value.join(", "):value[0]),!0)))),value};set source(e){this._resource=e,this._list&&this.render()}render=()=>{this.load(this._resource.resourceType);const e=JSON.parse(localStorage.getItem("templates")||"{}")[this._resource.resourceType];e?(this.buildTemplate(e),this.cleanEmpty(),this.setValues(this._resource)):this.clear()};load=e=>{this._list.clear(),this._shadow.querySelector("linear-progress").hidden=!1,function e(t,o){return new Promise((s=>{const i=[];_services_Fhir__WEBPACK_IMPORTED_MODULE_3__.t.structureDefinition(t).then((t=>{const r=[];t.snapshot.element.filter((e=>e.type)).forEach((t=>{const s=t.path.substr(t.path.indexOf(".")+1);if(!o.includes(`${s}.`)){const a=(o?`${o}.`:"")+s,n=t.type[0].code;n.match(/^([A-Z][a-z]+)+$/)?r.push(e(n,a)):i.push({id:a,path:a,short:t.short,type:n})}})),r.length>0?Promise.all(r).then((e=>{e.forEach((e=>i.push(...e))),s(i)})):s(i)}))}))}(e,"").then((e=>{e.sort(((e,t)=>e.path.localeCompare(t.path))),e.forEach((e=>{const t=document.createElement("list-item");t.setAttribute("data-primary",e.path),t.setAttribute("data-secondary",e.short);const o=document.createElement("list-row");o.setAttribute("draggable","true"),o.setAttribute("data-id",e.id),o.appendChild(t),this._list.appendChild(o)})),this._shadow.querySelector("linear-progress").hidden=!0}))};cleanEmpty=()=>{Array.from(this._template.querySelectorAll("section:not(:has(text-field))")).forEach((e=>e.remove())),Array.from(this._template.querySelectorAll("fieldset:not(:has(section))")).forEach((e=>e.remove()))};isDropAvailable=(e,t)=>e!=t&&("form"==t.id||null==t.closest("#form")||"FIELDSET"==e.tagName&&("form"==t.id||"FIELDSET"==t.tagName)||"SECTION"==e.tagName&&("form"==t.id||"FIELDSET"==t.tagName||"SECTION"==t.tagName)||"TEXT-FIELD"==e.tagName&&("form"==t.id||"FIELDSET"==t.tagName||"SECTION"==t.tagName||"TEXT-FIELD"==t.tagName)||"LIST-ROW"==e.tagName&&("form"==t.id||"FIELDSET"==t.tagName||"SECTION"==t.tagName||"TEXT-FIELD"==t.tagName));onDragStart=e=>{this._template.classList.add("drag"),this._dragSrcEl=e.target,this._dragSrcEl.style.opacity="0.4"};onDragEnter=e=>{e.target?.classList.add("over")};onDragLeave=e=>{e.target?.classList.remove("over")};onDragOver=e=>(e.preventDefault(),this.isDropAvailable(this._dragSrcEl,e.target)?e.dataTransfer.dropEffect="move":e.dataTransfer.dropEffect="none",!1);onDragDrop=e=>{e.stopPropagation();let t=e.target,o=this._dragSrcEl;if(this.isDropAvailable(this._dragSrcEl,t)){if(null==t.closest("#form"))this._dragSrcEl.remove();else{if(this._dragSrcEl.parentNode==t.parentNode){const e=Array.from(t.parentNode.childNodes);e.findIndex((e=>e==this._dragSrcEl))<e.findIndex((e=>e==t))&&(t=t.nextSibling)}if("LIST-ROW"==o.tagName){const e=this._dragSrcEl.dataset.id;if(o=this.createField(e,e.split(".").pop()),o.setAttribute("value",this.calcValue(this._resource,e)),"form"==t.id){const e=this.createSection();e.appendChild(o);const s=this.createFieldset();s.appendChild(e),t.appendChild(s)}else if("FIELDSET"==t.tagName){const e=this.createSection();e.appendChild(o),t.appendChild(e)}else"SECTION"==t.tagName?t.appendChild(o):"TEXT-FIELD"==t.tagName&&t.parentNode.insertBefore(o,t)}else if("FIELDSET"==o.tagName)"form"==t.id?t.appendChild(o):"FIELDSET"==t.tagName&&t.parentNode.insertBefore(o,t);else if("SECTION"==o.tagName)if("form"==t.id){const e=this.createFieldset();e.appendChild(o),t.appendChild(e)}else"FIELDSET"==t.tagName?t.appendChild(o):"SECTION"==t.tagName&&t.parentNode.insertBefore(o,t);else if("TEXT-FIELD"==o.tagName)if("form"==t.id){const e=this.createSection();e.appendChild(o);const s=this.createFieldset();s.appendChild(e),t.appendChild(s)}else if("FIELDSET"==t.tagName){const e=this.createSection();e.appendChild(o),t.appendChild(e)}else"SECTION"==t.tagName?t.appendChild(o):"TEXT-FIELD"==t.tagName&&t.parentNode.insertBefore(o,t)}this.cleanEmpty()}return!1};onDragEnd=e=>{this._dragSrcEl.style.opacity="1",this._dragSrcEl=null,this._template.classList.remove("drag"),this._template.querySelectorAll('[class~="over"]').forEach((e=>e.classList.remove("over")))}}customElements.define("resource-template-editor",ResourceTemplateEditor)},898:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _templates_ResourceTemplateView_html__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(612),_components_TextField__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(719);class ResourceTemplateView extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_templates_ResourceTemplateView_html__WEBPACK_IMPORTED_MODULE_1__.Z,this._form=null}connectedCallback(){this._form=this._shadow.getElementById("form")}clear(){for(;this._form.firstChild;)this._form.removeChild(this._form.lastChild);const e=document.createElement("p");e.innerHTML="There is no template yet for this type of resource.<br/>To create your own, click on the 'EDIT TEMPLATE' button.",this._form.appendChild(e)}buildTemplate=e=>{this.clear(),e.forEach((e=>{const t=this.createFieldset(e.label);e.row.forEach((e=>{const o=this.createSection();e.forEach((e=>{o.appendChild(this.createField(e.name,e.placeholder))})),t.appendChild(o)})),this._form.appendChild(t)}))};createFieldset=e=>{const t=document.createElement("fieldset"),o=document.createElement("legend");return o.innerText=e,t.appendChild(o),t};createSection=()=>document.createElement("section");createField=(e,t)=>{const o=document.createElement("text-field");return o.id=e,o.setAttribute("placeholder",t),o.setAttribute("readonly",""),o};setValues=e=>{Array.from(this._shadow.querySelectorAll("text-field")).forEach((t=>{let o="";t.id&&(o=this.calcValue(e,t.id)),t.setAttribute("value",o)}))};calcValue=(resource,id)=>{let value=resource;const path=id.split(".");return path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx==path.length-1?value.join(", "):value[0]),!0)))),value};set source(e){const t=JSON.parse(localStorage.getItem("templates")||"{}")[e.resourceType];t?(this.buildTemplate(t),this.cleanEmpty(),this.setValues(e)):this.clear()}cleanEmpty=()=>{Array.from(this._form.querySelectorAll("section:not(:has(text-field))")).forEach((e=>e.remove())),Array.from(this._form.querySelectorAll("fieldset:not(:has(section))")).forEach((e=>e.remove()))}}customElements.define("resource-template-view",ResourceTemplateView)},856:()=>{class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML='<style>main{align-items:center;display:flex;flex-direction:row;padding:.5em;flex-wrap:wrap;justify-content:flex-end}#barMiddle{flex-grow:1;margin:0;overflow:hidden;padding-left:.5em;font-size:1.17em;font-weight:700}#barRight{white-space:nowrap}</style> <main> <section id="barLeft"> <slot name="left"></slot> </section> <section id="barMiddle"> <slot name="middle"></slot> </section> <section id="barRight"> <slot name="right"></slot> </section> </main>'}}window.customElements.define("app-bar",e)},627:()=>{class e extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>input{background:0 0;border:1px solid transparent;border-radius:4px;font:inherit;padding:5px 16px;text-transform:uppercase}input:not([disabled]){color:var(--primary-color);cursor:pointer}input:not([disabled]):hover{background-color:var(--hover-color);cursor:pointer}input[disabled]{color:var(--text-color-disabled)}</style> <input type="button">'}static get observedAttributes(){return["value","disabled"]}attributeChangedCallback(e,t,o){const s=this._shadow.querySelector('input[type="button"]');"value"==e?s.value=o:"disabled"==e&&(null===o?s.removeAttribute("disabled"):s.setAttribute("disabled",""))}}window.customElements.define("app-button",e)},937:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link rel="stylesheet" href="'+i()(r)+'"> <style>main{position:absolute;top:0;left:0;background-color:rgba(0,0,0,32%);min-height:100%;min-width:100%}.surface{background-color:var(--background-color,#fff);border-radius:4px;height:60%;max-width:50%;position:absolute;top:1em;right:1em}.surface.centered{left:50%;right:unset;top:50%;transform:translateX(-50%) translateY(-50%)}.surface.fullscreen{width:95%;height:95%;max-width:unset}.overlay{background-color:rgba(255,255,255,4%);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:Roboto,Arial,monospace;height:100%}#title{margin:.5em 0}#content{overflow:hidden;flex:1 1 auto;height:0}@media (max-width:480px){.surface,.surface.centered,.surface.fullscreen{top:0;left:0;right:unset;bottom:unset;transform:unset;height:100%;width:100%;max-height:unset;max-width:unset}.overlay{background-color:transparent}}</style> <main> <div class="surface"> <div class="overlay"> <section id="header"> <app-bar> <section slot="left"> <slot name="appBarLeft"></slot> </section> <h3 id="title" slot="middle"></h3> <section slot="right"> <slot name="appBarRight"></slot> </section> </app-bar> </section> <section id="content"> <slot></slot> </section> </div> </div> </main>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=a,this._onClose=function(){this.hidden=!0}}connectedCallback(){this._shadow.querySelector("main").addEventListener("click",(e=>{this.onClose(e)})),this._shadow.querySelector(".surface").addEventListener("click",(e=>{e.stopPropagation()}))}get onClose(){return this._onClose}set onClose(e){this._onClose=e}static get observedAttributes(){return["data-title","centered","fullscreen"]}attributeChangedCallback(e,t,o){"centered"==e?this._shadow.querySelector(".surface").classList.add("centered"):"fullscreen"==e?this._shadow.querySelector(".surface").classList.add("fullscreen"):"data-title"===e&&(this._shadow.getElementById("title").innerText=o)}}window.customElements.define("app-dialog",n)},251:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link href="'+i()(r)+'" rel="stylesheet"/> <style>main{display:flex;flex-direction:column;height:100%}#list{overflow:auto;flex:1 1 auto;height:0}#list>*{cursor:pointer}</style> <main> <list-filter></list-filter> <section id="list"> <slot></slot> </section> </main>';var n=new URL(o(156),o.b);const l='<link href="'+i()(n)+'" rel="stylesheet"/> <style>main{display:flex;padding:.7em;font-size:smaller;border-bottom:1px solid var(--border-color)}main:focus-within{border-bottom-color:var(--primary-color,#000)}#text{background:0 0;border:0 none;color:var(--text-color-normal);flex:1 1 auto;font-family:inherit;font-size:inherit}#text:focus{outline:0}#clear{cursor:pointer;font-size:inherit;line-height:unset}</style> <main> <input id="text" type="text" placeholder="Type to filter" spellcheck="false"/> <i id="clear" class="material-symbols" title="clear">close</i> </main>';class d extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=l,this._onChange=()=>{}}connectedCallback(){const e=this._shadow.getElementById("text");this._shadow.querySelector("main").addEventListener("mousedown",(t=>{e.focus()})),this._shadow.getElementById("clear").addEventListener("click",(()=>{e.value&&(e.value="",this._onChange(e.value))})),e.addEventListener("input",(()=>{this._onChange(e.value)}))}clear(){this._shadow.getElementById("clear").click()}get onChange(){return this._onChange}set onChange(e){this._onChange=e}}customElements.define("list-filter",d);class c extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=a,this._list=null,this._slot=null,this._onFilter=null}connectedCallback(){this._list=this._shadow.getElementById("list"),this._slot=this._shadow.querySelector("slot"),this._filter=this._shadow.querySelector("list-filter"),this._filter.hidden=this._slot.children.length<=10,this._slot.addEventListener("slotchange",(()=>{this._filter.hidden="function"!=typeof this._onFilter||this._slot.assignedNodes().length<=10})),this._filter.onChange=e=>{"function"==typeof this._onFilter&&(""==e&&(this._list.scrollTop=0),this._onFilter(e))}}clear=()=>{this._slot.assignedNodes().forEach((e=>this.removeChild(e))),this._filter.clear(),this._list.scrollTop=0};get onFilter(){return this._onFilter}set onFilter(e){this._onFilter=e}}customElements.define("app-list",c)},699:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link href="'+i()(r)+'" rel="stylesheet"/> <style>div{height:100%;overflow:auto}table{border-collapse:collapse;min-width:100%;white-space:nowrap}thead{background-color:var(--background-color);box-shadow:0 2px 4px var(--border-color);position:sticky;top:0}td,th{height:56px;padding:1px 16px;text-align:left}th{text-transform:capitalize;cursor:grab}tbody tr{border-bottom:1px solid var(--border-color,gray);cursor:pointer}tbody tr td::first-line{font-size:medium}tbody tr td{font-size:smaller}tbody tr.selected,tbody tr:hover{background-color:var(--hover-color,rgb(0 0 0 / 4%))}tr.drag th.over{background-color:var(--hover-color,rgb(0 0 0 / 4%))}</style> <div> <table> <thead> <tr id="header"></tr> </thead> <tbody id="body"></tbody> </table> </div>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"open"}),this._shadow.innerHTML=a,this._onColumnReorder=()=>{}}connectedCallback(){this._header=this._shadow.getElementById("header"),this._header.ondragstart=this.onDragStart,this._header.ondragover=this.onDragOver,this._header.ondragenter=this.onDragEnter,this._header.ondragleave=this.onDragLeave,this._header.ondragend=this.onDragEnd,this._header.ondrop=this.onDragDrop,this._body=this._shadow.getElementById("body"),this._body.onclick=this.bodyClick}get onColumnReorder(){return this._onColumnReorder}set onColumnReorder(e){this._onColumnReorder=e}addColumn=e=>{const t=document.createTextNode(e),o=document.createElement("th");o.dataset.id=e,o.appendChild(t),o.setAttribute("draggable","true"),this._header.appendChild(o)};addRow=(e,t)=>{let o=document.createElement("tr");o.id=e,Object.entries(t).forEach((([,e])=>{o.insertAdjacentHTML("beforeend",`<td>${e}</td>`)})),this._body.appendChild(o)};bodyClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("tr");t&&(this._body.querySelector("tr[class~=selected]")?.classList.remove("selected"),t.classList.add("selected"),this.dispatchEvent(new CustomEvent("rowclick",{bubbles:!1,cancelable:!1,detail:{resourceId:t.id}})))};clear=()=>{for(;this._header.firstChild;)this._header.removeChild(this._header.lastChild);this.removeAll()};removeAll=()=>{for(;this._body.firstChild;)this._body.removeChild(this._body.lastChild)};onDragStart=e=>{const t=e.target.closest("th");t.style.opacity="0.4",this._header.classList.add("drag"),this.dragSrcEl=t};onDragEnter=e=>{e.target.closest("th")?.classList.add("over")};onDragLeave=e=>{e.target.closest("th")?.classList.remove("over")};onDragOver=e=>{e.preventDefault();const t=e.target.closest("th");return this.dragSrcEl==t?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move",!1};onDragDrop=e=>{e.stopPropagation();let t=e.target.closest("th");if(this.dragSrcEl!=t){const e=Array.from(this._header.childNodes);e.findIndex((e=>e==this.dragSrcEl))<e.findIndex((e=>e==t))&&(t=t.nextSibling),this._header.insertBefore(this.dragSrcEl,t),this.dragSrcEl=null,this._onColumnReorder(Array.from(this._header.childNodes).map((e=>e.dataset.id)))}return!1};onDragEnd=e=>{e.target.closest("th").style.opacity="1",this._header.classList.remove("drag"),this._header.childNodes.forEach((e=>e.classList.remove("over")))}}customElements.define("data-table",n)},39:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link rel="stylesheet" href="'+i()(r)+'"> <style>main{align-items:center;display:flex;flex-direction:row;font-family:inherit;font-size:.875rem;padding:.5em;text-align:right;white-space:nowrap}.rows{margin:0 24px;flex:auto}</style> <main> <div class="rows"> <slot name="rows"></slot> </div> <div class="arrows"> <slot name="arrows"></slot> </div> </main>';o(914);class n extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML=a}}customElements.define("data-table-pagination",n)},196:()=>{class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML='<style>main{background-color:var(--border-color);overflow:hidden}.thumb{height:.2em;width:50%;background-color:var(--primary-color);left:-50%;position:relative;animation:loading 2s ease-in .5s infinite}@keyframes loading{0%{transform:translateX(0)}to{transform:translateX(400%)}}</style> <main> <div class="thumb"/> </main>'}}customElements.define("linear-progress",e)},72:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link href="'+i()(r)+'" rel="stylesheet"/> <style>main{background-color:inherit;display:flex;flex-direction:row;align-items:center;gap:.5em}.text{flex:1 1 auto;overflow:hidden}#primary{display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:var(--text-color-normal,#000)}#primary:first-letter{text-transform:uppercase}#secondary{display:block;font-size:smaller;color:var(--text-color-disabled);overflow-wrap:break-word}</style> <main> <span id="icon" class="material-symbols"></span> <span class="text"> <span id="primary"></span> <span id="secondary"></span> </span> <section> <slot name="trailling"></slot> </section> </main>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=a}static get observedAttributes(){return["data-primary","data-secondary","data-icon"]}attributeChangedCallback(e,t,o){switch(e){case"data-icon":this._shadow.getElementById("icon").innerText=o;break;case"data-primary":this._shadow.getElementById("primary").innerHTML=o;break;case"data-secondary":this._shadow.getElementById("secondary").innerHTML=o}}}customElements.define("list-item",n)},914:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link href="'+i()(r)+'" rel="stylesheet"/> <style>main{padding:8px;text-align:center;border:0 none;color:inherit;background-color:transparent;border-radius:50%;user-select:none}main:not([disabled]):hover{background-color:var(--hover-color,rgb(0 0 0 /5%));cursor:pointer}main[disabled]{color:var(--text-color-disabled)}</style> <main class="material-symbols"/>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=a}static get observedAttributes(){return["data-icon","disabled"]}attributeChangedCallback(e,t,o){const s=this._shadow.querySelector("main");"data-icon"===e?s.innerText=o:"disabled"===e&&(null===o?s.removeAttribute("disabled"):s.setAttribute("disabled",""))}connectedCallback(){this._shadow.addEventListener("click",this._onClick)}disconnectedCallback(){this._shadow.removeEventListener("click",this._onClick)}_onClick(e){e.target.hasAttribute("disabled")&&e.stopPropagation()}}customElements.define("round-button",n)},59:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link rel="stylesheet" href="'+i()(r)+'"> <style>main{background-color:var(--background-color,#fff);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:Roboto,Arial,monospace;height:100%;width:400px}header{padding-bottom:3px;border-bottom:1px solid var(--border-color)}header h3{margin:0}#content{overflow:auto;flex:1 1 auto;height:0}@media (max-width:480px){main{top:0;left:0;height:100%;width:100%}}</style> <main> <header slot="header"> <app-bar> <section slot="left"> <slot name="appBarLeft"></slot> </section> <h3 id="title" slot="middle">Side panel</h3> <section slot="right"> <slot name="appBarRight"></slot> <round-button id="close" title="Close" data-icon="close"></round-button> </section> </app-bar> </header> <section id="content"> <slot name="main"></slot> </section> </main>';o(914),o(856);class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=a,this._onClose=function(){this.classList.add("hidden")}}static get observedAttributes(){return["data-title","data-closable"]}attributeChangedCallback(e,t,o){if("data-title"==e)this._shadow.getElementById("title").innerText=o;else if("data-closable"==e){const e="true"===o;this._shadow.getElementById("close").hidden=!e}}connectedCallback(){this._shadow.getElementById("close").addEventListener("click",(e=>{this.onClose(e)}))}get onClose(){return this._onClose}set onClose(e){this._onClose=e}}window.customElements.define("side-panel",n)},719:(e,t,o)=>{var s=o(91),i=o.n(s),r=new URL(o(156),o.b);const a='<link href="'+i()(r)+'" rel="stylesheet"/> <style>#field{background-color:var(--hover-color,#d3d3d3);border-bottom:1px solid rgba(0,0,0,42%);display:flex;font-size:1em;position:relative}main:focus-within{border-bottom-color:var(--primary-color,#000)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;caret-color:var(--primary-color,black);color:var(--text-color-normal,#000);flex:auto;font:inherit;padding:15px}input[readonly]{cursor:default}input:focus{outline:0;padding:23px 15px 7px 15px;border-color:var(--primary-color)}input::placeholder{font-size:1em;color:var(--text-color-disabled,#000)}input::selection{color:#fff;background:var(--primary-color)}input:focus::placeholder{visibility:hidden}input:not(:placeholder-shown){padding:23px 15px 7px 15px}label{color:var(--text-color-disabled,#000);font-size:12px;left:15px;pointer-events:none;position:absolute;top:6px;visibility:hidden}input:focus+label,input:not(:placeholder-shown)+label{visibility:visible}input:focus+label{color:var(--primary-color,#000)}input:invalid+label,input:invalid:focus{color:var(--background-error);border-color:var(--background-error)}input:required+label::after{content:\'*\'}#helper{font-size:smaller;margin:0 0 1em 1em}</style> <main> <section id="field"> <input type="text" placeholder="" spellcheck="false"> <label></label> </section> <section id="helper"></section> </main>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=a,this._label=""}static get observedAttributes(){return["placeholder","readonly","required","value","helper"]}attributeChangedCallback(e,t,o){const s=this._shadow.querySelector('input[type="text"]');switch(e){case"placeholder":this._label=o,s.setAttribute("placeholder",o),this._shadow.querySelector("label").innerText=o;break;case"readonly":null==o?s.removeAttribute("readonly"):s.setAttribute("readonly","");break;case"required":null==o?s.removeAttribute("required"):s.setAttribute("required","");break;case"value":s.setAttribute("value",o);break;case"helper":this._shadow.getElementById("helper",o)}s.hasAttribute("required")&&s.setAttribute("placeholder",`${this._label}*`)}checkValidity=function(){return this._shadow.querySelector('input[type="text"]').checkValidity()};focus=function(){this._shadow.querySelector('input[type="text"]').focus()};get value(){return this._shadow.querySelector('input[type="text"]').value}set value(e){this._shadow.querySelector('input[type="text"]').value=e}}window.customElements.define("text-field",n)},916:(e,t,o)=>{o.d(t,{t:()=>i});const s=JSON.parse('{"account":"account_balance_wallet","accountreport":"account_balance_wallet","activitydefinition":"quiz","adverseevent":"emergency_home","allergyintolerance":"allergy","appointment":"today","appointmentresponse":"event_available","auditevent":"browse_activity","basic":"shapes","binary":"data_object","biologicallyderivedproduct":"fork_right","bodystructure":"skeleton","bundle":"format_paragraph","capabilitystatement":"campaign","careplan":"flowsheet","careteam":"groups","catalogentry":"description","chargeitem":"sell","chargeitemdefinition":"sell","claim":"request_quote","claimresponse":"task","clinicalimpression":"comment","codesystem":"data_array","communication":"mail","communicationrequest":"outgoing_mail","compartmentdefinition":"category","composition":"blender","conceptmap":"integration_instructions","condition":"coronavirus","consent":"done","contract":"contract","coverage":"shield","coverageeligibilityrequest":"policy","coverageeligibilityresponse":"verified_user","detectedissue":"bug_report","device":"electrical_services","devicedefinition":"inventory_2","devicemetric":"health_metrics","devicerequest":"unknown_document","deviceusestatement":"home_iot_device","diagnosticreport":"diagnosis","documentmanifest":"dataset","documentreference":"bookmarks","effectevidencesynthesis":"clinical_notes","encounter":"medical_services","enrollmentrequest":"contact_support","enrollmentresponse":"support_agent","endpoint":"location_on","episodeofcare":"blood_pressure","evidence":"search_check","evidencevariable":"troubleshoot","eventdefinition":"event_note","examplescenario":"video_library","explanationofbenefit":"speaker_notes","familymemberhistory":"family_restroom","familimemberhistory":"history","flag":"flag","goal":"sports_score","graphdefinition":"bar_chart","group":"group","guidanceresponse":"mark_email_read","healthcareservice":"mixture_med","implementationguide":"developer_guide","imagingstudy":"radiology","immunization":"immunology","immunizationevaluation":"microbiology","immunizationrecommendation":"mixture_med","insuranceplan":"payments","invoice":"receipt_long","library":"local_library","linkage":"link","list":"list","location":"pin_drop","manifest":"dataset","measure":"scale","measurereport":"lab_profile","media":"perm_media","medicinalproduct":"pill","medicinalproductauthorization":"pill","medicinalproductcontraindication":"pill_off","medicinalproductindication":"pill","medicinalproductingredient":"pill","medicinalproductinteraction":"pill","medicinalproductmanufactured":"pill","medicinalproductpackaged":"pill","medicinalproductpharmaceutical":"pill","medicinalproductundesirableeffect":"sick","medication":"medication","medicationadministration":"medication_liquid","medicationdispense":"prescriptions","medicationknowledge":"medication","medicationrequest":"medication","medicationstatement":"medication","messagedefinition":"developer_guide","messageheader":"code","molecularsequence":"genetics","namingsystem":"import_contacts","nutritionorder":"restaurant","observation":"description","observationdefinition":"file_present","operationdefinition":"function","operationoutcome":"function","organization":"local_hospital","organizationaffiliation":"account_tree","parameters":"settings","patient":"personal_injury","paymentnotice":"credit_card","paymentreconciliation":"credit_score","person":"person","plandefinition":"view_list","practitioner":"stethoscope","practitionerrole":"medical_information","procedure":"checklist","provenance":"deployed_code_history","questionnaire":"assignment","questionnaireresponse":"assignment_turned_in","relatedperson":"family_restroom","requestgroup":"group_work","researchdefinition":"lab_panel","researchelementdefinition":"labs","researchstudy":"biotech","researchsubject":"biotech","resource":"description","riskevidencesynthesis":"feedback","riskassessment":"problem","schedule":"calendar_month","searchparameter":"screen_search_desktop","servicerequest":"ecg","slot":"view_agenda","specimen":"colorize","specimendefinition":"colorize","structuredefinition":"developer_guide","structuremap":"table","subscription":"loyalty","substance":"science","substancenucleicacid":"science","substancepolymer":"science","substanceprotein":"science","substancereferenceinformation":"science","substancesourcematerial":"science","substancespecification":"science","supplydelivery":"deployed_code","supplyrequest":"deployed_code_history","task":"task","terminologycapabilities":"developer_guide","testreport":"integration_instructions","testscript":"code_blocks","valueset":"data_array","verificationresult":"new_releases","visionprescription":"ophthalmology"}');class i{static{this._server=null,this._references={},this._fhirReferences=null,this._serverChangeListener=[]}static addListener=e=>{this._serverChangeListener.push(e)};static dispatchServerChange=()=>{this._serverChangeListener.forEach((e=>{e.call()}))};static get release(){return{"5.0.0":"R5","4.6.0":"R5","4.5.0":"R5","4.4.0":"R5","4.3.0":"R4B","4.2.0":"R5","4.1.0":"R4B","4.0.1":"R4","3.5.0":"R4","3.3.0":"R4","3.2.0":"R4","3.0.2":"STU3","3.0.1":"STU3","3.0.0":"STU3"}[this._server.capabilities.fhirVersion]||null}static set server(e){e!=this._server&&(this._server=e,this.dispatchServerChange())}static get server(){return this._server}static helpUrl(e){return`https://hl7.org/fhir/${this.release}/${e.toLowerCase()}.html`}static references(e){return this._references[e]}static formatEnable(e){let t=[];switch(e){case"json":t.push("json"),t.push("application/fhir+json"),t.push("html/json");break;case"xml":t.push("xml"),t.push("application/fhir+xml"),t.push("html/xml");break;case"ttl":t.push("ttl"),t.push("application/x-turtle"),t.push("html/turtle")}return this.server.capabilities.format.some((e=>t.includes(e)))}static async capabilities(e){const t=new URL(`${e.url}/metadata`);t.searchParams.set("_format","json");try{const o=await fetch(t,{cache:"reload",headers:e.headers});return o.ok?o.json():Promise.reject(o)}catch(e){return Promise.reject(e)}}static async structureDefinition(e){const t=new URL(`https://hl7.org/fhir/${this.release}/${e.toLowerCase()}.profile.json`);return(await fetch(t,{cache:"force-cache"})).json()}static async read(e,t){const o=new URL(`${this._server.url}/${e}/${t}`);return o.searchParams.set("_format","json"),(await fetch(o,{headers:this._server.headers})).json()}static async readHistory(e,t){const o=new URL(`${this._server.url}/${e}/${t}/_history`);return o.searchParams.set("_summary","text"),o.searchParams.set("_format","json"),(await fetch(o,{headers:this._server.headers})).json()}static async connect(e,t){switch(t.auth?.method){case"oauth2":this.oauth2_getToken(t.auth.setup).then((e=>{t.headers||(t.headers={}),t.headers.Authorization=`${e.token_type} ${e.access_token}`}));break;case"basic":let e=btoa(`${t.auth.setup.username}:${t.auth.setup.password}`);t.headers||(t.headers={}),t.headers.Authorization=`Basic ${e}`;break;case"apikey":t.headers||(t.headers={}),t.headers[t.auth.setup.key]=t.auth.setup.value}const o=await i.capabilities(t);t.serverCode=e,t.capabilities=o,i.server=t,this._references=await this.parseReferences(o)}static async parseReferences(e){const t={},o=e.rest[0].resource,s=await this.getAllReferences();return e.rest[0].resource.forEach((e=>{const i=s[this.release][e.type];if(i){const s=JSON.parse(JSON.stringify(i));Object.entries(s).forEach((([e,t])=>{let i=o.find((t=>e==t.type));i&&i.searchParam?(s[e].forEach(((t,o)=>{const r=i.searchParam.find((e=>t==e.name));r?s[e][o]={name:t,documentation:r.documentation}:s[e].splice(o,1)})),0===s[e].length&&delete s[e]):delete s[e]})),0!==Object.keys(s).length&&(t[e.type]=s)}})),t}static async getAllReferences(){if(!this._fhirReferences){const e=await fetch("./assets/references.json");this._fhirReferences=await e.json()}return this._fhirReferences}static async oauth2_getToken(e){let t={grant_type:e.grant_type};const o={"Content-type":"application/x-www-form-urlencoded"};if("client_credentials"==e.grant_type){const t=btoa(`${e.client_id}:${e.client_secret}`);o.Authorization=`Basic ${t}`}let s=new URLSearchParams(t);return(await fetch(e.access_token_url,{headers:o,method:"POST",body:s.toString()})).json()}static ResourceIcon(e){return s[e.toLowerCase()]||"unknown_med"}}},571:(e,t,o)=>{o.d(t,{y:()=>s});class s{static{this.KEY="preferences"}static get(e,t=null){const o=localStorage.getItem(this.KEY);let s=null;return null===o?t:(s=JSON.parse(o),s[e]||t)}static set(e,t){const o=localStorage.getItem(this.KEY);let s=null;s=null!==o?JSON.parse(o):{},s[e]=t,localStorage.setItem(this.KEY,JSON.stringify(s))}}},332:(e,t,o)=>{o.d(t,{h:()=>i});class s extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:#fff;border-radius:4px;box-shadow:0 11px 15px -7px rgb(0 0 0 / 20%),0 24px 38px 3px rgb(0 0 0 / 14%),0 9px 46px 8px rgb(0 0 0 / 12%);bottom:1em;margin:0 1em;min-width:344px;position:absolute}.overlay{align-items:center;background-color:rgba(0,0,0,85%);color:#fff;display:flex;flex-direction:row;font-family:Roboto,Arial,monospace;min-height:48px;padding:0 1em}main.error .overlay{background-color:var(--background-error)}#message{flex-grow:1;overflow:hidden;padding:0 1em;text-overflow:ellipsis;white-space:nowrap}slot[name=right]{margin-left:1em}@media (max-width:480px){main{min-width:unset;width:calc(100% - 2em)}}</style> <main> <div class="overlay"> <div id="message"> <slot></slot> </div> <slot name="right"></slot> </div> </main>'}set type(e="info"){this._shadow.querySelector("main").classList.add(e)}}customElements.define("snack-bars",s);class i{static{this._container=document.body}static set container(e){this._container=e}static error(e){this.show(e,void 0,void 0,"error")}static show(e,t,o=4e3,s="info"){let i=document.createElement("snack-bars");i.type=s,i.appendChild(document.createTextNode(e)),t&&(t.setAttribute("slot","right"),i.appendChild(t)),this._container.appendChild(i),setTimeout((()=>{i.remove()}),o)}}},156:(e,t,o)=>{e.exports=o.p+"d353739f137f323d232b.css"}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__webpack_require__),o.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var s=o.length-1;s>-1&&!e;)e=o[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})(),__webpack_require__.b=document.baseURI||self.location.href;var __webpack_exports__={};(()=>{var e=__webpack_require__(91),t=__webpack_require__.n(e),o=new URL(__webpack_require__(156),__webpack_require__.b);const s='<link rel="stylesheet" href="'+t()(o)+'"> <style>:host{background-color:var(--background-color,#fff);color:var(--text-color-normal,rgb(0,0,0,87%));display:flex;flex-direction:column;font-family:Roboto,Arial,monospace;font-size:1rem;font-weight:400;height:100vh;line-height:1.5}header{background-color:var(--primary-color,#000);color:#fff}h3{margin:0}main{flex:1 1 auto;height:0;overflow:hidden}main>div{display:flex;flex-direction:row;height:100%}server-panel{border-right:1px solid var(--border-color,gray);flex:none;transition:all .3s;margin-left:0;width:300px}server-panel.hidden{transition:all .3s;margin-left:-300px}#bdy{flex:1 1 auto;overflow:hidden;width:0;position:relative;block-size:100%;display:grid;grid-auto-flow:column;grid-auto-columns:100%;grid-auto-rows:100%}#waiting{align-items:center;background-color:rgba(0,0,0,32%);display:flex;font-size:5em;justify-content:center;left:0;min-height:100%;min-width:100%;position:absolute;top:0;visibility:hidden}@media (max-width:480px){server-panel{background-color:var(--background-color,#fff);position:static;width:100%}server-panel.hidden{margin-left:-100%}}</style> <header> <app-bar id="header" caption=""> <round-button slot="left" id="navigation" title="Menu" data-icon="menu" hidden></round-button> <span id="appTitle" slot="middle">FHIR Browser</span> <color-scheme slot="right"></color-scheme> <round-button slot="right" id="serverDialogToggle" title="Connections" data-icon="database"></round-button> <round-button slot="right" id="aboutDialogToggle" title="About" data-icon="help"></round-button> </app-bar> </header> <main> <div> <server-panel class="hidden"></server-panel> <div id="bdy" style="visibility:hidden"> <fhir-bundle id="bundle"></fhir-bundle> <fhir-resource id="resource"></fhir-resource> </div> </div> </main> <about-dialog hidden></about-dialog> <server-dialog hidden></server-dialog> <div id="waiting"> <circular-progress></circular-progress> </div>';__webpack_require__(856),__webpack_require__(937);var i=__webpack_require__(571);class r extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<round-button title="" data-icon=""></round-button>'}connectedCallback(){this._shadow.addEventListener("click",this.onClick),this.setColorScheme(i.y.get("colorScheme","auto"))}disconnectedCallback(){this._shadow.removeEventListener("click",this.onClick)}onClick=e=>{const t=["light","dark","auto"];let o=i.y.get("colorScheme","auto"),s=t.findIndex((e=>e===o))+1;o=t[s%3],i.y.set("colorScheme",o),this.setColorScheme(o)};setColorScheme=e=>{let t="",o=e;switch(e){case"dark":t="brightness_4";break;case"light":t="light_mode";break;default:"auto"===e&&(o=window?.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),t="brightness_auto"}const s=this._shadow.querySelector("round-button");s.setAttribute("data-icon",t),s.title=`Theme ${e}`,document.body.setAttribute("color-scheme",o)};get value(){return i.y.get("colorScheme","auto")}}customElements.define("color-scheme",r);class a extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{height:.7em;width:.7em;color:var(--primary-color);display:inline-block;border:.15em solid;border-radius:50%;border-top-color:transparent;animation:rotate 1s linear infinite}@keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style> <main/>"}}customElements.define("circular-progress",a);var n=new URL(__webpack_require__(156),__webpack_require__.b);const l='<link href="'+t()(n)+'" rel="stylesheet"/> <style>main{padding:1em}a{color:var(--primary-color)}</style> <app-dialog id="aboutDialog" data-title="About FHIR Browser"> <round-button id="closeButton" slot="appBarLeft" title="close" data-icon="close"></round-button> <main> <p> FHIR Browser is and <a target="_blank" href="https://github.com/hprieurgarrouste/fhirBrowser.git">open source</a> utility developed by and intended for FHIR developers<br/>and all IT professionals who work with a FHIR server. <br/>Its purpose is to help users analyze FHIR servers and learn about their content. </p> <p> All content on the website is published under Creative Commons License <a target="_blank" href="https://github.com/hprieurgarrouste/fhirBrowser/blob/master/licence.md">CC-BY-NC-ND 4.0</a> </p> </main> </app-dialog>';class d extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=l}connectedCallback(){this._shadow.getElementById("closeButton").onclick=this.appDialogClose,this._shadow.querySelector("app-dialog").onClose=e=>{e.preventDefault(),e.stopPropagation(),this.appDialogClose()}}appDialogClose=()=>{this.hidden=!0}}customElements.define("about-dialog",d),__webpack_require__(131);class c extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}header{display:flex;flex-direction:row;flex-wrap:nowrap;box-shadow:0 3px 4px var(--border-color)}header>section{background-color:transparent;color:inherit;cursor:pointer;font:inherit;height:3em;line-height:3em;text-transform:uppercase;text-align:center;white-space:nowrap;width:100%;flex-grow:1;border-bottom:2px solid transparent;font-size:smaller}header>section:hover{background-color:var(--hover-color,rgba(0,0,0,5%))}header>section[selected]{border-bottom-color:var(--primary-color,#000);font-weight:700;color:var(--primary-color,#000)}::slotted(section){flex:1 1 auto;height:0}</style> <main> <header></header> <slot></slot> </main>",this._slot=null,this._header=null}connectedCallback(){this._shadow.onclick=e=>{e.preventDefault(),e.stopPropagation()},this._header=this._shadow.querySelector("header"),this._header.onclick=this.headerClick,this._slot=this._shadow.querySelector("slot"),this._slot.addEventListener("slotchange",this.slotChanged)}clear=()=>{for(;this._header.firstChild;)this._header.removeChild(this._header.lastChild)};slotChanged=()=>{this.clear(),this._slot.assignedElements().forEach((e=>{e.hidden=!0;const t=document.createElement("section");t.dataset.caption=e.dataset.caption,t.innerText=e.dataset.caption,this._header.appendChild(t)})),this.value||(this.value=this._header.querySelector("section:nth-child(1)")?.dataset.caption)};headerClick=({target:e})=>{this.value=e.dataset.caption,this.dispatchEvent(new CustomEvent("select",{bubbles:!1,cancelable:!1,detail:{caption:this.value}}))};get value(){return this._header.querySelector("section[selected]")?.dataset?.caption}set value(e){this._header.querySelector("section[selected]")?.removeAttribute("selected"),this._slot.assignedElements().forEach(((t,o)=>{t.dataset.caption==e?(t.hidden=!1,this._header.querySelector(`section:nth-child(${o+1})`)?.setAttribute("selected","")):t.hidden=!0}))}}customElements.define("app-tabs",c);var h=new URL(__webpack_require__(156),__webpack_require__.b);const u='<link href="'+t()(h)+'" rel="stylesheet"/> <style>main{display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}</style> <main> <app-list></app-list> </main>';__webpack_require__(251);var p=new URL(__webpack_require__(156),__webpack_require__.b);const m='<link href="'+t()(p)+'" rel="stylesheet"/> <style>main{padding:.1em .5em;border-radius:1em;white-space:nowrap;color:var(--text-color-normal);background-color:inherit;border:1px solid var(--border-color);text-decoration:none;text-align:center;font-size:x-small;display:inline-block;min-width:2.4em}</style> <main></main>';class _ extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=m,this._content=null,this._value=null}connectedCallback(){this._content=this._shadow.querySelector("main"),this.render()}render=()=>{if(!this._content)return;if(!this._value||0==this._value.length)return this._content.innerText="",void(this.title=this._value);const e=function(e,t=0){const o=[{suffix:"T",threshold:1e12},{suffix:"B",threshold:1e9},{suffix:"M",threshold:1e6},{suffix:"K",threshold:1e3},{suffix:"",threshold:1}].find((t=>Math.abs(e)>=t.threshold));return o?(e/o.threshold).toFixed(t)+o.suffix:e}(this._value);this._content.innerText=e,this.title=this._value!=e?this._value:""};get value(){return this._value}set value(e){this._value=e,this.render()}}window.customElements.define("app-badge",_),__webpack_require__(72);class f extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{padding:.5em 1em;background-color:inherit}main:hover,main[selected]{background-color:var(--hover-color,rgba(0,0,0,5%))}</style> <main> <slot></slot> </main>"}static get observedAttributes(){return["selected"]}attributeChangedCallback(e,t,o){if("selected"===e){const e=this._shadow.querySelector("main");null===o?e.removeAttribute("selected"):e.setAttribute("selected","")}}}customElements.define("list-row",f);var g=__webpack_require__(916);class b extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=u,this._resourceType=null}connectedCallback(){const e=this._shadow.querySelector("app-list");e.onFilter=this.appListFilter,e.onclick=this.appListClick,g.t.addListener(this.serverChanged),window.addEventListener("hashchange",this.locationHandler)}locationHandler=()=>{let e=window.location.hash.replace("#/","").trim();if(e.length){let t="";t=e.indexOf("?")>0?e.split("?")[0]:e.split("/")[0],this.value=t}else this.value=null};serverChanged=()=>{const e=this._shadow.querySelector("app-list");e.clear();const t=g.t.server?.capabilities?.rest[0]?.resource;t.filter((e=>e.interaction.map((e=>e.code)).includes("search-type"))).forEach((t=>{const o=document.createElement("list-row");o.setAttribute("data-type",t.type);const s=document.createElement("list-item");s.setAttribute("data-primary",t.type),s.setAttribute("data-icon",g.t.ResourceIcon(t.type));const i=function(e){const t=e.extension?.find((e=>"http://hl7api.sourceforge.net/hapi-fhir/res/extdefs.html#resourceCount"==e.url))?.valueDecimal;if(t){const e=document.createElement("app-badge");return e.slot="trailling",e.value=t,e}return null}(t);i&&s.appendChild(i),o.appendChild(s),e.appendChild(o)})),this.locationHandler()};appListClick=({target:e})=>{const t=e.closest("list-row");t&&(this._shadow.querySelector("app-list").querySelector("[selected]")?.removeAttribute("selected"),t.setAttribute("selected",""),this._resourceType=t.dataset.type,location.hash=`#/${t.dataset.type}?_summary=true&_format=json&_count=20`)};appListFilter=e=>{const t=e.toLowerCase();this._shadow.querySelector("app-list").childNodes.forEach((e=>{e.hidden=!e.dataset.type.toLowerCase().includes(t)}))};get value(){return this._resourceType}set value(e){const t=this._shadow.querySelector("app-list");if(!e)return t.querySelector("[selected]")?.removeAttribute("selected"),void(t.scrollTop=0);if(e!=this._resourceType){const o=Array.from(t.childNodes).find((t=>t.dataset.type===e));o&&(this._resourceType=e,t.querySelector("[selected]")?.removeAttribute("selected"),o.setAttribute("selected",""),o.scrollIntoView())}}}customElements.define("server-resources",b);class y extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}app-list>*{cursor:default}</style> <main> <app-list></app-list> </main>",g.t.addListener(this.serverChanged)}serverChanged=()=>{const e=this._shadow.querySelector("app-list");e.clear();const t=g.t.server?.capabilities;s("copyright",t.copyright),s("description",t.description),s("fhirVersion",`${t.fhirVersion} (${g.t.release})`);const o=document.createElement("UL");function s(t,o){if(void 0===o)return;const s=document.createElement("list-row"),i=document.createElement("list-item");i.setAttribute("data-primary",t),i.setAttribute("data-secondary",o),s.appendChild(i),e.appendChild(s)}t.format.forEach((e=>{const t=document.createElement("LI");t.innerText=e,o.appendChild(t)})),s("format",o.outerHTML),t.implementation&&(s("implementation description",t.implementation.description),s("implementation name",t.implementation.name),s("implementation url",t.implementation.url)),s("language",t.language),s("name",t.name),s("publisher",t.publisher),t.software&&(s("software name",t.software.name),s("software version",t.software.version),s("software release date",t.software.releaseDate))}}customElements.define("server-capabilities",y);class w extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{display:flex;flex-direction:column;height:100%}header{padding:1em}app-tabs{flex:1 1 auto}</style> <main> <header> <list-item id="serverTitle"></list-item> </header> <app-tabs> <section data-caption="Resource Types"> <server-resources></server-resources> </section> <section data-caption="Details"> <server-capabilities></server-capabilities> </section> </app-tabs> </main>'}connectedCallback(){g.t.addListener(this.serverChanged)}serverChanged=()=>{const e=g.t.server;this._shadow.getElementById("serverTitle").setAttribute("data-primary",e.serverCode),this._shadow.getElementById("serverTitle").setAttribute("data-secondary",e.capabilities?.implementation?.description||e.capabilities?.software?.name||e.url)}}customElements.define("server-panel",w);var v=new URL(__webpack_require__(156),__webpack_require__.b);const x='<link rel="stylesheet" href="'+t()(v)+'"> <style>#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}#resourceCnt{display:flex;flex-direction:column;height:100%;flex:auto;width:0}main{flex:1 1 auto;height:0}#title{margin:0;overflow:hidden;text-overflow:ellipsis}tab-bar{border-bottom:1px solid var(--border-color)}#formView,#jsonView,#ttlView,#xmlView{flex:1 1 auto;height:0}#header.error{background-color:var(--background-error,transparent);color:#fff}#error{padding:1em}#tabs{display:flex;flex-direction:column;height:100%}resource-history,resource-references{border-left:1px solid var(--border-color)}@media (max-width:480px){resource-history,resource-references{background-color:var(--background-color,#fff);position:relative;width:100%}}</style> <div id="wrapper"> <section id="resourceCnt"> <header> <app-bar id="header"> <round-button slot="left" id="help" title="Help" data-icon="help"></round-button> <h3 slot="middle" id="title"></h3> <round-button slot="right" id="share" title="Share" data-icon="share"></round-button> <round-button slot="right" id="copy" title="Copy to clipboard" data-icon="content_copy"></round-button> <round-button slot="right" id="download" title="Download" data-icon="download"></round-button> <round-button slot="right" id="referencesToggle" title="References" data-icon="article_shortcut"></round-button> <round-button slot="right" id="historyToggle" title="History" data-icon="history"></round-button> </app-bar> </header> <main> <app-tabs></app-tabs> </main> </section> <resource-references slot="main" hidden></resource-references> <resource-history slot="main" hidden></resource-history> </div>';__webpack_require__(914),__webpack_require__(59);var k=new URL(__webpack_require__(156),__webpack_require__.b);const E='<link href="'+t()(k)+'" rel="stylesheet"/> <style>#list{display:flex;flex-direction:column;flex-wrap:nowrap;background:linear-gradient(90deg,var(--background-color) calc(100% - 2px),var(--text-color-normal) 0);background-size:19px;background-repeat:no-repeat}#list>*{cursor:pointer}</style> <side-panel data-title="History"> <round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></round-button> <section id="list" slot="main"></section> </side-panel>';class C extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=E,this._resourceType=null,this._resourceId=null}connectedCallback(){this._shadow.getElementById("help").onclick=this.helpClick,this._shadow.getElementById("list").onclick=this.listClick,this._shadow.querySelector("side-panel").onClose=this.sidePanelClose}listClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("list-row");if(t){if(t.hasAttribute("selected"))return;this._shadow.querySelector("list-row[selected]")?.removeAttribute("selected"),t.setAttribute("selected",""),location.hash=`#/${this._resourceType}/${this._resourceId}/_history/${t.dataset.versionid}`}else e.preventDefault(),e.stopPropagation()};helpClick=e=>{window.open(`https://hl7.org/fhir/${g.t.release}/http.html#history`,"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};sidePanelClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};clear(){const e=this._shadow.getElementById("list");for(;e.firstChild;)e.removeChild(e.lastChild)}load(e,t){e.interaction.find((({code:e})=>"vread"==e))&&(e.type==this._resourceType&&t==this._resourceId||g.t.read(e.type,t).then((t=>{const o=this._shadow.getElementById("list");this._resourceType=e.type,this._resourceId=t.id;const s=t.meta?.versionId;this.clear(),g.t.readHistory(e.type,t.id).then((e=>{"Bundle"==e.resourceType&&"history"==e.type&&e.total>1&&e.entry.sort(((e,t)=>{const o=new Date(e.resource.meta.lastUpdated);return new Date(t.resource.meta.lastUpdated)-o})).forEach((e=>{const t=document.createElement("list-row");t.setAttribute("data-versionid",e.resource.meta.versionId),s==e.resource.meta.versionId&&t.setAttribute("selected","");const i=new Date(e.resource.meta.lastUpdated),r=document.createElement("list-item");r.setAttribute("data-icon","line_end_circle"),r.setAttribute("data-primary",`${i.toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"})}`),r.setAttribute("data-secondary",`${i.toLocaleString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"})}`),t.appendChild(r),o.appendChild(t)}))}))})))}}customElements.define("resource-history",C);var T=new URL(__webpack_require__(156),__webpack_require__.b);const S='<link href="'+t()(T)+'" rel="stylesheet"/> <style>main{display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}</style> <side-panel data-title="References"> <main slot="main"> <app-list></app-list> </main> </side-panel>';class L extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=S,this._resourceType=null,this._resourceId=null,this._list=null}connectedCallback(){this._list=this._shadow.querySelector("app-list"),this._list.onclick=this.appListClick,this._list.onFilter=this.appListFilter,this._shadow.querySelector("side-panel").onClose=this.sidePanelClose}appListClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("list-row");t&&(location.hash=`#/${t.dataset.target}?${t.dataset.search}=${this._resourceId}`)};appListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!(e.dataset.target.toLowerCase().includes(t)||e.dataset.search.toLowerCase().includes(t))}))};sidePanelClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};load(e,t){this._resourceType=e,this._resourceId=t,this._list.clear();const o=g.t.references(e.type);return o&&Object.entries(o).forEach((([e,t])=>{t.forEach((t=>{const o=document.createElement("list-row");o.setAttribute("data-target",e),o.setAttribute("data-search",t.name);const s=document.createElement("list-item");s.setAttribute("data-icon",g.t.ResourceIcon(e)),s.setAttribute("data-primary",`${e}.${t.name}`),s.setAttribute("data-secondary",t.documentation.length>100?`${t.documentation.substring(0,100)}...`:t.documentation),o.appendChild(s),this._list.appendChild(o)}))})),this._list.children.length>0}}customElements.define("resource-references",L);var A=new URL(__webpack_require__(156),__webpack_require__.b);const q='<link rel="stylesheet" href="'+t()(A)+"\"> <style>main{--indent:32px;display:flex;flex-direction:column;height:100%}#content,resource-template-view{flex:1 1 auto;height:0}#content{color:var(--text-color-normal,#000);font-family:monospace;overflow:auto;padding:1em;white-space:nowrap}dl{margin:0;padding-left:var(--indent)}dt{list-style-type:none}span{color:var(--json-viewer-values-color,#000);cursor:inherit}span.key{color:var(--json-viewer-properties-color,#000)}span.key::before{content:'\"'}span.key::after{content:'\": '}dt.array>span.value>dl>dt>span.key::before{content:''}dt.array>span.value>dl>dt>span.key::after{content:': '}span.value a{color:inherit}span.value.string::before{content:'\"'}span.value.string::after{content:'\"'}dt.array>span.value::before{content:'['}dt.array>span.value::after{content:']'}dt.object>span.value::before{content:'{'}dt.object>span.value::after{content:'}'}dt,dt.array>span.value::after,dt.object>span.value::after{padding-left:var(--indent)}dt.array,dt.object{padding-left:0}dt.array::before,dt.object::before{cursor:pointer;content:'expand_less ';font-family:'Material Symbols Sharp';font-weight:700;line-height:inherit;vertical-align:middle;color:var(--text-color-disabled,#000)}dt:not(:last-child)::after{content:\",\"}dt.collapsed::before{content:'expand_more '}dt.collapsed>span dl{display:none}dt.array.collapsed span.value::after{content:'...]';padding-left:0}dt.object.collapsed span.value::after{content:'...}';padding-left:0}footer{text-align:right;padding:.5em;border-top:1px solid var(--border-color);display:flex;flex-direction:row;gap:2em;align-items:center;min-height:35px}footer app-switch{vertical-align:middle}footer>label{white-space:nowrap}footer>section{flex:1 1 auto;display:flex}#search{flex:1 1 auto;width:100%;border-radius:1em;border:1px solid var(--border-color);padding:.5em 1em}::highlight(search-results),::selection{background-color:#e5971a;color:#000}@media (max-width:480px){#content{line-height:2em}}</style> <main> <div id=\"content\"></div> <resource-template-view hidden></resource-template-view> <footer> <label>Template<app-switch id=\"use-template-toggle\"></app-switch></label> <section><input type=\"text\" id=\"search\" placeholder=\"Search\"></section> <label>Sort<app-switch id=\"sort-toggle\"></app-switch></label> <app-button id=\"template-edit-button\" value=\"edit template\"></app-button> </footer> </main>";class I extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{position:relative;display:inline-block;width:36px;height:20px;top:2px}main input{opacity:0;width:0;height:0}span{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--text-color-disabled);-webkit-transition:.4s;transition:.4s;border-radius:34px}span:before{position:absolute;content:"";height:14px;width:14px;left:3px;bottom:3px;background-color:#fff;-webkit-transition:.4s;transition:.4s;border-radius:50%}.checked span{background-color:var(--primary-color)}.focus span{box-shadow:0 0 1px var(--primary-color)}.checked span:before{transform:translateX(15px)}</style> <main> <span></span> </main>',this._main=null}static get observedAttributes(){return["data-checked"]}attributeChangedCallback(e,t,o){const s=this._shadow.querySelector("main");"data-checked"==e&&(null===o?s.classList.remove("checked"):s.classList.add("checked"))}connectedCallback(){this._shadow.addEventListener("click",this.clickHandler)}clickHandler=e=>{this.hasAttribute("data-checked")?this.removeAttribute("data-checked"):this.setAttribute("data-checked","")}}window.customElements.define("app-switch",I),__webpack_require__(898),__webpack_require__(664);class B extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%}resource-template-editor{flex:1 1 auto;height:0}footer{border-top:1px solid var(--border-color);text-align:center;padding:.5em}</style> <app-dialog data-title="Template" fullscreen centered> <main> <resource-template-editor></resource-template-editor> <footer> <app-button id="cancel" value="Cancel"></app-button> <app-button id="formOk" value="Save"></app-button> </footer> </main> </app-dialog>'}connectedCallback(){this._shadow.querySelector("app-dialog").onClose=this.dialogOnClose,this._shadow.getElementById("cancel").onclick=this.dialogOnClose}dialogOnClose=e=>{e.preventDefault(),e.stopPropagation(),"cancel"==e.target.id&&(this.hidden=!0)};set source(e){this._shadow.querySelector("resource-template-editor").source=e}}customElements.define("resource-template-editor-dialog",B);class M extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=q,this._sort=!1,this._resource=null,this._content=null,this._sortToggle=null,this._templateToggle=null,this._templateView=null,this._preferences={},this._templateEditButton=null}connectedCallback(){this._content=this._shadow.getElementById("content"),this._content.onclick=this.contentClick,this._preferences=i.y.get("jsonView",{sorted:!1,template:!1}),this._sort=this._preferences.sorted,this._sortToggle=this._shadow.getElementById("sort-toggle"),this._sortToggle.parentNode.onclick=this.sortToggleClick,this._sort?this._sortToggle.setAttribute("data-checked",""):this._sortToggle.removeAttribute("data-checked"),this._search=this._shadow.getElementById("search"),this._search.addEventListener("keydown",this.searchKeyDown),this._search.hidden=!0,this._templateToggle=this._shadow.getElementById("use-template-toggle"),this._templateView=this._shadow.querySelector("resource-template-view"),this._templateEditButton=this._shadow.getElementById("template-edit-button"),this._templateToggle.parentNode.hidden=!0,this._template=!1,this._templateView.hidden=!0,this._templateEditButton.hidden=!0}searchKeyDown=e=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||this.search()};search=()=>{const e=this._search.value.trim().toLowerCase();if(!e)return;const t=document.evaluate(`.//span[contains(text(), '${e}')]/text()`,this._content,null,XPathResult.ANY_TYPE,null).iterateNext(),o=t.textContent.indexOf(e),s=new Range;s.setStart(t,o),s.setEnd(t,o+e.length),getSelection().removeAllRanges(),getSelection().addRange(s),t.parentNode.scrollIntoView()};showTemplateEditor=()=>{this._editor.source=this._resource,this._editor.hidden=!1};showTemplate=e=>{this._templateView.hidden=!e,this._templateEditButton.hidden=!e,this._content.hidden=e,this._search.hidden=e,this._sortToggle.parentNode.hidden=e};sortToggleClick=({target:e})=>{const t="data-checked";"APP-SWITCH"!==e.nodeName&&(this._sortToggle.hasAttribute(t)?this._sortToggle.removeAttribute(t):this._sortToggle.setAttribute(t,"")),this._sort=this._sortToggle.hasAttribute(t),this._preferences.sorted=this._sort,i.y.set("jsonView",this._preferences),this.source=this._resource};templateToggleClick=({target:e})=>{const t="data-checked";"APP-SWITCH"!==e.nodeName&&(this._templateToggle.hasAttribute(t)?this._templateToggle.removeAttribute(t):this._templateToggle.setAttribute(t,"")),this._template=this._templateToggle.hasAttribute(t),this.showTemplate(this._template),this._template&&(this._templateView.source=this._resource),this._preferences.template=this._template,i.y.set("jsonView",this._preferences)};contentClick=({target:e,offsetX:t,offsetY:o,ctrlKey:s})=>{if(e.classList.contains("array")||e.classList.contains("object")){const i=e.childNodes[0];if(i&&t<i.offsetLeft&&o<i.offsetHeight&&(e.classList.toggle("collapsed"),s)){const t=e.classList.contains("collapsed");Array.from(e.querySelectorAll("dt")).filter((e=>e.classList.contains("object")||e.classList.contains("array"))).forEach((e=>{t?e.classList.add("collapsed"):e.classList.remove("collapsed")}))}}};clear=()=>{this._content.scrollTo(0,0),this._content.innerHTML="Loading...",this._content.style.cursor="wait",this._resource=null};get resourceType(){return this._resource.resourceType}get resourceId(){return this._resource.id}get source(){return this._resource}set source(e){this._content.scrollTo(0,0),this._content.innerHTML="",this._content.appendChild(document.createTextNode("{")),this._content.appendChild(this.parse(e)),this._content.appendChild(document.createTextNode("}")),this._content.style.cursor="default",this._resource=e,this._templateView.source=e}parse=e=>{let t=document.createElement("dl"),o=Object.entries(e);return this._sort&&(o=o.sort()),o.forEach((([e,o])=>{const s=document.createElement("dt"),i=document.createElement("span");i.className="key",i.innerText=e,s.appendChild(i);const r=document.createElement("span");if(r.classList.add("value"),null===o)r.innerText="null";else if("string"==typeof o)if(r.classList.add("string"),"reference"===e){let e=o.replace(`${g.t.server.url}`,"");e.startsWith("/")||e.startsWith("?")||(e=`/${e}`);let t=document.createElement("a");t.setAttribute("href",`#${e}`),t.appendChild(document.createTextNode(o)),r.appendChild(t)}else r.innerText=o;else"object"==typeof o?(s.classList.add(Array.isArray(o)?"array":"object"),r.appendChild(this.parse(o))):r.innerText=o;s.appendChild(r),t.appendChild(s)})),t}}customElements.define("resource-json-view",M);class D extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{display:flex;flex-direction:column;height:100%}#content{color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;white-space:pre;margin:0}@media (max-width:480px){#content{line-height:2em}}</style> <main> <pre id="content"></pre> </main>',this._resource=null}clear=()=>{const e=this._shadow.getElementById("content");e.scrollTo(0,0),e.innerHTML="Loading...",e.style.cursor="wait",this._resource=null};get resourceType(){return this._resource.match(/rdf:type\s+fhir:(\w+)/)[1]}get resourceId(){return this._resource.match(/fhir:Resource.id\s+\[\s+fhir:value\s+"([^"]+)"\s+\];/)[1]}get source(){return this._resource}set source(e){const t=this._shadow.getElementById("content");t.scrollTo(0,0),t.innerText=e,t.style.cursor="default",this._resource=e}}customElements.define("resource-ttl-view",D);var O=new URL(__webpack_require__(156),__webpack_require__.b);const P='<link rel="stylesheet" href="'+t()(O)+"\"> <style>main{--indent:32px;display:flex;flex-direction:column;height:100%}#content{color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;margin:0;white-space:nowrap}dl{margin:0;padding-left:var(--indent)}#content>dl{padding-left:0}dt{list-style-type:none}span.key{color:var(--xml-viewer-nodes-color,#000)}span.key::before{content:'<'}span.key::after{content:'>'}span.attributes{color:var(--xml-viewer-attributes-color,#000)}span.values{color:var(--xml-viewer-values-color,#000)}span.values a{color:inherit}span.key.end{padding-left:var(--indent)}dt,dt.object>span.value::after{padding-left:var(--indent)}dt.object{padding-left:0}dt.object::before{cursor:pointer;content:'expand_less ';font-family:'Material Symbols Sharp';font-weight:700;line-height:inherit;vertical-align:middle;color:var(--text-color-disabled,#000)}dt.collapsed::before{content:'expand_more '}dt.collapsed>span dl{display:none}dt.object.collapsed span.value::after{content:'...';padding-left:0}dt.object.collapsed span.key.end{padding-left:0}footer{text-align:right;padding:.5em;border-top:1px solid var(--border-color)}footer app-switch{vertical-align:middle}@media (max-width:480px){#content{line-height:2em}}</style> <main> <div id=\"content\"></div> <footer><label>Sort<app-switch></app-switch></label></footer> </main>";class H extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=P,this._sort=!1,this._resource=null}connectedCallback(){this._shadow.getElementById("content").onclick=this.contentClick,this._sort=i.y.get("xmlView",{sorted:!1}).sorted;const e=this._shadow.querySelector("app-switch");this._shadow.querySelector("app-switch").parentNode.onclick=this.sortToggleClick,this._sort?e.setAttribute("data-checked",""):e.removeAttribute("data-checked")}sortToggleClick=({target:e})=>{const t=this._shadow.querySelector("app-switch"),o="data-checked";"APP-SWITCH"!==e.nodeName&&(t.hasAttribute(o)?t.removeAttribute(o):t.setAttribute(o,"")),this._sort=t.hasAttribute(o),i.y.set("xmlView",{sorted:this._sort}),this.source=this._resource};contentClick=({target:e,offsetX:t,offsetY:o,ctrlKey:s})=>{if(e.classList.contains("object")){const i=e.childNodes[0];if(i&&t<i.offsetLeft&&o<i.offsetHeight&&(e.classList.toggle("collapsed"),s)){const t=e.classList.contains("collapsed");Array.from(e.querySelectorAll("dt")).filter((e=>e.classList.contains("object"))).forEach((e=>{t?e.classList.add("collapsed"):e.classList.remove("collapsed")}))}}};clear=()=>{const e=this._shadow.getElementById("content");e.scrollTo(0,0),e.innerHTML="Loading...",e.style.cursor="wait",this._resource=null};get resourceType(){return this._resource?.documentElement?.nodeName}get resourceId(){return this._resource?.documentElement?.querySelector("id[value]")?.getAttribute("value")}get source(){return this._resource}set source(e){const t=this._shadow.getElementById("content");t.scrollTo(0,0),t.innerHTML=this.parse(e).outerHTML,t.style.cursor="default",this._resource=e}parse=e=>{let t=document.createElement("dl"),o=Array.from(e.children);return this._sort&&o.sort(((e,t)=>e.nodeName.localeCompare(t.nodeName))),o.forEach((e=>{const o=document.createElement("dt");let s=document.createElement("span");s.className="key",s.innerText=e.nodeName,o.appendChild(s),e.attributes.length&&Array.from(e.attributes).forEach((t=>{let o=document.createElement("span");o.className="attributes",o.innerText=` ${t.nodeName}=`,s.appendChild(o);let i=document.createElement("span");if(i.className="values","reference"===e.nodeName&&"value"===t.nodeName){let e=t.nodeValue.replace(`${g.t.server.url}`,"");e.startsWith("/")||e.startsWith("?")||(e=`/${e}`);let o=document.createElement("a");o.setAttribute("href",`#${e}`),o.appendChild(document.createTextNode(`"${t.nodeValue}"`)),i.appendChild(o)}else i.innerText=`"${t.nodeValue}"`;o.appendChild(i)}));const i=document.createElement("span");i.classList.add("value"),e.children.length?(o.classList.add("object"),i.innerHTML=this.parse(e).outerHTML,o.appendChild(i),s=document.createElement("span"),s.className="key end",s.innerText=`/${e.nodeName}`,o.appendChild(s)):s.innerHTML+="/",t.appendChild(o)})),t}}customElements.define("resource-xml-view",H);var R=__webpack_require__(332);class N extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=x,this._resourceType=null,this._resourceId=null,this._views={}}connectedCallback(){this._shadow.getElementById("help").onclick=this.helpClick,this._shadow.getElementById("download").onclick=this.downloadClick,this._shadow.getElementById("copy").onclick=this.copyClick,this._shadow.getElementById("share").onclick=this.shareClick,this._shadow.getElementById("referencesToggle").onclick=this.referenceToggleClick,this._shadow.getElementById("historyToggle").onclick=this.historyToggleClick,this._shadow.querySelector("app-tabs").addEventListener("select",this.tabSelect),g.t.addListener(this.serverChanged)}tabSelect=({detail:e})=>{const t=e.caption,o=location.hash.match(/\?([^?]+)$/);if(o?.length>0){const e=new URLSearchParams(o[1]);e.set("_format",t),location.hash=location.hash.replace(/\?[^?]+$/,`?${e.toString()}`)}else location.hash=`${location.hash}?_format=${t}`;const s=this._shadow.querySelector("resource-history");s&&!s.hidden&&s.load(this._resourceType,this._resourceId)};referenceToggleClick=()=>{const e=this._shadow.querySelector("resource-references");e.hidden&&(this._shadow.querySelector("resource-history").hidden=!0),e.hidden=!e.hidden};historyToggleClick=()=>{const e=this._shadow.querySelector("resource-history");e.hidden&&(this._shadow.querySelector("resource-references").hidden=!0,e.load(this._resourceType,this._resourceId)),e.hidden=!e.hidden};helpClick=()=>{window.open(`${g.t.helpUrl(this._resourceType.type)}#resource`,"FhirBrowserHelp")};downloadClick=()=>{let e,t,o=this.getCurrentContent();switch(o.type){case"ttl":e="data:text/plain;charset=utf-8",t="txt";break;case"xml":e="data:text/xml;charset=utf-8",t="xml";break;default:e="data:text/json;charset=utf-8",t="json"}const s=new File([o.value],this._resourceId,{type:e}),i=URL.createObjectURL(s),r=document.createElement("a");r.href=i,r.download=`${this._resourceType.type}#${s.name}.${t}`,this._shadow.appendChild(r),r.click(),this._shadow.removeChild(r),window.URL.revokeObjectURL(i)};copyClick=()=>{let e=this.getCurrentContent().value;navigator.clipboard.writeText(e).then((function(){R.h.show("Copying to clipboard was successful")}),(function(e){R.h.error("Could not copy text")}))};shareClick=()=>{let e=this.getCurrentContent().value;const t=`${this._resourceType.type}.${this._resourceId}.txt`,o=new File([e],t,{type:"text/plain"});navigator.share({title:t,files:[o]})};getCurrentContent=()=>{const e=this._shadow.querySelector("app-tabs").value;let t=this._views[e].source;switch(e){case"json":t=JSON.stringify(t);break;case"xml":t=(new XMLSerializer).serializeToString(t)}return{type:e,value:t}};serverChanged=()=>{const e=this._shadow.querySelector("app-tabs");for(;e.firstChild;)e.removeChild(e.lastChild);if(this._views={},g.t.formatEnable("json")){const e=document.createElement("resource-json-view"),t=document.createElement("section");t.dataset.caption="json",t.appendChild(e),this._shadow.querySelector("app-tabs").appendChild(t),this._views.json=e}if(g.t.formatEnable("xml")){const e=document.createElement("resource-xml-view"),t=document.createElement("section");t.dataset.caption="xml",t.appendChild(e),this._shadow.querySelector("app-tabs").appendChild(t),this._views.xml=e}if(g.t.formatEnable("ttl")){const e=document.createElement("resource-ttl-view"),t=document.createElement("section");t.dataset.caption="ttl",t.appendChild(e),this._shadow.querySelector("app-tabs").appendChild(t),this._views.ttl=e}};set source(e){let t;if(t=e instanceof Document?"xml":"object"==typeof e?"json":"ttl",t){const o=this._views[t];o.source=e;let s=o.resourceType;this._shadow.getElementById("title").innerText=s;const i=o.resourceId;i==this._resourceId&&s==this._resourceType?.type||(this._resourceType=g.t.server.capabilities.rest[0].resource.find((e=>e.type===s)),this._resourceId=i,Object.entries(this._views).filter((([e])=>e!=t)).forEach((([,e])=>e.clear()))),this._shadow.querySelector("app-tabs").value=t}window.matchMedia("(max-width: 480px)").matches&&(this._shadow.querySelector("resource-references").hidden=!0,this._shadow.querySelector("resource-history").hidden=!0),this._resourceType.interaction.find((({code:e})=>"vread"==e))?this._shadow.getElementById("historyToggle").hidden=!1:(this._shadow.getElementById("historyToggle").hidden=!0,this._shadow.querySelector("resource-history").hidden=!0),this._shadow.querySelector("resource-references").load(this._resourceType,this._resourceId)?this._shadow.getElementById("referencesToggle").hidden=!1:(this._shadow.getElementById("referencesToggle").hidden=!0,this._shadow.querySelector("resource-references").hidden=!0)}}customElements.define("fhir-resource",N),__webpack_require__(627);class $ extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}</style> <main> <app-list></app-list> </main>",this._list=null}connectedCallback(){this._list=this._shadow.querySelector("app-list"),this._list.onclick=this.appListClick}appListClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("list-row");t&&(this.value=t.dataset.id,this.dispatchEvent(new CustomEvent("serverchanged",{bubbles:!0,cancelable:!0,detail:{serverCode:t.dataset.id}})))};load(e){this._list.clear(),Object.keys(e).sort(((e,t)=>e.localeCompare(t))).forEach((t=>{const o=document.createElement("list-row");o.setAttribute("data-id",t);const s=document.createElement("list-item");s.setAttribute("data-primary",t),s.setAttribute("data-secondary",e[t].url),o.appendChild(s),this._list.appendChild(o)}))}get value(){return this._list.querySelector("list-row[selected]")?.dataset.id}set value(e){this._list.querySelector("list-row[selected]")?.removeAttribute("selected");const t=this._list.querySelector(`list-row[data-id="${e}"]`);t&&(t.setAttribute("selected","true"),t.scrollIntoView())}}customElements.define("server-list",$);var U=new URL(__webpack_require__(156),__webpack_require__.b);const j='<link rel="stylesheet" href="'+t()(U)+'"> <style>main{position:absolute;top:0;left:0;background-color:rgba(0,0,0,32%);min-height:100%;min-width:100%}.surface{background-color:var(--background-color,#fff);border-radius:4px;position:absolute;left:50%;top:50%;transform:translateX(-50%) translateY(-50%)}.overlay{background-color:rgba(255,255,255,4%);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:Roboto,Arial,monospace;height:100%}h2{margin:.5em 1em}footer{padding:9px 16px;text-align:right;overflow:visible}@media (max-width:480px){.surface{width:90%}.overlay{background-color:transparent}}</style> <main> <div class="surface"> <div class="overlay"> <h2></h2> <slot></slot> <footer> <app-button id="btnCancel" value="cancel"></app-button> <app-button id="btnOk" value="ok"></app-button> </footer> </div> </div> </main>';class F extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=j}connectedCallback(){this._shadow.querySelector("main").onclick=this._onClose,this._shadow.querySelector(".surface").onclick=e=>{e.stopPropagation()},this._shadow.getElementById("btnOk").onclick=this.validateClick,this._shadow.getElementById("btnCancel").onclick=this._onClose}_onClose=e=>{this.hidden=!0};validateClick=e=>{this.onValidate(e),this.hidden=!0};_onValidate=e=>{};get onValidate(){return this._onValidate}set onValidate(e){this._onValidate=e}static get observedAttributes(){return["data-title","data-ok-text"]}attributeChangedCallback(e,t,o){"data-title"===e?this._shadow.querySelector("h2").innerText=o:"data-ok-text"===e&&this._shadow.getElementById("btnOk").setAttribute("value",o)}}window.customElements.define("app-confirm",F),__webpack_require__(719);class V extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%;font-family:Roboto,Arial,monospace}#content{flex:1 1 auto;height:0;padding:1em;overflow-y:auto;min-width:40em}#formDialog footer{border-top:1px solid var(--border-color)}footer{padding:9px 16px;text-align:right;overflow:hidden}p{margin:0;padding:1em}.authMethod{display:flex;flex-flow:row wrap;gap:1em;padding-bottom:1em}.authMethod label{font-family:inherit;font-size:inherit;margin-right:1em;white-space:nowrap}@media (max-width:480px){#content{min-width:unset}}</style> <app-dialog id="formDialog" centered> <round-button slot="appBarRight" id="formDelete" title="Delete" data-icon="delete"></round-button> <main> <section id="content"> <text-field id="key" placeholder="Code" required></text-field> <text-field id="url" placeholder="Url" required></text-field> <div class="authMethod"> <label for="No Auth">No Auth <input type="radio" id="No Auth" name="authMethod" value="No Auth" checked="checked"/> </label> <label for="API Key">API Key <input type="radio" id="API Key" name="authMethod" value="API Key"/> </label> <label for="Basic">Basic <input type="radio" id="Basic" name="authMethod" value="Basic"/> </label> <label for="OAuth 2">OAuth 2 <input type="radio" id="OAuth 2" name="authMethod" value="OAuth 2"/> </label> </div> <section id="apiSection" hidden> <text-field id="apiKey" placeholder="Key" required></text-field> <text-field id="apiValue" placeholder="Value" required></text-field> </section> <section id="basicSection" hidden> <text-field id="basicUsername" placeholder="Username" required></text-field> <text-field id="basicPassword" placeholder="Password" required></text-field> </section> <section id="oauthSection" hidden> <text-field id="oauthTokenurl" placeholder="Access Token URL" required></text-field> <text-field id="oauthClientid" placeholder="Client ID" required></text-field> <text-field id="oauthClientsecret" placeholder="Client Secret" required></text-field> <text-field id="oauthGranttype" placeholder="Grant Type" value="client_credentials" required readonly="readonly"></text-field> </section> </section> <footer> <app-button id="formCancel" value="Cancel"></app-button> <app-button id="formOk" value="Apply"></app-button> </footer> </main> </app-dialog> <app-confirm data-ok-text="delete" hidden> <p>Delete this configuration?</p> </app-confirm>'}static get observedAttributes(){return["data-title"]}attributeChangedCallback(e,t,o){"data-title"==e&&this._shadow.querySelector("app-dialog").setAttribute("data-title",o)}connectedCallback(){this._shadow.querySelector("app-dialog").onClose=this.appDialogClose,this._shadow.querySelectorAll("input[name='authMethod']").forEach((e=>{e.addEventListener("change",this.authMethodChange)})),this._shadow.getElementById("formCancel").onclick=this.formCancelClick,this._shadow.getElementById("formDelete").onclick=this.formDeleteClick,this._shadow.getElementById("formOk").onclick=this.formOkClick,this._shadow.querySelector("main").onkeydown=this.mainKeyDown,this._shadow.querySelector("app-confirm").onValidate=this.deleteConfirm}appDialogClose=e=>{this.onCancel(e),e.preventDefault(),e.stopPropagation()};formOkClick=e=>{this.checkValidity()&&this.onOk(e)&&(this.hidden=!0)};formCancelClick=e=>{this.onCancel(e)};formDeleteClick=()=>{this._shadow.querySelector("app-confirm").hidden=!1};deleteConfirm=e=>{this.onDelete(e),this.hidden=!0};mainKeyDown=e=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||!this.checkValidity()||this.onOk(e)&&(this.hidden=!0)};authMethodChange=()=>{const e=this._shadow.querySelector("input[name='authMethod']:checked").value;this._shadow.getElementById("apiSection").hidden="API Key"!==e,this._shadow.getElementById("basicSection").hidden="Basic"!==e,this._shadow.getElementById("oauthSection").hidden="OAuth 2"!==e};_onOk=e=>{this.hidden=!0};get onOk(){return this._onOk}set onOk(e){this._onOk=e}_onCancel=e=>{this.hidden=!0};get onCancel(){return this._onCancel}set onCancel(e){this._onCancel=e}_onDelete=()=>{this.hidden=!0};get onDelete(){return this._onDelete}set onDelete(e){this._onDelete=e}checkValidity=function(){let e=this;if(t("key")&&t("url"))switch(this._shadow.querySelector("input[name='authMethod']:checked").value){case"No Auth":return!0;case"API Key":return t("apiKey")&&t("apiValue");case"Basic":return t("basicUsername")&&t("basicPassword");case"OAuth 2":return t("oauthTokenurl")&&t("oauthClientid")&&t("oauthClientsecret")&&t("oauthGranttype")}return!1;function t(t){let o=e._shadow.getElementById(t);return!!o.checkValidity()||(o.focus(!0),!1)}};get value(){const e=this._shadow.querySelector("input[name='authMethod']:checked").value;let t={serverCode:this._shadow.getElementById("key").value,url:this._shadow.getElementById("url").value,auth:{method:"noauth",setup:{}}};switch(e){case"API Key":t.auth.method="apikey",t.auth.setup.key=this._shadow.getElementById("apiKey").value,t.auth.setup.value=this._shadow.getElementById("apiValue").value;break;case"Basic":t.auth.method="basic",t.auth.setup.username=this._shadow.getElementById("basicUsername").value,t.auth.setup.password=this._shadow.getElementById("basicPassword").value;break;case"OAuth 2":t.auth.method="oauth2",t.auth.setup.access_token_url=this._shadow.getElementById("oauthTokenurl").value,t.auth.setup.client_id=this._shadow.getElementById("oauthClientid").value,t.auth.setup.client_secret=this._shadow.getElementById("oauthClientsecret").value,t.auth.setup.grant_type=this._shadow.getElementById("oauthGranttype").value}return t}set value({serverCode:e,server:t}){switch(e?(this._shadow.querySelector("app-dialog").setAttribute("data-title",e),this._shadow.getElementById("formDelete").hidden=!1):(this._shadow.querySelector("app-dialog").setAttribute("data-title","New"),this._shadow.getElementById("formDelete").hidden=!0),this.clear(),this._shadow.getElementById("key").value=e,this._shadow.getElementById("url").value=t.url,t?.auth?.method){case"apikey":this._shadow.getElementById("API Key").checked=!0,this._shadow.getElementById("apiKey").value=t.auth.setup.key,this._shadow.getElementById("apiValue").value=t.auth.setup.value;break;case"basic":this._shadow.getElementById("Basic").checked=!0,this._shadow.getElementById("basicUsername").value=t.auth.setup.username,this._shadow.getElementById("basicPassword").value=t.auth.setup.password;break;case"oauth2":this._shadow.getElementById("OAuth 2").checked=!0,this._shadow.getElementById("oauthTokenurl").value=t.auth.setup.access_token_url,this._shadow.getElementById("oauthClientid").value=t.auth.setup.client_id,this._shadow.getElementById("oauthClientsecret").value=t.auth.setup.client_secret,this._shadow.getElementById("oauthGranttype").value=t.auth.setup.grant_type;break;default:this._shadow.getElementById("No Auth").checked=!0}this.authMethodChange()}clear(){this._shadow.getElementById("content").querySelectorAll("text-field").forEach((e=>e.value="")),this._shadow.getElementById("oauthGranttype").value="client_credentials"}}customElements.define("server-form",V);class K{static{this.KEY="conf"}static setAll(e){localStorage.setItem(this.KEY,JSON.stringify(e))}static async getAll(){let e=localStorage.getItem(this.KEY);return null===e?await fetch("./default.conf",{cache:"reload"}).then((e=>e.json())).then((e=>(localStorage.setItem(this.KEY,JSON.stringify(e)),e))):JSON.parse(e)}static async get(e){return await this.getAll().then((t=>t[e]))}}class z extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%;min-width:400px}#list{flex:1 1 auto;height:0}#setupAdd{position:absolute;bottom:4em;right:1em;background-color:var(--primary-color);border-radius:100%;color:#fff;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}footer{border-top:1px solid var(--border-color);padding:9px 16px;text-align:right;overflow:hidden}app-dialog #setupToggle,app-dialog.edit #setupAdd,app-dialog.edit footer{display:block}app-dialog #setupAdd,app-dialog footer,app-dialog.edit #setupToggle{display:none}#setupClose{display:none}@media (max-width:480px){main{min-width:none}#setupClose{display:block}}</style> <app-dialog id="serverDialog" data-title="Connections"> <round-button slot="appBarLeft" id="setupClose" title="close" data-icon="close"></round-button> <round-button slot="appBarRight" id="setupToggle" title="setup" data-icon="edit"></round-button> <main> <section id="list"> <server-list></server-list> <round-button id="setupAdd" title="add" data-icon="add"></round-button> </section> <footer> <app-button id="setupCancel" value="cancel"></app-button> <app-button id="setupOk" value="save"></app-button> </footer> </main> </app-dialog> <server-form hidden></server-form>',this._editMode=!1,this._list=null,this._form=null}connectedCallback(){this._list=this._shadow.querySelector("server-list"),this._form=this._shadow.querySelector("server-form"),this._shadow.querySelector("app-dialog").onClose=e=>{e.preventDefault(),e.stopPropagation(),this.appDialogClose()},this._form.onOk=this.serverFormOk,this._form.onDelete=this.serverFormDelete,this._list.addEventListener("serverchanged",this.serverListClick),this._shadow.getElementById("setupAdd").onclick=this.setupAddClick,this._shadow.getElementById("setupCancel").onclick=this.setupCancel,this._shadow.getElementById("setupOk").onclick=this.setupOk,this._shadow.getElementById("setupClose").onclick=this.appDialogClose,this._shadow.getElementById("setupToggle").onclick=()=>{this.editMode=!0},this.editMode=!1,this.loadConf()}loadConf=()=>{K.getAll().then((e=>{this._conf=e,this._list.load(e),this._list.value=g.t.server?.serverCode}))};setupOk=()=>{K.setAll(this._conf),this.editMode=!1,this.loadConf()};setupCancel=()=>{this.editMode=!1,this.loadConf()};setupAddClick=()=>{this.value="",this._form.value={serverCode:"",server:{url:""}},this._form.hidden=!1};serverListClick=e=>{const t=e.detail.serverCode,o=this._conf[t];this.editMode?(this._form.value={serverCode:t,server:o},this._form.hidden=!1):(this.editMode=!1,this.hidden=!0,e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("serverchanged",{bubbles:!1,cancelable:!1,detail:{serverCode:t,server:o}})))};serverFormDelete=()=>{const e=this._form.value.serverCode;return delete this._conf[e],this._list.load(this._conf),!0};serverFormOk=()=>{const e=this._form.value,t=this.value,o=e.serverCode;if(delete e.serverCode,t)delete this._conf[t];else if(this._conf[o])return R.h.show("this configuration already exists",void 0,void 0,"error"),!1;return this._conf[o]=e,this._list.load(this._conf),!0};appDialogClose=()=>{this.editMode=!1,this.hidden=!0};get value(){return this._list.value}set value(e){this._list.value=e}get editMode(){return this._editMode}set editMode(e){this._editMode=e;const t=this._shadow.querySelector("app-dialog");e?t.classList.add("edit"):t.classList.remove("edit")}}customElements.define("server-dialog",z),"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js");class W extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s}async fetchHash(e){const t=new URL(`${g.t.server.url}${e}`),o=setTimeout((()=>{this._shadow.getElementById("waiting").style.visibility="visible"}),500);try{const e=await fetch(t,{headers:g.t.server.headers});if(!e.ok)throw new Error(`${e.status} ${e.statusText}`);this._shadow.getElementById("bdy").style.visibility="visible";const o=e.headers.get("Content-Type");let s,i;if(o.includes("json"))i=await e.json(),s=i.resourceType;else if(o.includes("xml"))i=(new DOMParser).parseFromString(await e.text(),"application/xml"),s=i.documentElement.nodeName;else{i=await e.text();const t=i.match(/rdf:type\s+fhir:(\w+)/);t&&(s=t[1])}if(!s)throw new Error("Unknown response format");if("Bundle"==s){const e=this._shadow.getElementById("bundle");e.hidden=!1,e.source=i}else this._shadow.getElementById("bundle").hidden=!0,this._shadow.getElementById("resource").source=i}catch(e){R.h.show(e,void 0,void 0,"error")}finally{clearTimeout(o),this._shadow.getElementById("waiting").style.visibility="hidden"}}locationHandler=()=>{let e=window.location.hash.replace("#","").trim();e.length?(this.fetchHash(e),window.matchMedia("(max-width: 480px)").matches&&this._shadow.querySelector("server-panel").classList.add("hidden")):(this._shadow.getElementById("bdy").style.visibility="hidden",this._shadow.querySelector("server-panel").classList.remove("hidden"))};get container(){return this._shadow}connectedCallback(){window.addEventListener("hashchange",this.locationHandler),R.h.container=this._shadow,this._shadow.getElementById("navigation").onclick=()=>{this._shadow.querySelector("server-panel").classList.toggle("hidden")},this._shadow.getElementById("serverDialogToggle").onclick=()=>{this._shadow.querySelector("server-dialog").hidden=!1},this._shadow.querySelector("server-dialog").addEventListener("serverchanged",(({detail:e})=>{this.connect(e.serverCode,e.server)})),this._shadow.getElementById("aboutDialogToggle").onclick=()=>{this._shadow.querySelector("about-dialog").hidden=!1};const e=i.y.get("server");e?K.get(e).then((t=>{this.connect(e,t)})):this._shadow.querySelector("server-dialog").hidden=!1}connect(e,t){const o=this._shadow.getElementById("waiting");o.style.visibility="visible",g.t.connect(e,t).then((()=>{R.h.show(`Connected to "${e}" server.`),i.y.set("server",e),this._shadow.getElementById("navigation").hidden=!1,this._shadow.querySelector("server-dialog").value=e,location.hash?location.hash="":this.locationHandler()})).catch((t=>{R.h.error(`An error occurred while connecting to the server "${e}"`),console.log(t)})).finally((()=>{o.style.visibility="hidden"}))}}customElements.define("fhir-browser",W)})()})();