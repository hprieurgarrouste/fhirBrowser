(()=>{"use strict";var __webpack_modules__={47:(e,t,o)=>{o.d(t,{A:()=>r});class r extends HTMLElement{#e;#t;#o;constructor(e="",t="",o=""){super();const r=this.attachShadow({mode:"closed"});r.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{background-color:inherit;display:flex;flex-direction:row;align-items:center;gap:.5em}.text{flex:1 1 auto;overflow:hidden}#primary{display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:var(--text-color-normal,#000)}#primary:first-letter{text-transform:uppercase}#secondary{display:block;font-size:smaller;color:var(--text-color-disabled);overflow-wrap:break-word}</style> <main> <span id="icon" class="material-symbols-sharp"></span> <span class="text"> <span id="primary"></span> <span id="secondary"></span> </span> <section> <slot name="trailling"></slot> </section> </main>',this.#e=r.getElementById("icon"),this.icon=e,this.#t=r.getElementById("primary"),this.primary=t,this.#o=r.getElementById("secondary"),this.secondary=o}static get observedAttributes(){return["data-primary","data-secondary","data-icon"]}attributeChangedCallback(e,t,o){switch(e){case"data-icon":this.#e.innerText=o;break;case"data-primary":this.#t.innerHTML=o;break;case"data-secondary":this.#o.innerHTML=o}}get icon(){return this.#e.innerText}set icon(e){this.setAttribute("data-icon",e)}get primary(){return this.#t.innerHTML}set primary(e){this.setAttribute("data-primary",e)}get secondary(){return this.#o.innerHTML}set secondary(e){this.setAttribute("data-secondary",e)}}customElements.define("m2-list-item",r)},77:(e,t,o)=>{o.d(t,{A:()=>r});class r{#r="";#i=r.METHODS.None;#s={};#a=null;#n=null;#l=null;#c=null;#d=null;#h=null;#u=null;#p=null;#m=null;#g=r.CREDENTIALS.Header;static METHODS={None:"noauth",APIKey:"apikey",Basic:"basic",OAuth2:"oauth2"};static CREDENTIALS={Header:"header",Body:"body"};constructor(e=null){if(null!=e)switch(this.url=e.url,this.method=e.auth?.method||r.METHODS.None,this.headers=e.headers,this.#i){case r.METHODS.APIKey:this.apiKey=e.auth.setup?.key,this.apiValue=e.auth.setup?.value;break;case r.METHODS.Basic:this.basicUsername=e.auth.setup?.username,this.basicPassword=e.auth.setup?.password;break;case r.METHODS.OAuth2:this.oauthTokenUrl=e.auth.setup?.access_token_url,this.oauthClientId=e.auth.setup?.client_id,this.oauthClientSecret=e.auth.setup?.client_secret,this.oauthGrantType=e.auth.setup?.grant_type,this.#m=e.auth.setup?.scope||"",this.#g=e.auth.setup?.credentials||r.CREDENTIALS.Header;case r.METHODS.None:}}toString=()=>{const e={url:this.#r,auth:{method:this.#i,setup:{}}};switch(this.#i){case r.METHODS.APIKey:e.auth.setup.key=this.#a,e.auth.setup.value=this.#n;break;case r.METHODS.Basic:e.auth.setup.username=this.#l,e.auth.setup.password=this.#c;break;case r.METHODS.OAuth2:e.auth.setup.access_token_url=this.#d,e.auth.setup.client_id=this.#h,e.auth.setup.client_secret=this.#u,e.auth.setup.grant_type=this.#p,e.auth.setup.scope=this.#m,e.auth.setup.credentials=this.#g;case r.METHODS.None:}return e};get url(){return this.#r}set url(e){this.#r=e}get method(){return this.#i}set method(e=r.METHODS.None){if(!Object.entries(r.METHODS).find((([,t])=>t===e)))throw new Error(`authentication method '${e}' not supported`);this.#i=e}get headers(){return this.#s}set headers(e){this.#s=e}get apiKey(){return this.#a}set apiKey(e){this.#a=e}get apiValue(){return this.#n}set apiValue(e){this.#n=e}get basicUsername(){return this.#l}set basicUsername(e){this.#l=e}get basicPassword(){return this.#c}set basicPassword(e){this.#c=e}get oauthTokenUrl(){return this.#d}set oauthTokenUrl(e){this.#d=e}get oauthClientId(){return this.#h}set oauthClientId(e){this.#h=e}get oauthClientSecret(){return this.#u}set oauthClientSecret(e){this.#u=e}get oauthGrantType(){return this.#p}set oauthGrantType(e){this.#p=e}get oauthScope(){return this.#m}set oauthScope(e){this.#m=e}get oauthCredentials(){return this.#g}set oauthCredentials(e){this.#g=e||r.CREDENTIALS.Header}}},128:()=>{class e extends HTMLElement{#b;constructor(e,t){super();const o=this.attachShadow({mode:"closed"});o.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}button{padding:8px;border:0 none;color:inherit;background-color:transparent;border-radius:50%;user-select:none;outline:0}button:not([disabled]):hover{background-color:var(--hover-color,rgb(0 0 0 /5%));cursor:pointer}button[disabled]{color:var(--text-color-disabled)}</style> <button class="material-symbols-sharp" type="button"></button>',this.#b=o.querySelector("button"),e&&(this.icon=e),t&&(this.title=t)}static get observedAttributes(){return["data-icon","disabled"]}attributeChangedCallback(e,t,o){"data-icon"===e?this.#b.innerText=o:"disabled"===e&&(null===o?this.#b.removeAttribute("disabled"):this.#b.setAttribute("disabled",""))}get icon(){return this.getAttribute("data-icon")}set icon(e){this.setAttribute("data-icon",e)}}customElements.define("m2-round-button",e)},198:(e,t,o)=>{o.d(t,{A:()=>r}),o(805);const r=new class{#f=null;#y=[];#v=null;#w=()=>{this.#y.forEach((e=>{e.call()}))};addListener=e=>{this.#y.push(e)};get server(){return this.#f}set server(e){e!=this.#f&&(this.#f=e,this.#w())}get appContainer(){return this.#v}set appContainer(e){this.#v=e}}},270:(e,t,o)=>{o.d(t,{A:()=>i});var r=o(198);o(967);const i=new class{error(e){this.#x(e,"error")}info(e){this.#x(e,"info")}clear(){const e=r.A.appContainer.querySelector("m2-snackbar");e.type="info",e.innerText="",e.hidePopover()}#x(e,t="info",o=3e3){let i=r.A.appContainer.querySelector("m2-snackbar");i.type=t,i.innerText=e,i.showPopover(),setTimeout((()=>{i?.hidePopover()}),o)}}},287:(e,t,o)=>{o.d(t,{A:()=>r});const r=new class{#_="preferences";get(e,t=null){const o=localStorage.getItem(this.#_);let r=null;return null===o?t:(r=JSON.parse(o),r[e]||t)}set(e,t){const o=localStorage.getItem(this.#_);let r=null;r=null!==o?JSON.parse(o):{},r[e]=t,localStorage.setItem(this.#_,JSON.stringify(r))}}},344:()=>{class e extends HTMLElement{#k;#C;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;padding:.6em;font-size:smaller}main:focus-within{border-bottom-color:var(--primary-color,#000)}#text{background:0 0;border:0 none;color:var(--text-color-normal);flex:1 1 auto;font-family:inherit;font-size:inherit}#text:focus{outline:0}main i{cursor:pointer;font-size:larger!important;margin-left:4px;padding:2px;border-radius:3px}main i:hover{background-color:var(--hover-color)}main i.selected{color:var(--primary-color);border:1px solid var(--primary-color);padding:1px}</style> <main> <input id="text" type="text" placeholder="Type to filter" spellcheck="false"/> <i id="clear" class="material-symbols-sharp" title="Clear">close</i> <i id="case" class="material-symbols-sharp" title="Case sensitive">match_case</i> </main>',this.#k=e.getElementById("text"),this.#k.addEventListener("input",this.#S),e.querySelector("main").addEventListener("mousedown",(e=>{this.#k.focus()})),e.getElementById("clear").onclick=this.#E,this.#C=e.getElementById("case"),this.#C.onclick=this.#T}clear(){this.#E()}#E=()=>{this.#k.value&&(this.#k.value="",this.#S())};#T=()=>{this.#C.classList.toggle("selected"),this.#S()};#S=()=>{this.#M({value:this.#k.value,caseSensitive:this.#C.classList.contains("selected")})};#M=()=>{};get onChange(){return this.#M}set onChange(e){this.#M=e}}customElements.define("m2-list-filter",e);class t extends HTMLElement{#A;#L;#D;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}m2-list-filter{box-shadow:0 3px 4px var(--border-color)}main>section{overflow:auto;flex:1 1 auto;height:0}main>section>*{cursor:pointer}</style> <main> <m2-list-filter></m2-list-filter> <section id="list"> <slot></slot> </section> </main>',this.#L=e.getElementById("list"),this.#D=e.querySelector("slot"),this.#D.addEventListener("slotchange",this.#R),this.#A=e.querySelector("m2-list-filter"),this.#A.onChange=this.#B}connectedCallback(){this.#A.hidden=this.#D.children.length<=10}#I=e=>{};get onFilter(){return this.#I}set onFilter(e){this.#I=e}#B=e=>{""===e&&(this.#L.scrollTop=0),this.#I(e)};#R=()=>{this.#A.hidden="function"!=typeof this.#I||this.#D.assignedNodes().length<=10};clear=()=>{this.#D.assignedNodes().forEach((e=>this.removeChild(e))),this.#A.clear(),this.#L.scrollTop=0}}customElements.define("m2-list",t)},402:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var _services_Favorites__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(508),_templates_Bundle_html__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(644),_components_M2DataTable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(640),_components_M2RoundButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(128),_BundleColumnsDialog__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(663),_bundleSearch_BundleSearchPanel__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(867),_services_Context__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(198),_services_Preferences__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(287),_services_Snackbar__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(270);class Bundle extends HTMLElement{#P;#H;#O;#q;#$={};#V;#j;#F;#U;#N;#K;#z;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=_templates_Bundle_html__WEBPACK_IMPORTED_MODULE_8__.A,this.#U=[],this.#q=e.getElementById("title"),e.getElementById("help").onclick=this.#W,this.#V=e.getElementById("total");const t=e.getElementById("paginationFirst");t.onclick=this.#G;const o=e.getElementById("paginationPrevious");o.onclick=this.#G;const r=e.getElementById("paginationNext");r.onclick=this.#G;const i=e.getElementById("paginationLast");i.onclick=this.#G,this.#$={first:t,previous:o,prev:o,next:r,last:i},this.#P=e.getElementById("table"),this.#P.addEventListener("rowclick",this.#J),this.#P.onColumnReorder=this.#X,e.getElementById("copy").onclick=this.#Y,e.getElementById("download").onclick=this.#Z,this.#O=e.querySelector("bundle-columns-dialog"),this.#O.onValidate=this.#Q,this.#H=e.getElementById("settingsDialogToggle"),this.#H.onclick=this.#ee,this.#j=e.getElementById("searchToggle"),this.#j.onclick=this.#te,this.#F=e.getElementById("search"),this.#N=e.getElementById("favorite-toggle"),this.#N.onclick=this.#oe,_services_Favorites__WEBPACK_IMPORTED_MODULE_0__.A.addListener(this.#re)}connectedCallback(){new MutationObserver(this.#ie).observe(this.#F,{attributes:!0})}#ie=e=>{e.forEach((({type:e,attributeName:t,target:o})=>{"attributes"===e&&"class"===t&&(this.#j.hidden=!o.classList.contains("hidden"))}))};#te=()=>{this.#F.classList.toggle("hidden")};#J=({detail:e})=>{const t=this.#z.entry.find((({resource:t})=>t.id===e.resourceId));if(t){const e=t.fullUrl.replace(`${_services_Context__WEBPACK_IMPORTED_MODULE_5__.A.server.url}`,"");location.hash=`#${e}`}};#Q=e=>{const t=this.#U.filter((t=>e.includes(t)));t.push(...e.filter((e=>!t.includes(e)))),this.#X(t)};#X=e=>{this.#U=e,this.#P.clear(),this.#U.forEach((e=>this.#P.addColumn(e))),this.#se(this.#z);const t=_services_Preferences__WEBPACK_IMPORTED_MODULE_6__.A.get("columns",{});t[this.#K]=this.#U,_services_Preferences__WEBPACK_IMPORTED_MODULE_6__.A.set("columns",t)};#ee=()=>{this.#O.load(this.#K,this.#U),this.#O.hidden=!1};#G=({target:e})=>{if("m2-round-button"!==e.localName)return;let t=e.dataset.url;t=t.replace(`${_services_Context__WEBPACK_IMPORTED_MODULE_5__.A.server.url}`,""),location.hash=`#${t}`};#W=()=>{window.open(_services_Context__WEBPACK_IMPORTED_MODULE_5__.A.server.resourceHelpUrl(this.#K),"FhirBrowserHelp")};#Y=()=>{navigator.clipboard.writeText(JSON.stringify(this.#z)).then((function(){_services_Snackbar__WEBPACK_IMPORTED_MODULE_7__.A.info("Copying to clipboard was successful")}),(function(e){console.error("Async: Could not copy text: ",e)}))};#Z=()=>{const e=this.#K,t=new File([JSON.stringify(this.#z)],e,{type:"data:text/json;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${e}.json`,r.click(),r.remove(),window.URL.revokeObjectURL(o)};get resourceType(){return this.#K}#ae(e){const t={year:"numeric",month:"2-digit",day:"2-digit"},o={hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"};try{const r=new Date(e);return`${r.toLocaleString(void 0,t)}<br>${r.toLocaleString(void 0,o)}`}catch(t){return e}}#ne=e=>{let t=_services_Context__WEBPACK_IMPORTED_MODULE_5__.A.server.schema.getDefinitionByResourceType(this.#K),o="string";return e.split(".").forEach((e=>{const r=t.properties[e],i=r.$ref||r.items?.$ref;i?(t=_services_Context__WEBPACK_IMPORTED_MODULE_5__.A.server.schema.getDefinitionByRef(i),o=i.replace(/^#\/definitions\//,"")):o=r.type?r.type:"string"})),o};#se(data){if(this.#V.hidden=!0,data.total&&(this.#V.hidden=!1,this.#V.innerHTML=`Total:&nbsp;${data.total}`),data.entry){const columnTypes=this.#U.reduce(((e,t)=>(e[t]=this.#ne(t),e)),{});data.entry.forEach((entry=>{const row={};this.#U.forEach((column=>{let value=entry.resource;const path=column.split(".");if(path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx===path.length-1?value.join(", "):value[0]),!0)))),null==value)row[column]="";else{const e=columnTypes[column]||"string";["instant","dateTime"].includes(e)&&(value=this.#ae(value)),row[column]=value}})),this.#P.addRow(entry.resource.id,row)})),Object.entries(this.#$).forEach((([,e])=>{e.setAttribute("disabled",""),e.removeAttribute("data-relation"),e.removeAttribute("data-url")})),data.link?.forEach((({relation:e,url:t})=>{this.#$[e]?.removeAttribute("disabled"),this.#$[e]?.setAttribute("data-relation",e),this.#$[e]?.setAttribute("data-url",t)}))}}get source(){return this.#z}set source(e){let t,o=!1;if(e.entry?.length){const r=[...new Set(e.entry.map((e=>e.resource.resourceType)))];o=1===r.length,t=o?r[0]:"Bundle"}else{const e=window.location.hash.replace("#/","").trim();t=/^\w+/.exec(e)[0]}this.#K=t;let r=t;if(o){const e=_services_Preferences__WEBPACK_IMPORTED_MODULE_6__.A.get("columns",{});this.#U=e[t]||["id","meta.lastUpdated"],this.#H.hidden=!1,this.#F.hidden=!1}else this.#H.hidden=!0,this.#F.hidden=!0,this.#U=["resourceType","id"],"Bundle"===t&&(r=`${e.type} ${r.toLowerCase()}`);this.#q.innerText=r,this.#P.clear(),this.#U.forEach((e=>this.#P.addColumn(e))),this.#z=e,this.#se(e),this.#re()}#oe=()=>{_services_Favorites__WEBPACK_IMPORTED_MODULE_0__.A.toggle(this.#K)};#re=()=>{this.#N.style.color=_services_Favorites__WEBPACK_IMPORTED_MODULE_0__.A.favorites.includes(this.#K)?"var(--primary-color)":"unset"}}customElements.define("fhir-bundle",Bundle)},508:(e,t,o)=>{o.d(t,{A:()=>i});var r=o(287);const i=new class{#le=[];#ce=()=>{this.#le.forEach((e=>{e.call()}))};addListener=e=>{this.#le.push(e)};get favorites(){return r.A.get("favorites",[])}toggle=e=>{let t=this.favorites;t.includes(e)?t=this.favorites.filter((t=>t!==e)):t.push(e),r.A.set("favorites",t),this.#ce()}}},529:(e,t,o)=>{o(128),o(566);class r extends HTMLElement{#q;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{background-color:var(--background-color,#fff);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:var(--font-family);height:100%;width:400px}header{padding-bottom:3px;border-bottom:1px solid var(--border-color)}header h3{margin:0}#content{overflow:auto;flex:1 1 auto;height:0}@media (max-width:480px){main{top:0;left:0;height:100%;width:100%}}</style> <main> <header slot="header"> <m2-app-bar> <section slot="left"> <slot name="appBarLeft"></slot> </section> <h3 id="title" slot="middle">Side panel</h3> <section slot="right"> <slot name="appBarRight"></slot> </section> </m2-app-bar> </header> <section id="content"> <slot name="main"></slot> </section> </main>',this.#q=e.getElementById("title")}static get observedAttributes(){return["data-title"]}attributeChangedCallback(e,t,o){"data-title"===e&&(this.#q.innerText=o)}}window.customElements.define("m2-side-panel",r)},566:()=>{class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML='<style>main{align-items:center;display:flex;flex-direction:row;padding:.5em;flex-wrap:wrap;justify-content:flex-end}#barMiddle{flex-grow:1;margin:0;overflow:hidden;padding-left:.5em;font-size:1.17em;font-weight:700}#barRight{white-space:nowrap}</style> <main> <section id="barLeft"> <slot name="left"></slot> </section> <section id="barMiddle"> <slot name="middle"></slot> </section> <section id="barRight"> <slot name="right"></slot> </section> </main>'}}window.customElements.define("m2-app-bar",e)},640:()=>{class e extends HTMLElement{#de;#he;constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}div{height:100%;overflow:auto}table{border-collapse:collapse;min-width:100%;white-space:nowrap}thead{background-color:var(--background-color);box-shadow:0 2px 4px var(--border-color);position:sticky;top:0}td,th{height:56px;padding:1px 16px;text-align:left}th{text-transform:capitalize;cursor:grab}tbody tr{border-bottom:1px solid var(--border-color,gray);cursor:pointer}tbody tr td::first-line{font-size:medium}tbody tr td{font-size:smaller}tbody tr.selected,tbody tr:hover{background-color:var(--hover-color,rgb(0 0 0 / 4%))}tr.drag th.over{background-color:var(--hover-color,rgb(0 0 0 / 4%))}</style> <div> <table> <thead> <tr id="header"></tr> </thead> <tbody id="body"></tbody> </table> </div>',this.#de=e.getElementById("header"),this.#de.ondragstart=this.#ue,this.#de.ondragover=this.#pe,this.#de.ondragenter=this.#me,this.#de.ondragleave=this.#ge,this.#de.ondragend=this.#be,this.#de.ondrop=this.#fe,this.#he=e.getElementById("body"),this.#he.onclick=this.#ye}#ve=()=>{};get onColumnReorder(){return this.#ve}set onColumnReorder(e){this.#ve=e}addColumn=e=>{const t=document.createElement("th");t.dataset.id=e,t.setAttribute("draggable","true"),t.appendChild(document.createTextNode(e)),this.#de.appendChild(t)};addRow=(e,t)=>{const o=document.createElement("tr");o.id=e,Object.entries(t).forEach((([,e])=>{o.insertAdjacentHTML("beforeend",`<td>${e}</td>`)})),this.#he.appendChild(o)};#ye=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("tr");t&&(this.#he.querySelector("tr[class~=selected]")?.classList.remove("selected"),t.classList.add("selected"),this.dispatchEvent(new CustomEvent("rowclick",{bubbles:!1,cancelable:!1,detail:{resourceId:t.id}})))};clear=()=>{for(;this.#de.firstChild;)this.#de.removeChild(this.#de.lastChild);for(;this.#he.firstChild;)this.#he.removeChild(this.#he.lastChild)};#ue=e=>{const t=e.target.closest("th");t.style.opacity="0.4",this.#de.classList.add("drag"),this.dragSrcEl=t};#me=e=>{e.target.closest("th")?.classList.add("over")};#ge=e=>{e.target.closest("th")?.classList.remove("over")};#pe=e=>{e.preventDefault();const t=e.target.closest("th");return this.dragSrcEl===t?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move",!1};#fe=e=>{e.stopPropagation();let t=e.target.closest("th");if(this.dragSrcEl!==t){const e=Array.from(this.#de.childNodes);e.findIndex((e=>e===this.dragSrcEl))<e.findIndex((e=>e===t))&&(t=t.nextSibling),this.#de.insertBefore(this.dragSrcEl,t),this.dragSrcEl=null,this.#ve(Array.from(this.#de.childNodes).map((e=>e.dataset.id)))}return!1};#be=e=>{e.target.closest("th").style.opacity="1",this.#de.classList.remove("drag"),this.#de.childNodes.forEach((e=>e.classList.remove("over")))}}customElements.define("m2-data-table",e)},644:(e,t,o)=>{o.d(t,{A:()=>r});const r='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}#bundleCnt{display:flex;flex-direction:column;height:100%;flex:auto;width:0}main{flex:1 1 auto;height:0;border-top:1px solid var(--border-color)}#title{margin:0;overflow:hidden;text-overflow:ellipsis}#title::first-letter{text-transform:uppercase}#table{flex:auto}bundle-search-panel{border-left:1px solid var(--border-color);flex:none;transition:all .3s;width:400px}bundle-search-panel.hidden{transition:all .3s;margin-right:-400px}footer{border-top:1px solid var(--border-color);padding:.5em;display:flex;flex-flow:row nowrap}footer>section{display:flex;flex-direction:row;align-items:center}footer>section:nth-child(2){flex-grow:1}footer span:not(:last-child){border-right:1px solid var(--border-color);padding-right:.5em;margin-right:.25em}@media (max-width:480px){bundle-search-panel{background-color:var(--background-color,rgb(255 255 255));position:relative;width:100%}bundle-search-panel.hidden{margin-right:-100%}}</style> <div id="wrapper"> <div id="bundleCnt"> <header> <m2-app-bar> <m2-round-button id="help" title="Help" data-icon="help" slot="left"></m2-round-button> <m2-round-button slot="left" id="favorite-toggle" title="Favorite" data-icon="star"></m2-round-button> <h3 slot="middle" id="title">Bundle</h3> <div class="toolbar" slot="right"> <m2-round-button id="settingsDialogToggle" title="Settings" data-icon="view_column"></m2-round-button> <m2-round-button id="searchToggle" title="Search" data-icon="search"></m2-round-button> </div> </m2-app-bar> </header> <main> <m2-data-table id="table"></m2-data-table> </main> <footer> <section></section> <section></section> <section> <span id="total"></span> <span> <m2-round-button id="paginationFirst" title="first" data-icon="first_page" disabled="disabled"></m2-round-button> <m2-round-button id="paginationPrevious" title="previous" data-icon="chevron_left" disabled="disabled"></m2-round-button> <m2-round-button id="paginationNext" title="next" data-icon="chevron_right" disabled="disabled"></m2-round-button> <m2-round-button id="paginationLast" title="last" data-icon="last_page" disabled="disabled"/> </span> <span> <m2-round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></m2-round-button> <m2-round-button id="download" title="Download" data-icon="download"></m2-round-button> </span> </section> </footer> </div> <bundle-search-panel id="search" class="hidden"></bundle-search-panel> </div> <bundle-columns-dialog hidden></bundle-columns-dialog>'},663:(e,t,o)=>{o(344);var r=o(47);class i extends HTMLElement{#we;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{padding:.5em 1em;background-color:inherit;display:flex;flex-direction:row;align-items:center}main:hover,main[selected]{background-color:var(--hover-color,rgb(0 0 0 / 5%))}div{flex-grow:1}input[type=checkbox]{margin-left:1em}</style> <main> <div> <slot></slot> </div> <input type="checkbox"> </main>',e.querySelector("main").onclick=this.#xe,this.#we=e.querySelector("input[type=checkbox]")}static get observedAttributes(){return["selected"]}attributeChangedCallback(e,t,o){"selected"===e&&(this.#we.checked=null!==o)}#xe=e=>{null!==this.getAttribute("selected")?this.removeAttribute("selected"):this.setAttribute("selected","")}}customElements.define("m2-list-row-check",i),o(819);var s=o(198);class a extends HTMLElement{#_e;#L;#K;#ke;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}footer{border-top:1px solid var(--border-color);padding:.5em 1em;text-align:right;overflow:hidden}</style> <m2-dialog id="settingsDialog" data-title="Settings"> <main> <m2-linear-progress></m2-linear-progress> <m2-list></m2-list> <footer> <m2-button id="btnCancel">Cancel</m2-button> <m2-button id="btnOk">Apply</m2-button> </footer> </main> </m2-dialog>',this.#_e=e.querySelector("m2-linear-progress"),this.#L=e.querySelector("m2-list"),this.#L.onFilter=this.#Ce,e.querySelector("m2-dialog").onClose=this.#Se,e.getElementById("btnCancel").onclick=this.#Ee,e.getElementById("btnOk").onclick=this.#Te}#Te=e=>{e.preventDefault(),e.stopPropagation(),this.hidden=!0;const t=Array.from(this.#L.querySelectorAll("m2-list-row-check[selected]")).map((e=>e.dataset.id));this.#Me(t)};#Ee=()=>{this.hidden=!0};#Ce=({value:e,caseSensitive:t})=>{const o=new RegExp(e,t?"":"i");this.#L.childNodes.forEach((e=>{e.hidden=!o.exec(e.dataset.id)}))};#Se=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};#Me=()=>{};get onValidate(){return this.#Me}set onValidate(e){this.#Me=e}load=(e,t)=>{e!==this.#K||s.A.server.release!==this.#ke?(this.#K=e,this.#ke=s.A.server.release,this.#_e.hidden=!1,this.#L.clear(),this.#Ae(e,"").then((e=>{this.#L.append(...e.sort(((e,t)=>e.path.localeCompare(t.path))).map(this.#Le)),this.#De(t),this.#_e.hidden=!0}))):this.#De(t)};#De=e=>{Array.from(this.#L.querySelectorAll("m2-list-row-check")).forEach((t=>{e.includes(t.dataset.id)?t.setAttribute("selected",""):t.removeAttribute("selected")}))};#Le=e=>{const t=new i;return t.setAttribute("data-id",e.id),t.append(new r.A(void 0,e.path,e.short)),t};#Ae=(e,t)=>new Promise((o=>{const r=[];s.A.server.structureDefinition(e).then((e=>{const i=[];e.snapshot.element.filter((e=>e.isSummary&&e.type)).forEach((e=>{const o=e.path.substr(e.path.indexOf(".")+1);if(!t.includes(`${o}.`)){const s=(t?`${t}.`:"")+o,a=e.type[0].code;a.match(/^([A-Z][a-z]+)+$/)?i.push(this.#Ae(a,s)):r.push({id:s,path:s,short:e.short,type:a})}})),i.length>0?Promise.all(i).then((e=>{e.forEach((e=>r.push(...e))),o(r)})):o(r)}))}))}customElements.define("bundle-columns-dialog",a)},805:(e,t,o)=>{o.d(t,{A:()=>a});var r=o(77);const i=new class{#Re="https://hl7.org/fhir";#Be;#Ie={"5.0.0":"R5","4.6.0":"R5","4.5.0":"R5","4.4.0":"R5","4.3.0":"R4B","4.2.0":"R5","4.1.0":"R4B","4.0.1":"R4","3.5.0":"R4","3.3.0":"R4","3.2.0":"R4","3.0.2":"STU3","3.0.1":"STU3","3.0.0":"STU3"};resourceHelpUrl=(e,t)=>`${this.#Re}/${t}/${e.toLowerCase()}.html`;validateHelpUrl=e=>`${this.#Re}/${e}//operation-resource-validate.html`;historyHelpUrl=e=>`${this.#Re}/${e}//http.html#history`;structureDefinition=async(e,t)=>(await fetch(`./assets/fhir/${t}/${e.toLowerCase()}.profile.json`,{cache:"force-cache"})).json();fetchSchema=async e=>(await fetch(`./assets/fhir/${e}/fhir.schema.json`,{cache:"force-cache"})).json();fetchAllReferences=async()=>{if(!this.#Be){const e=await fetch("./assets/fhir/references.json");this.#Be=await e.json()}return this.#Be};release=e=>this.#Ie[e]||null};class s{#Pe;constructor(e){this.#Pe=e}getRefByResourceType=e=>this.#Pe.discriminator?this.#Pe.discriminator.mapping[e]:this.#Pe.definitions[e];getDefinitionByResourceType=e=>this.getDefinitionByRef(this.getRefByResourceType(e));getDefinitionByRef=e=>this.#He(e);getDefinitionByName=e=>this.#Pe.definitions[e];#He=e=>e.replace(/^#\//,"").split("/").reduce(((e,t)=>e[t]),this.#Pe)}class a{#Oe=null;#qe=null;#$e=null;#s={};#Ve;#Pe;#je;constructor(e="",t=null){null!=t&&(this.#Ve=e,this.#Oe=t,Object.assign(this.#s,t.headers))}get serverCode(){return this.#Ve}get url(){return this.#Oe.url}get headers(){return this.#s}get capabilities(){return this.#qe}get release(){return i.release(this.#qe.fhirVersion)||null}get schema(){return this.#Pe}connect=async()=>{switch(this.#Oe.method){case r.A.METHODS.APIKey:this.#s[this.#Oe.apiKey]=this.#Oe.apiValue;break;case r.A.METHODS.Basic:const e=window.btoa(`${this.#Oe.basicUsername}:${this.#Oe.basicPassword}`);this.#s.Authorization=`Basic ${e}`;break;case r.A.METHODS.OAuth2:this.#Fe().then((e=>{this.#s.Authorization=`${e.token_type} ${e.access_token}`,this.#je=(new Date).getTime()+1e3*e.expires_in}));case r.A.METHODS.None:}this.#qe=await this.#Ue(),this.#$e=await this.#Ne(this.#qe),this.#Pe=new s(await i.fetchSchema(this.release))};fetchHash=async e=>{const t=new URL(`${this.url}${e}`);this.#Oe.method===r.A.METHODS.OAuth2&&(!this.#je||this.#je-(new Date).getTime()<1)&&this.#Fe().then((e=>{this.#s.Authorization=`${e.token_type} ${e.access_token}`,this.#je=(new Date).getTime()+1e3*e.expires_in;const o=i(this.#s);return this.fetch(t,{headers:o})}));const o=i(this.#s);return fetch(t,{headers:o});function i(e){const o={};switch(Object.assign(o,e),t.searchParams.get("_format")){case"xml":o.Accept="application/fhir+xml";break;case"ttl":o.Accept="application/x-turtle";break;default:o.Accept="application/fhir+json"}return o}};fetch=async(e,t={})=>{const o=new URL(`${this.#Oe.url}${e}`);return Object.assign(o.searchParams,t),(await fetch(o,{headers:this.#s})).json()};#Fe=async()=>{const e={"Content-type":"application/x-www-form-urlencoded",Accept:"application/json"},t={grant_type:this.#Oe.oauthGrantType};if(this.#Oe.oauthCredentials===r.A.CREDENTIALS.Header){const t=window.btoa(`${this.#Oe.oauthClientId}:${this.#Oe.oauthClientSecret}`);e.Authorization=`Basic ${t}`}else t.client_id=this.#Oe.oauthClientId,t.client_secret=this.#Oe.oauthClientSecret;return this.#Oe.oauthScope&&(t.scope=this.#Oe.oauthScope),(await fetch(this.#Oe.oauthTokenUrl,{headers:e,method:"POST",body:new URLSearchParams(t).toString()})).json()};#Ue=async()=>{const e=new URL(`${this.#Oe.url}/metadata`);e.searchParams.set("_format","json");try{const t=await fetch(e,{cache:"reload",headers:this.#s});return t.ok?t.json():Promise.reject(t)}catch(e){return Promise.reject(e)}};references=e=>this.#$e[e];#Ne=async e=>{const t={},o=e.rest[0].resource,r=await i.fetchAllReferences();return e.rest[0].resource.forEach((e=>{const i=r[this.release][e.type];if(i){const r=structuredClone(i);Object.entries(r).forEach((([e,t])=>{const i=o.find((t=>e===t.type));i&&i.searchParam?(r[e].forEach(((t,o)=>{const s=i.searchParam.find((e=>t===e.name));s?r[e][o]={name:t,documentation:s.documentation}:r[e].splice(o,1)})),0===r[e].length&&delete r[e]):delete r[e]})),0!==Object.keys(r).length&&(t[e.type]=r)}})),t};isFormatEnable(e){const t=[];switch(e){case"json":t.push("json"),t.push("application/fhir+json"),t.push("html/json");break;case"xml":t.push("xml"),t.push("application/fhir+xml"),t.push("html/xml");break;case"ttl":t.push("ttl"),t.push("application/x-turtle"),t.push("html/turtle")}return this.#qe.format.some((e=>t.includes(e)))}validateHelpUrl=()=>i.validateHelpUrl(this.release);historyHelpUrl=()=>i.historyHelpUrl(this.release);resourceHelpUrl=e=>i.resourceHelpUrl(e,this.release);structureDefinition=async e=>i.structureDefinition(e,this.release)}},819:()=>{class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML='<style>main{background-color:var(--border-color);overflow:hidden}.thumb{height:.2em;width:50%;background-color:var(--primary-color);left:-50%;position:relative;animation:loading 2s ease-in .5s infinite}@keyframes loading{0%{transform:translateX(0)}to{transform:translateX(400%)}}</style> <main> <div class="thumb"/> </main>'}}customElements.define("m2-linear-progress",e)},867:(e,t,o)=>{o(128),o(529);class r extends HTMLElement{#Ke;#ze;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray;display:flex;flex-direction:row;flex-wrap:wrap}main:focus-within,main:focus-within input{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:4px 5px;max-width:120px;min-width:100px}input:focus{outline:0}</style> <main> <input type="date"> <input type="time"> </main>',this.#Ke=e.querySelector('input[type="date"]'),this.#ze=e.querySelector('input[type="time"]')}get value(){if(this.#Ke.value){const e=new Date(`${this.#Ke.value}T${this.#ze.value||"00:00"}`);return new Date(e.getTime()).toISOString()}return null}set value(e){this.#Ke.value="",this.#ze.value=""}}customElements.define("bundle-search-date",r);class i extends HTMLElement{#We;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px;width:90px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input placeholder="Modifier" list="FhirSearchFieldModifierList"> <datalist id="FhirSearchFieldModifierList"> <option value="contains"></option> <option value="exact"></option> <option value="missing"></option> </datalist> </main>',this.#We=e.querySelector("input")}get value(){return this.#We.value}set value(e){this.#We.value=e}}customElements.define("bundle-search-modifier",i);class s extends HTMLElement{#We;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px;width:90px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input placeholder="Prefix" list="FhirSearchPrefixList"> <datalist id="FhirSearchPrefixList"> <option value="eq">Is equal to</option> <option value="ne">is not equal to</option> <option value="gt">is greater than</option> <option value="lt">is less than</option> <option value="ge">is greater or equal to</option> <option value="le">is less or equal to</option> </datalist> </main>',this.#We=e.querySelector("input")}get value(){return this.#We.value}set value(e){this.#We.value=e}}customElements.define("bundle-search-prefix",s);class a extends HTMLElement{#We;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray;display:flex}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input type="text" spellcheck="false"> </main>',this.#We=e.querySelector("input")}static get observedAttributes(){return["placeholder"]}attributeChangedCallback(e,t,o){"placeholder"===e&&this.#We.setAttribute("placeholder",o)}get value(){return this.#We.value}set value(e){this.#We.value=e}}customElements.define("bundle-search-text",a);class n extends HTMLElement{#Ge;#Je;constructor(){super(),this.#Ge=this.attachShadow({mode:"closed"}),this.#Ge.innerHTML="<style>main{margin-bottom:1em}fieldset{display:flex;flex-direction:row;border:none;padding:0;gap:1em}fieldset:focus-within legend{font-weight:700;color:var(--primary-color)}bundle-search-date,bundle-search-text{flex:auto}span{color:var(--text-color-disabled);font-size:small;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;padding-top:2px}</style> <main> <fieldset> <legend inert></legend> <slot></slot> </fieldset> <span inert></span> </main>"}clear(){this.#Ge.querySelectorAll("bundle-search-text, bundle-search-date, bundle-search-modifier, bundle-search-prefix").forEach((e=>{e.value=""}))}set value(e){let t;const o=e.value.split("|"),r=e.name.split(":");switch(this.#Je.type){case"token":t=this.#Ge.querySelector("bundle-search-text:not([data-type])"),o[1]?(this.#Ge.querySelector('bundle-search-text[data-type="system"]').value=o[0],t.value=o[1]):t.value=o[0];break;case"string":case"reference":r[1]&&(this.#Ge.querySelector("bundle-search-modifier").value=r[1]),t=this.#Ge.querySelector("bundle-search-text"),t.value=e.value}}get value(){let e;switch(this.#Je.type){case"token":let t="";const o=this.#Ge.querySelector('bundle-search-text[data-type="system"]');return o?.value&&(t=`${o.value}|`),e=this.#Ge.querySelector("bundle-search-text:not([data-type])"),e?.value&&(t+=e.value),t?{name:this.#Je.name,value:t}:null;case"string":case"reference":if(e=this.#Ge.querySelector("bundle-search-text"),e?.value){let t=this.#Je.name;const o=this.#Ge.querySelector("bundle-search-modifier");return o?.value&&(t+=`:${o.value}`),{name:t,value:e.value}}break;case"date":case"datetime":if(e=this.#Ge.querySelector("bundle-search-date"),e?.value){let t=e.value;const o=this.#Ge.querySelector("bundle-search-prefix");return o?.value&&(t=o.value+t),{name:this.#Je.name,value:t}}}return null}get name(){return this.#Je.name}init(e){function t(e,t){const r=new a;r.setAttribute("name",e.name),t&&r.setAttribute("placeholder",t),o.appendChild(r)}if("_format"===e.name)return!1;this.#Je=e,this.#Ge.querySelector("legend").innerText=e.name,this.#Ge.querySelector("span").innerText=e.documentation||"";const o=this.#Ge.querySelector("fieldset");let n;if("_id"===e.name)t(e);else if("_filter"===e.name)t(e);else switch(e.type){case"token":!function(e){const t=new a;t.setAttribute("placeholder","System"),t.setAttribute("data-type","system"),t.setAttribute("name",e.name),o.appendChild(t)}(e),t(e,"code");break;case"string":case"reference":!function(e){const t=new i;t.setAttribute("data-name",e.name),o.appendChild(t)}(e),t(e);break;case"date":case"datetime":n=new s,n.setAttribute("data-name",e.name),o.appendChild(n),n=new r,n.setAttribute("name",e.name),o.appendChild(n);break;default:return!1}return!0}}customElements.define("bundle-search-item",n);var l=o(198);class c extends HTMLElement{#b;#K;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}section{display:flex;flex-direction:column;height:100%}main{padding:.5em;overflow:hidden auto;flex:1 1 auto;height:0}footer{border-top:1px solid var(--border-color);padding:.5em;text-align:center;overflow:hidden}@media (max-width:480px){.surface{left:0;right:unset;width:100%;max-width:unset;max-height:unset}.overlay{background-color:transparent}}</style> <m2-side-panel data-title="Search"> <m2-round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></m2-round-button> <m2-round-button id="clear" title="Clear" data-icon="clear_all" slot="appBarRight"></m2-round-button> <m2-round-button id="close" title="Close" data-icon="close" slot="appBarRight"></m2-round-button> <section slot="main"> <main></main> <footer> <m2-button id="apply">search</m2-button> </footer> </section> </m2-side-panel>',e.getElementById("close").onclick=this.sidePanelClose,e.getElementById("clear").onclick=this.clearClick,e.getElementById("help").onclick=this.helpClick,e.getElementById("apply").onclick=this.applyClick,this.#b=e.querySelector("main"),this.#b.addEventListener("keydown",this.mainKeyDown)}connectedCallback(){window.addEventListener("hashchange",this.locationHandler),this.locationHandler()}mainKeyDown=e=>{["Enter","NumpadEnter"].includes(e.code)&&this.applyClick(e)};applyClick=e=>{e.preventDefault(),e.stopPropagation(),window.matchMedia("(max-width: 480px)").matches&&this.classList.add("hidden");const t=[];this.#b.querySelectorAll("bundle-search-item").forEach((({value:e})=>{e&&t.push(`${e.name}=${encodeURIComponent(e.value)}`)})),location.hash=`#/${this.#K.type}?${t.length?t.join("&")+"&":""}_summary=true&_format=json&_sort=-_lastUpdated`};helpClick=e=>{window.open(l.A.server.resourceHelpUrl("search"),"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};clearClick=e=>{this.clear(),e.preventDefault(),e.stopPropagation()};sidePanelClose=e=>{this.classList.add("hidden"),e.preventDefault(),e.stopPropagation()};locationHandler=async()=>{const e=window.location.hash.replace("#/","").trim();if(!e||e.indexOf("/")>0)return;const t=e.split("?")[0];if(!t)return;for(;!l.A.server;)await r(1e3);const o=l.A.server.capabilities.rest[0].resource.find((e=>e.type===t));if(o){o.type!==this.#K?.type&&(this.#K=o,this.metadata=o),this.clear();const t=new URLSearchParams(e.replace(/^[^?]+\?/,""));Array.from(t).forEach((([e,t])=>{const o=e.split(":")[0],r=this.#b.querySelector(`bundle-search-item[data-name="${o}"`);r&&(r.value={name:e,value:t})}))}function r(e){return new Promise((t=>{setTimeout(t,e)}))}};clear(){this.#b.querySelectorAll("bundle-search-item").forEach((e=>e.clear()))}set metadata(e){for(this.#b.scrollTop=0;this.#b.firstChild;)this.#b.removeChild(this.#b.lastChild);e?.searchParam.sort(((e,t)=>e.name.localeCompare(t.name))).forEach((e=>{const t=new n;t.init(e)&&(t.setAttribute("data-name",e.name),this.#b.appendChild(t))}))}}customElements.define("bundle-search-panel",c)},967:()=>{class e extends HTMLElement{#b;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}:host{position:absolute;inset:unset;bottom:1em;left:1em;border-radius:4px;box-shadow:0 11px 15px -7px rgb(0 0 0 / 20%),0 24px 38px 3px rgb(0 0 0 / 14%),0 9px 46px 8px rgb(0 0 0 / 12%);padding:0;border:0 none;background:#fff}main{align-items:center;background-color:rgb(0 0 0 / 85%);color:#fff;display:flex;flex-direction:row;font-family:var(--font-family);padding:0 1em;min-height:48px;min-width:344px}main.error{background-color:var(--background-error)}#message{flex-grow:1;overflow:hidden;padding:0 1em;text-overflow:ellipsis;white-space:nowrap}@media (max-width:480px){main{min-width:unset;width:calc(100% - 2em)}}</style> <main> <div id="message"> <slot></slot> </div> </main>',this.#b=e.querySelector("main")}set type(e="info"){this.#b.classList.remove("info","error"),this.#b.classList.add(e)}}customElements.define("m2-snackbar",e)}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__webpack_require__),o.exports}__webpack_require__.d=(e,t)=>{for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={},code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}:host{background-color:var(--background-color,rgb(255 255 255));color:var(--text-color-normal,rgb(0 0 0 / 87%));display:flex;flex-direction:column;font-family:var(--font-family);font-size:1rem;font-weight:400;height:100vh;line-height:1.5}header{background-color:var(--primary-color,#000);color:#fff}h3{margin:0}main{flex:1 1 auto;height:0;overflow:hidden}main>div{display:flex;flex-direction:row;height:100%}server-panel{border-right:1px solid var(--border-color,gray);flex:none;transition:all .3s;margin-left:0;width:300px}server-panel.hidden{transition:all .3s;margin-left:-300px}#bdy{flex:1 1 auto;overflow:hidden;width:0;position:relative;block-size:100%;display:grid;grid-auto-flow:column;grid-auto-columns:100%;grid-auto-rows:100%}@media (max-width:480px){server-panel{background-color:var(--background-color,rgb(255 255 255));position:static;width:100%}server-panel.hidden{margin-left:-100%}}</style> <header> <m2-app-bar id="header" caption=""> <m2-round-button slot="left" id="navigation" title="Menu" data-icon="menu" hidden></m2-round-button> <span id="appTitle" slot="middle">FHIR Browser</span> <m2-color-scheme slot="right"></m2-color-scheme> <m2-round-button slot="right" id="serverDialogToggle" title="Connections" data-icon="database"></m2-round-button> <m2-round-button slot="right" id="aboutDialogToggle" title="About" data-icon="info"></m2-round-button> </m2-app-bar> </header> <main> <div> <server-panel class="hidden"></server-panel> <div id="bdy" style="visibility:hidden"> <fhir-bundle id="bundle"></fhir-bundle> <fhir-resource id="resource"></fhir-resource> <fhir-operation-outcome></fhir-operation-outcome> </div> </div> </main> <m2-snackbar popover="auto"></m2-snackbar> <server-dialog hidden></server-dialog> <m2-waiting></m2-waiting>';const templates_App=code;var M2ColorScheme_code='<m2-round-button title="" data-icon=""></m2-round-button>';const templates_M2ColorScheme=M2ColorScheme_code;var Preferences=__webpack_require__(287);class M2ColorScheme extends HTMLElement{#Xe;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2ColorScheme,this.#Xe=e.querySelector("m2-round-button"),this.#Xe.onclick=this.#xe}connectedCallback(){this.#Ye(Preferences.A.get("colorScheme","auto"))}#xe=e=>{const t=["light","dark","auto"];let o=Preferences.A.get("colorScheme","auto");const r=t.findIndex((e=>e===o))+1;o=t[r%3],Preferences.A.set("colorScheme",o),this.#Ye(o)};#Ye=e=>{let t="",o=e;switch(e){case"dark":t="brightness_4";break;case"light":t="light_mode";break;default:"auto"===e&&(o=window?.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),t="brightness_auto"}this.#Xe.icon=t,this.#Xe.title=`Theme ${e}`,document.body.setAttribute("color-scheme",o)};get value(){return Preferences.A.get("colorScheme","auto")}}customElements.define("m2-color-scheme",M2ColorScheme);var M2LinearProgress=__webpack_require__(819),M2Button_code='<style>button{background:0 0;border:1px solid transparent;border-radius:4px;font:inherit;padding:5px 16px;text-transform:uppercase}button:not([disabled]){color:var(--primary-color);cursor:pointer}button:not([disabled]):hover{background-color:var(--hover-color);cursor:pointer}button[disabled]{color:var(--text-color-disabled)}</style> <button type="button"> <slot></slot> </button>';const templates_M2Button=M2Button_code;class M2Button extends HTMLElement{#We;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2Button,this.#We=e.querySelector("button")}static get observedAttributes(){return["value","disabled"]}attributeChangedCallback(e,t,o){"value"===e?this.#We.innerText=o:"disabled"===e&&(null===o?this.#We.removeAttribute("disabled"):this.#We.setAttribute("disabled",""))}}window.customElements.define("m2-button",M2Button);var M2Snackbar=__webpack_require__(967),M2Waiting_code="<style>dialog{inset:unset;padding:0;border:none!important;background:0 0;font-size:5em;overflow:hidden;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);outline:0}dialog::backdrop{background-color:rgb(0 0 0 / 32%)}</style> <dialog> <m2-circular-progress></m2-circular-progress> </dialog>";const templates_M2Waiting=M2Waiting_code;var M2CircularProgress_code="<style>main{height:.7em;width:.7em;color:var(--primary-color);display:inline-block;border:.15em solid;border-radius:50%;border-top-color:transparent;animation:rotate 1s linear infinite}@keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style> <main/>";const templates_M2CircularProgress=M2CircularProgress_code;class M2CircularProgress extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML=templates_M2CircularProgress}}customElements.define("m2-circular-progress",M2CircularProgress);class M2Waiting extends HTMLElement{#Ze;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2Waiting,this.#Ze=e.querySelector("dialog")}show(){this.#Ze.showModal()}hide(){this.#Ze.close()}}customElements.define("m2-waiting",M2Waiting);var AboutDialog_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}main>section{padding:1em;flex:1 1 auto}main>section a{color:var(--primary-color)}main>footer{padding:1em;text-align:right;font-size:small}</style> <m2-dialog id="aboutDialog" data-title="About FHIR Browser"> <m2-round-button id="closeButton" slot="appBarLeft" title="close" data-icon="close"></m2-round-button> <main> <section> <p> FHIR Browser is and <a target="_blank" href="https://github.com/hprieurgarrouste/fhirBrowser.git">open source</a> utility developed by and intended for FHIR developers<br/>and all IT professionals who work with a FHIR server. <br/>Its purpose is to help users analyze FHIR servers and learn about their content. </p> <p> All content on the website is published under Creative Commons License <a target="_blank" href="https://github.com/hprieurgarrouste/fhirBrowser/blob/master/licence.md">CC-BY-NC-ND 4.0</a> </p> </section> <footer> <span>Version:&nbsp;<span id="version"></span></span> </footer> </main> </m2-dialog>';const templates_AboutDialog=AboutDialog_code,package_namespaceObject={rE:"0.9.23"};class AboutDialog extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_AboutDialog,e.getElementById("closeButton").onclick=this.#Se,e.querySelector("m2-dialog").onClose=e=>{e.preventDefault(),e.stopPropagation(),this.#Se()},e.getElementById("version").innerText=package_namespaceObject.rE}#Se=()=>{this.hidden=!0}}customElements.define("about-dialog",AboutDialog);var Bundle=__webpack_require__(402),OperationOutcome_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}main{display:flex;flex-direction:column;height:100%;flex:auto;width:0}#title{margin:0;overflow:hidden;text-overflow:ellipsis}m2-tabs{flex:1 1 auto}m2-tabs>section{border-top:1px solid var(--border-color);padding:1em;flex:1 1 auto;height:0;overflow:auto}#issue{display:flex;flex-direction:row;flex-wrap:wrap;gap:1em}#text{font-size:smaller;font-family:monospace}#text table{width:100%;border-collapse:collapse}#text table,#text td,#text th{border:1px solid var(--border-color)}</style> <div id="wrapper"> <main> <header> <m2-app-bar> <m2-round-button id="help" title="Help" data-icon="help" slot="left"></m2-round-button> <h3 slot="middle" id="title">OperationOutcome</h3> </m2-app-bar> </header> <m2-tabs> <section data-caption="Issue"> <section id="issue"></section> </section> <section data-caption="Text"> <section id="text"></section> </section> </m2-tabs> </main> </div>';const templates_OperationOutcome=OperationOutcome_code;var M2AppBar=__webpack_require__(566),M2RoundButton=__webpack_require__(128),Context=__webpack_require__(198),M2Card_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}.surface{background-color:var(--background-color,#fff);border-radius:4px;box-shadow:1px 1px 5px 1px var(--border-color)}.overlay{background-color:rgb(255 255 255 / 4%);color:var(--text-color-normal,#fff);font-family:var(--font-family);height:100%}main{padding:1em}header{background-color:inherit;display:flex;flex-direction:row;align-items:center}header>i:not(:empty){padding-right:.5em}header .text{flex:1 1 auto;overflow:hidden}#primary{display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:var(--text-color-normal,#000);text-transform:lowercase;font-weight:700}#primary:first-letter{text-transform:uppercase}#secondary{display:block;font-size:smaller;color:var(--text-color-disabled);overflow-wrap:break-word}</style> <div class="surface"> <div class="overlay"> <main> <header> <i class="material-symbols-sharp"></i> <span class="text"> <span id="primary"></span> <span id="secondary"></span> </span> <section> <slot name="media"></slot> </section> </header> <section> <slot></slot> </section> </main> </div> </div>';const templates_M2Card=M2Card_code;class M2Card extends HTMLElement{#Qe;#et;#tt;constructor(e,t,o){super();const r=this.attachShadow({mode:"closed"});r.innerHTML=templates_M2Card,this.#Qe=r.querySelector("header>i"),this.#et=r.getElementById("primary"),this.#tt=r.getElementById("secondary"),e&&(this.icon=e),t&&(this.primary=t),o&&(this.secondary=o)}static get observedAttributes(){return["data-primary","data-secondary","data-icon"]}attributeChangedCallback(e,t,o){switch(e){case"data-icon":this.#Qe.innerText=o;break;case"data-primary":this.#et.innerText=o;break;case"data-secondary":this.#tt.innerText=o}}get icon(){return this.getAttribute("data-icon")}set icon(e){this.setAttribute("data-icon",e)}get primary(){return this.getAttribute("data-primary")}set primary(e){this.setAttribute("data-primary",e)}get secondary(){return this.getAttribute("data-secondary")}set secondary(e){this.setAttribute("data-secondary",e)}}customElements.define("m2-card",M2Card);class OperationOutcome extends HTMLElement{#b;#ot;#k;#rt;#it=Object.freeze({information:"info",warning:"warning",error:"error",fatal:"dangerous"});constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_OperationOutcome,this.#rt=null,e.getElementById("help").onclick=this.#W,this.#b=e.querySelector("main"),this.#ot=e.getElementById("issue"),this.#k=e.getElementById("text")}#W=()=>{window.open(Context.A.server.resourceHelpUrl(this.#rt.resourceType),"FhirBrowserHelp")};#st=()=>{this.#ot.innerHTML="",this.#k.innerHTML="",this.#b.style.cursor="wait",this.#rt=null};get resourceType(){return this.#rt.resourceType}get resourceId(){return null}get source(){return this.#rt}set source(e){this.#st(),e.issue.forEach((e=>{const t=document.createElement("p");t.innerText=e.diagnostics;const o=new M2Card(this.#it[e.severity]||"error",e.code,e.severity);o.append(t),this.#ot.append(o)})),this.#k.innerHTML=e.text?.div||"",this.#b.style.cursor="default",this.#rt=e}}customElements.define("fhir-operation-outcome",OperationOutcome);var Resource_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}#resourceCnt{display:flex;flex-direction:column;height:100%;flex:auto;width:0}main{flex:1 1 auto;height:0}#title{margin:0;overflow:hidden;text-overflow:ellipsis}#formView,#jsonView,#ttlView,#xmlView{flex:1 1 auto;height:0}#header.error{background-color:var(--background-error,transparent);color:#fff}#error{padding:1em}resource-history,resource-references,resource-validate{border-left:1px solid var(--border-color)}@media (max-width:480px){resource-history,resource-references,resource-validate{background-color:var(--background-color,rgb(255 255 255));position:relative;width:100%}}</style> <div id="wrapper"> <section id="resourceCnt"> <header> <m2-app-bar id="header"> <m2-round-button slot="left" id="help" title="Help" data-icon="help"></m2-round-button> <h3 slot="middle" id="title"></h3> <m2-round-button slot="right" id="validateToggle" title="Validate" data-icon="rule"></m2-round-button> <m2-round-button slot="right" id="referencesToggle" title="References" data-icon="article_shortcut"></m2-round-button> <m2-round-button slot="right" id="historyToggle" title="History" data-icon="history"></m2-round-button> </m2-app-bar> </header> <main> <m2-tabs></m2-tabs> </main> </section> <resource-references slot="main" hidden></resource-references> <resource-history slot="main" hidden></resource-history> <resource-validate slot="main" hidden></resource-validate> </div>';const templates_Resource=Resource_code;var M2Tabs_code="<style>main{display:flex;flex-direction:column;height:100%}header{display:flex;flex-direction:row;flex-wrap:nowrap}header>section{background-color:transparent;color:inherit;cursor:pointer;font:inherit;height:3em;line-height:3em;text-transform:uppercase;text-align:center;white-space:nowrap;width:100%;flex-grow:1;border-bottom:2px solid transparent;font-size:smaller}header>section:hover{background-color:var(--hover-color,rgb(0 0 0 / 5%))}header>section[selected]{border-bottom-color:var(--primary-color,#000);font-weight:700;color:var(--primary-color,#000)}::slotted(section){flex:1 1 auto;height:0;position:relative}</style> <main> <header></header> <slot></slot> </main>";const templates_M2Tabs=M2Tabs_code;class M2Tabs extends HTMLElement{#de;#D;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2Tabs,e.onclick=e=>{e.preventDefault(),e.stopPropagation()},this.#de=e.querySelector("header"),this.#de.onclick=this.#at,this.#D=e.querySelector("slot"),this.#D.addEventListener("slotchange",this.#nt)}#st=()=>{for(;this.#de.firstChild;)this.#de.removeChild(this.#de.lastChild)};#nt=()=>{this.#st(),this.#D.assignedElements().forEach((e=>{e.hidden=!0;const t=document.createElement("section");t.dataset.caption=e.dataset.caption,t.innerText=e.dataset.caption,this.#de.appendChild(t)})),this.value||(this.value=this.#de.querySelector("section:nth-child(1)")?.dataset.caption)};#at=({target:e})=>{this.value=e.dataset.caption,this.dispatchEvent(new CustomEvent("select",{bubbles:!1,cancelable:!1,detail:{caption:this.value}}))};get value(){return this.#de.querySelector("section[selected]")?.dataset?.caption}set value(e){this.#de.querySelector("section[selected]")?.removeAttribute("selected"),this.#D.assignedElements().forEach(((t,o)=>{t.dataset.caption===e?(t.hidden=!1,this.#de.querySelector(`section:nth-child(${o+1})`)?.setAttribute("selected","")):t.hidden=!0}))}}customElements.define("m2-tabs",M2Tabs);var ResourceHistory_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}</style> <m2-side-panel data-title="History"> <m2-round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></m2-round-button> <m2-round-button id="close" title="Close" data-icon="close" slot="appBarRight"></m2-round-button> <main slot="main"> <m2-linear-progress></m2-linear-progress> <m2-list></m2-list> </main> </m2-side-panel>';const templates_ResourceHistory=ResourceHistory_code;var M2List=__webpack_require__(344),M2SidePanel=__webpack_require__(529),M2ListRow_code="<style>main{padding:.75em 1em;background-color:inherit}main:hover,main[selected]{background-color:var(--hover-color,rgb(0 0 0 / 5%))}</style> <main> <slot></slot> </main>";const templates_M2ListRow=M2ListRow_code;class M2ListRow extends HTMLElement{#b;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2ListRow,this.#b=e.querySelector("main")}static get observedAttributes(){return["selected"]}attributeChangedCallback(e,t,o){"selected"===e&&(null===o?this.#b.removeAttribute("selected"):this.#b.setAttribute("selected",""))}}customElements.define("m2-list-row",M2ListRow);var M2ListItem=__webpack_require__(47);class ResourceHistory extends HTMLElement{#L;#_e;#K;#lt;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ResourceHistory,e.getElementById("help").onclick=this.#W,this.#L=e.querySelector("m2-list"),this.#L.onclick=this.#ct,this.#_e=e.querySelector("m2-linear-progress"),e.getElementById("close").onclick=this.#dt,this.#K=null,this.#lt=null}#ct=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("m2-list-row");if(t){if(t.hasAttribute("selected"))return;this.#L.querySelector("m2-list-row[selected]")?.removeAttribute("selected"),t.setAttribute("selected",""),location.hash=`#/${this.#K}/${this.#lt}/_history/${t.dataset.versionid}`}else e.preventDefault(),e.stopPropagation()};#W=e=>{window.open(Context.A.server.historyHelpUrl(),"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};#dt=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};load(e,t){e.interaction.find((({code:e})=>"vread"===e))&&(e.type===this.#K&&t===this.#lt||(this.#_e.hidden=!1,this.#L.clear(),this.#ht(e.type,t).then((t=>{this.#K=e.type,this.#lt=t.id;const o=t.meta?.versionId;this.#ut(e.type,t.id).then((e=>{"Bundle"===e.resourceType&&"history"===e.type&&e.total>0&&e.entry.filter((e=>e?.resource?.meta)).sort(((e,t)=>{const o=new Date(e.resource.meta.lastUpdated);return new Date(t.resource.meta.lastUpdated)-o})).forEach((e=>{const t=new M2ListRow;t.setAttribute("data-versionid",e.resource.meta.versionId),o===e.resource.meta.versionId&&t.setAttribute("selected","");const r=new Date(e.resource.meta.lastUpdated),i=new M2ListItem.A;i.setAttribute("data-icon","history"),i.setAttribute("data-primary",`${r.toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"})}`),i.setAttribute("data-secondary",`${r.toLocaleString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"})}`),t.appendChild(i),this.#L.appendChild(t)})),this.#_e.hidden=!0}))}))))}#ht=async(e,t)=>await Context.A.server.fetch(`/${e}/${t}`,{_format:"json"});#ut=async(e,t)=>await Context.A.server.fetch(`/${e}/${t}/_history`,{_format:"json",_summary:"text"})}customElements.define("resource-history",ResourceHistory);var ResourceJsonView_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}#content{flex:1 1 auto;height:0;box-shadow:inset 0 3px 4px var(--border-color);--indent:32px;color:var(--text-color-normal,#000);font-family:monospace;overflow:auto;padding:1em;white-space:nowrap}#content dl{margin:0;padding-left:var(--indent)}#content>dl{padding-left:0}#content dt{list-style-type:none}#content span{color:var(--json-viewer-values-color,#000);cursor:inherit}#content span.key{color:var(--json-viewer-properties-color,#000)}#content span.key::before{content:\'"\'}#content span.key::after{content:\'": \'}#content dt.array>span.value>dl>dt>span.key::before{content:\'\'}#content dt.array>span.value>dl>dt>span.key::after{content:\': \'}#content span.value a{color:inherit}#content span.value::before{content:\'"\'}#content span.value::after{content:\'"\'}#content span.value.array::before{content:\'[\'}#content span.value.array::after{content:\']\'}#content span.value.object::before{content:\'{\'}#content span.value.object::after{content:\'}\'}#content dt,#content span.value.array::after,#content span.value.object::after{padding-left:var(--indent)}#content dt:has(span.value.array),#content dt:has(span.value.object){padding-left:0}#content dt:has(span.value.array)::before,#content dt:has(span.value.object)::before{cursor:pointer;content:\'expand_less \';font-family:\'Material Symbols Sharp\';font-weight:700;line-height:inherit;vertical-align:middle;color:var(--text-color-disabled,#000)}#content dt:not(:last-child)::after{content:","}#content dt.collapsed:has(span.value.array)::before,#content dt.collapsed:has(span.value.object)::before{content:\'expand_more \'}#content dt.collapsed>span dl{display:none}#content dt.collapsed span.value.array::after{content:\'...]\';padding-left:0}#content dt.collapsed span.value.object::after{content:\'...}\';padding-left:0}footer{border-top:1px solid var(--border-color);padding:.5em;display:flex;flex-flow:row nowrap}footer>section:nth-child(2){flex-grow:1}footer span{display:inline-block}footer span:not(:last-child){border-right:1px solid var(--border-color);padding-right:.5em;margin-right:.25em}.raw{margin:0}#content i{vertical-align:middle;color:var(--primary-color);font-size:inherit;margin-left:.5em;cursor:pointer;border:1px solid var(--primary-color);border-radius:4px;padding:2px 4px}#content i:hover{background-color:var(--hover-color)}#content i::before{content:"view";font-family:var(--font-family);vertical-align:bottom;margin-right:2px}#content dt.collapsed i{display:none}#preview .Narrative{background-color:#fff;border:1px solid var(--border-color);padding:1em}#preview .Narrative table,#preview .Narrative td,#preview .Narrative th{border:1px solid var(--border-color)}#preview .Narrative table{border-collapse:collapse}#preview .Narrative table tr:nth-child(2n){background-color:#f2f2f2}@media (max-width:480px){#content{line-height:2em}}</style> <main> <div id="content"></div> <footer> <section> <m2-button-group> <button title="Raw" data-id="raw">raw_on</button> <button title="Enhanced" data-id="object">data_object</button> </m2-button-group> </section> <section></section> <section> <span> <m2-round-button id="sort-toggle" title="Sort" data-icon="sort_by_alpha"></m2-round-button> </span> <span> <m2-round-button id="share" title="Share" data-icon="share"></m2-round-button> <m2-round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></m2-round-button> <m2-round-button id="download" title="Download" data-icon="download"></m2-round-button> </span> </section> </footer> </main>';const templates_ResourceJsonView=ResourceJsonView_code;var M2ButtonGroup_code="<style>main{border:1px solid var(--border-color);display:inline-flex;flex-direction:row;border-radius:10px}::slotted(button){padding:.2em .4em;cursor:pointer;border:0 none;border-right:1px solid var(--border-color);color:inherit;background-color:transparent;border-radius:0;user-select:none;font-family:'Material Symbols Sharp';font-size:24px;line-height:1}::slotted(button:last-child){border-right:0 none}::slotted(button:hover){background-color:var(--hover-color,rgb(0 0 0 /5%))}::slotted(button[selected]){background-color:var(--hover-color,rgb(0 0 0 / 4%));color:var(--primary-color)}</style> <main> <slot></slot> </main>";const templates_M2ButtonGroup=M2ButtonGroup_code;class M2ButtonGroup extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2ButtonGroup,e.querySelector("main").onclick=this.#xe}#xe=e=>{const t=e.target.closest("button");t&&(this.value=t.dataset.id)};get value(){return this.querySelector("button[selected]")?.dataset.id}set value(e){this.querySelector("button[selected]")?.removeAttribute("selected");const t=this.querySelector(`button[data-id='${e}']`);t&&t.setAttribute("selected","")}}customElements.define("m2-button-group",M2ButtonGroup);var Snackbar=__webpack_require__(270);class ResourceJsonView extends HTMLElement{#pt;#mt;#gt;#bt;#ft={raw:"raw",object:"object"};#yt;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ResourceJsonView,this.#pt=null,this.#mt=e.getElementById("content"),this.#mt.onclick=this.#vt,this.#bt=Preferences.A.get("jsonView",{mode:this.#ft.object}),this.#gt=e.getElementById("sort-toggle"),this.#gt.onclick=this.#wt,this.#xt(),this.#yt=e.querySelector("m2-button-group"),this.#yt.onclick=this.#_t,e.getElementById("download").onclick=this.#Z,e.getElementById("copy").onclick=this.#Y,e.getElementById("share").onclick=this.#kt}connectedCallback(){this.#Ct()}#_t=e=>{switch(this.#yt.value){case"raw":this.#bt.mode=this.#ft.raw;break;case"object":this.#bt.mode=this.#ft.object}Preferences.A.set("jsonView",this.#bt),this.#Ct()};#Ct=()=>{switch(this.#yt.value=this.#bt.mode,this.#bt.mode){case this.#ft.raw:this.#mt.hidden=!1,this.#gt.hidden=!0;break;case this.#ft.object:this.#mt.hidden=!1,this.#gt.hidden=!1}this.#pt&&(this.source=this.#pt)};#wt=()=>{this.#bt.sortMode=!this.#bt.sortMode,Preferences.A.set("jsonView",this.#bt),this.#xt()};#xt=()=>{this.#gt.style.color=this.#bt.sortMode?"var(--primary-color)":"unset",this.#pt&&(this.source=this.#pt)};#vt=({target:e,offsetX:t,offsetY:o,ctrlKey:r})=>{if(e.querySelector("span.value.array")||e.querySelector("span.value.object")){const i=e.childNodes[0];if(i&&t<i.offsetLeft&&o<i.offsetHeight&&(e.classList.toggle("collapsed"),r)){const t=e.classList.contains("collapsed");Array.from(e.querySelectorAll("dt")).filter((e=>e.classList.contains("object")||e.classList.contains("array"))).forEach((e=>{t?e.classList.add("collapsed"):e.classList.remove("collapsed")}))}}};clear=()=>{this.#mt.scrollTo(0,0),this.#mt.innerHTML="Loading...",this.#mt.style.cursor="wait",this.#pt=null};get resourceType(){return this.#pt.resourceType}get resourceId(){return this.#pt.id}get source(){return this.#pt}set source(e){if(this.#mt.scrollTo(0,0),this.#mt.innerHTML="",this.#ft.raw===this.#bt.mode){const t=document.createElement("pre");t.classList.add("raw"),t.innerText=JSON.stringify(e,null,4),this.#mt.append(t)}else{const t=document.createElement("span");t.classList.add("value","object",e.resourceType),t.append(...this.#St(e,e.resourceType));const o=document.createElement("DT");o.append(t);const r=document.createElement("DL");r.append(o),this.#mt.append(r)}this.#mt.style.cursor="default",this.#pt=e}#Et=(e,t)=>{const o=e.properties[t];return o.const?"string":o.type?"array"===o.type?o.items.$ref.split("/").pop():o.type:o.$ref?o.$ref.split("/").pop():void 0};#St=(e,t)=>{const o=[];if(Context.A.server.schema.getDefinitionByName(t),"Address"===t){const t=this.#Tt(e);t&&o.push(t)}else if(["Binary","Attachment"].includes(t)){const t=this.#Mt(e);t&&o.push(t)}let r=Object.entries(e);this.#bt.sortMode&&(r=r.sort());const i=Context.A.server.schema.getDefinitionByName(t),s=document.createElement("dl");return s.append(...r.map((([o,r])=>{const s=document.createElement("span");s.classList.add("value");const a=this.#Et(i,o);"Reference"===t&&"reference"===o?this.#At(s,r):"ContactPoint"===t&&"value"===o?this.#Lt(s,e,r):this.#Dt(s,r,a);const n=document.createElement("dt");return n.append(this.#Rt(o),s),n}))),o.push(s),o};#Rt=e=>{const t=document.createElement("span");return t.className="key",t.innerText=e,t};#Dt=(e,t,o)=>{null===t?e.append("null"):Array.isArray(t)?(e.classList.add("array",o),e.append(this.#Bt(t,o))):"object"==typeof t?(e.classList.add("object",o),e.append(...this.#St(t,o))):["instant","dateTime"].includes(o)?this.#It(e,t,o):["url","uri"].includes(o)?this.#Pt(e,t):(e.classList.add(o),e.append(t))};#Mt=e=>{if(e.contentType&&e.data){const t=document.createElement("i");return t.className="material-symbols-sharp",t.innerText="open_in_new",t.title="View",t.onclick=()=>{window.open(function(){const t=`${e.contentType};charset=UTF-8`,o=window.atob(e.data),r=[];for(let e=0;e<o.length;e+=1024){const t=o.slice(e,e+1024),i=new Array(t.length);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);const s=new Uint8Array(i);r.push(s)}const i=new Blob(r,{type:t});return URL.createObjectURL(i)}(),"_blank")},t}};#Tt=e=>{let t="";e.line?.forEach((e=>{t+=` ${e}`})),t+=e.postalCode?` ${e.postalCode}`:"",t+=e.city?` ${e.city}`:"",t+=e.country?` ${e.country}`:"",t=t.replaceAll(" ","+");const o=document.createElement("i");return o.className="material-symbols-sharp",o.innerText="open_in_new",o.title="View",o.onclick=()=>{window.open(`http://www.google.com/maps?q=${t}`,"_blank")},o};#Lt=(e,t,o)=>{const r=document.createElement("a");switch(t.system){case"email":r.setAttribute("href",`mailto:${o}`),r.append(o),e.append(r);break;case"phone":r.setAttribute("href",`tel:${o}`),r.append(o),e.append(r);break;case"sms":r.setAttribute("href",`sms:${o}`),r.append(o),e.append(r);break;case"url":r.setAttribute("href",o),r.setAttribute("target","_blank"),r.append(o),e.append(r);break;default:e.append(o)}};#It=(e,t,o)=>{e.classList.add(o),e.append(function(e){const t={year:"numeric",month:"2-digit",day:"2-digit"},o={hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"},r=new Date(e);try{return`${r.toLocaleString(void 0,t)} ${r.toLocaleString(void 0,o)}`}catch(t){return e}}(t))};#At=(e,t)=>{e.classList.add("reference"),e.append(function(e){let t=e.replace(`${Context.A.server.url}`,"");t.startsWith("/")||t.startsWith("?")||(t=`/${t}`);const o=document.createElement("a");return o.setAttribute("href",`#${t}`),o.append(e),o}(t))};#Pt=(e,t)=>{e.classList.add("url"),e.append(function(e){const t=document.createElement("a");return t.setAttribute("href",`${e}`),t.setAttribute("target","_blank"),t.append(e),t}(t))};#Bt=(e,t)=>{const o=document.createElement("dl");return o.append(...e.map(((e,o)=>{const r=document.createElement("span");r.classList.add("value"),this.#Dt(r,e,t);const i=document.createElement("dt");return i.append(this.#Rt(o),r),i}))),o};#Z=()=>{const e=JSON.stringify(this.#pt),t=new File([e],this.resourceId,{type:"data:text/json;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${this.resourceType}#${t.name}.json`,r.click(),r.remove(),window.URL.revokeObjectURL(o)};#Y=()=>{const e=JSON.stringify(this.#pt);navigator.clipboard.writeText(e).then((function(){Snackbar.A.info("Copying to clipboard was successful")}),(function(){Snackbar.A.error("Could not copy text")}))};#kt=()=>{const e=JSON.stringify(this.#pt),t=`${this.resourceType}.${this.resourceId}.txt`,o=new File([e],t,{type:"text/plain"});navigator.share({title:t,files:[o]})}}customElements.define("resource-json-view",ResourceJsonView);var ResourceReferences_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}</style> <m2-side-panel data-title="References"> <m2-round-button id="close" title="Close" data-icon="close" slot="appBarRight"></m2-round-button> <main slot="main"> <m2-list></m2-list> </main> </m2-side-panel>';const templates_ResourceReferences=ResourceReferences_code,fhirIconSet={account:"account_balance_wallet",accountreport:"account_balance_wallet",activitydefinition:"quiz",administrableproductdefinition:"fluid_med",adverseevent:"emergency_home",allergyintolerance:"allergy",appointment:"today",appointmentresponse:"event_available",auditevent:"browse_activity",basic:"shapes",binary:"data_object",biologicallyderivedproduct:"fork_right",bodystructure:"skeleton",bundle:"format_paragraph",capabilitystatement:"campaign",careplan:"flowsheet",careteam:"groups",catalogentry:"description",chargeitem:"sell",chargeitemdefinition:"sell",citation:"bubbles",claim:"request_quote",claimresponse:"task",clinicalimpression:"comment",codesystem:"data_array",communication:"mail",communicationrequest:"outgoing_mail",compartmentdefinition:"category",composition:"blender",conceptmap:"integration_instructions",condition:"coronavirus",consent:"done",contract:"contract",coverage:"shield",coverageeligibilityrequest:"policy",coverageeligibilityresponse:"verified_user",detectedissue:"bug_report",device:"electrical_services",devicedefinition:"inventory_2",devicemetric:"health_metrics",devicerequest:"unknown_document",deviceusestatement:"home_iot_device",diagnosticreport:"diagnosis",documentmanifest:"dataset",documentreference:"bookmarks",effectevidencesynthesis:"clinical_notes",encounter:"event",encounterhistory:"event_repeat",enrollmentrequest:"contact_support",enrollmentresponse:"support_agent",endpoint:"location_on",episodeofcare:"blood_pressure",evidence:"search_check",evidencevariable:"troubleshoot",eventdefinition:"event_note",examplescenario:"video_library",explanationofbenefit:"speaker_notes",familymemberhistory:"family_restroom",familimemberhistory:"history",flag:"flag",goal:"sports_score",graphdefinition:"bar_chart",group:"group",guidanceresponse:"mark_email_read",healthcareservice:"mixture_med",implementationguide:"developer_guide",imagingstudy:"radiology",immunization:"immunology",immunizationevaluation:"microbiology",immunizationrecommendation:"mixture_med",insuranceplan:"payments",invoice:"receipt_long",library:"local_library",linkage:"link",list:"list",location:"pin_drop",manifest:"dataset",measure:"scale",measurereport:"lab_profile",media:"perm_media",medicinalproduct:"pill",medicinalproductauthorization:"pill",medicinalproductcontraindication:"pill_off",medicinalproductindication:"pill",medicinalproductingredient:"pill",medicinalproductinteraction:"pill",medicinalproductmanufactured:"pill",medicinalproductpackaged:"pill",medicinalproductpharmaceutical:"pill",medicinalproductundesirableeffect:"sick",medication:"medication",medicationadministration:"medication_liquid",medicationdispense:"prescriptions",medicationknowledge:"medication",medicationrequest:"medication",medicationstatement:"medication",messagedefinition:"developer_guide",messageheader:"code",molecularsequence:"genetics",namingsystem:"import_contacts",nutritionorder:"restaurant",observation:"description",observationdefinition:"file_present",operationdefinition:"function",operationoutcome:"function",organization:"local_hospital",organizationaffiliation:"account_tree",parameters:"settings",patient:"personal_injury",paymentnotice:"credit_card",paymentreconciliation:"credit_score",person:"person",plandefinition:"view_list",practitioner:"stethoscope",practitionerrole:"medical_information",procedure:"checklist",provenance:"deployed_code_history",questionnaire:"assignment",questionnaireresponse:"assignment_turned_in",relatedperson:"family_restroom",requestgroup:"group_work",researchdefinition:"lab_panel",researchelementdefinition:"labs",researchstudy:"biotech",researchsubject:"biotech",resource:"description",riskevidencesynthesis:"feedback",riskassessment:"problem",schedule:"calendar_month",searchparameter:"screen_search_desktop",servicerequest:"ecg",slot:"view_agenda",specimen:"colorize",specimendefinition:"colorize",structuredefinition:"developer_guide",structuremap:"table",subscription:"loyalty",subscriptionstatus:"loyalty",subscriptiontopic:"loyalty",substance:"science",substancedefinition:"science",substancenucleicacid:"science",substancepolymer:"science",substanceprotein:"science",substancereferenceinformation:"science",substancesourcematerial:"science",substancespecification:"science",supplydelivery:"deployed_code",supplyrequest:"deployed_code_history",task:"task",terminologycapabilities:"developer_guide",testreport:"integration_instructions",testscript:"code_blocks",transport:"transportation",valueset:"data_array",verificationresult:"new_releases",visionprescription:"ophthalmology"};class ResourceReferences extends HTMLElement{#L;#lt;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ResourceReferences,this.#L=e.querySelector("m2-list"),this.#L.onclick=this.#ct,this.#L.onFilter=this.#Ce,e.getElementById("close").onclick=this.#dt,this.#lt=null}#ct=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("m2-list-row");t&&(location.hash=`#/${t.dataset.target}?${t.dataset.search}=${this.#lt}`)};#Ce=({value:e,caseSensitive:t})=>{const o=new RegExp(e,t?"":"i");this.#L.childNodes.forEach((e=>{e.hidden=!o.exec(`${e.dataset.target}.${e.dataset.search}`)}))};#dt=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};load(e,t){this.#lt=t,this.#L.clear();const o=Context.A.server.references(e.type);return o&&Object.entries(o).forEach((([e,t])=>{this.#L.append(...t.map((t=>{const o=new M2ListRow;return o.setAttribute("data-target",e),o.setAttribute("data-search",t.name),o.appendChild(new M2ListItem.A(fhirIconSet[e.toLowerCase()],`${e}.${t.name}`,t.documentation.length>100?`${t.documentation.substring(0,100)}...`:t.documentation)),o})))})),this.#L.children.length>0}}customElements.define("resource-references",ResourceReferences);var ResourceTtlView_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}#content{color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;white-space:pre;margin:0;box-shadow:inset 0 3px 4px var(--border-color)}footer{border-top:1px solid var(--border-color);padding:.5em;display:flex;flex-flow:row nowrap}footer>section:nth-child(2){flex-grow:1}footer span{display:inline-block}footer span:not(:last-child){border-right:1px solid var(--border-color);padding-right:.5em;margin-right:.25em}@media (max-width:480px){#content{line-height:2em}}</style> <main> <pre id="content"></pre> <footer> <section></section> <section></section> <section> <span> <m2-round-button id="share" title="Share" data-icon="share"></m2-round-button> <m2-round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></m2-round-button> <m2-round-button id="download" title="Download" data-icon="download"></m2-round-button> </span> </section> </footer> </main>';const templates_ResourceTtlView=ResourceTtlView_code;class ResourceTtlView extends HTMLElement{#mt;#pt;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ResourceTtlView,this.#mt=e.getElementById("content"),e.getElementById("download").onclick=this.#Z,e.getElementById("copy").onclick=this.#Y,e.getElementById("share").onclick=this.#kt,this.#pt=null}clear=()=>{this.#mt.scrollTo(0,0),this.#mt.innerHTML="Loading...",this.#mt.style.cursor="wait",this.#pt=null};get resourceType(){return this.#pt.match(/rdf:type\s*fhir:(\w+)/)[1]}get resourceId(){return this.#pt.match(/fhir:Resource.id\s*\[\s*fhir:value\s*"([^"]+)"\s*\]/)[1]}get source(){return this.#pt}set source(e){this.#mt.scrollTo(0,0),this.#mt.innerText=e,this.#mt.style.cursor="default",this.#pt=e}#Z=()=>{const e=this.#pt,t=new File([e],this.resourceId,{type:"data:text/plain;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${this.resourceType}#${t.name}.txt`,r.click(),r.remove(),window.URL.revokeObjectURL(o)};#Y=()=>{const e=this.#pt;navigator.clipboard.writeText(e).then((function(){Snackbar.A.info("Copying to clipboard was successful")}),(function(){Snackbar.A.error("Could not copy text")}))};#kt=()=>{const e=this.#pt,t=`${this.resourceType}.${this.resourceId}.txt`,o=new File([e],t,{type:"text/plain"});navigator.share({title:t,files:[o]})}}customElements.define("resource-ttl-view",ResourceTtlView);var ResourceValidate_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}</style> <m2-side-panel data-title="Validate"> <m2-round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></m2-round-button> <m2-round-button id="close" title="Close" data-icon="close" slot="appBarRight"></m2-round-button> <main slot="main"> <m2-linear-progress></m2-linear-progress> <m2-list></m2-list> </main> </m2-side-panel>';const templates_ResourceValidate=ResourceValidate_code;class ResourceValidate extends HTMLElement{#L;#_e;#it=Object.freeze({information:"info",warning:"warning",error:"error",fatal:"dangerous"});constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ResourceValidate,e.getElementById("help").onclick=this.#W,this.#L=e.querySelector("m2-list"),this.#L.onclick=this.#ct,this.#L.onFilter=this.#Ce,this.#_e=e.querySelector("m2-linear-progress"),e.getElementById("close").onclick=this.#dt}#ct=e=>{e.preventDefault(),e.stopPropagation()};#Ce=({value:e,caseSensitive:t})=>{const o=new RegExp(e,t?"":"i");this.#L.querySelectorAll("m2-list-item").forEach((e=>{e.parentNode.hidden=!(o.exec(e.dataset.primary)||o.exec(e.dataset.secondary))}))};#W=e=>{window.open(Context.A.server.validateHelpUrl(),"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};#dt=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};load(e,t){(e?.operation?.find((({name:e})=>"validate"===e))||Context.A.server.capabilities.rest[0].operation?.find((({name:e})=>"validate"===e)))&&(this.#_e.hidden=!1,this.#L.clear(),this.#Ht(e.type,t).then((e=>{this.#_e.hidden=!0,this.#L.append(...e.issue.map((e=>{const t=new M2ListRow;return t.append(new M2ListItem.A(this.#it[e.severity]||"error",Array.isArray(e.location)?e.location[0]:e.code,e.diagnostics)),t})))})))}#Ht=async(e,t)=>await Context.A.server.fetch(`/${e}/${t}/$validate`,{_format:"json"})}customElements.define("resource-validate",ResourceValidate);var ResourceXmlView_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}#content{--indent:32px;color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;margin:0;white-space:nowrap;box-shadow:inset 0 3px 4px var(--border-color)}#content dl{margin:0;padding-left:var(--indent)}#content>dl{padding-left:0}#content dt{list-style-type:none}#content span.key{color:var(--xml-viewer-nodes-color,#000)}#content span.key::before{content:\'<\'}#content span.key::after{content:\'>\'}#content span.attributes{color:var(--xml-viewer-attributes-color,#000)}#content span.values{color:var(--xml-viewer-values-color,#000)}#content span.values a{color:inherit}#content span.key.end{padding-left:var(--indent)}#content dt,#content dt.object>span.value::after{padding-left:var(--indent)}#content dt.object{padding-left:0}#content dt.object::before{cursor:pointer;content:\'expand_less \';font-family:\'Material Symbols Sharp\';font-weight:700;line-height:inherit;vertical-align:middle;color:var(--text-color-disabled,#000)}#content dt.collapsed::before{content:\'expand_more \'}#content dt.collapsed>span dl{display:none}#content dt.object.collapsed span.value::after{content:\'...\';padding-left:0}#content dt.object.collapsed span.key.end{padding-left:0}footer{border-top:1px solid var(--border-color);padding:.5em;display:flex;flex-flow:row unwrap}footer>section:nth-child(2){flex-grow:1}footer span{display:inline-block}footer span:not(:last-child){border-right:1px solid var(--border-color);padding-right:.5em;margin-right:.25em}@media (max-width:480px){#content{line-height:2em}}</style> <main> <div id="content"></div> <footer> <section></section> <section></section> <section> <span> <m2-round-button id="sort-toggle" title="Sort" data-icon="sort_by_alpha"></m2-round-button> </span> <span><m2-round-button id="share" title="Share" data-icon="share"></m2-round-button> <m2-round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></m2-round-button> <m2-round-button id="download" title="Download" data-icon="download"></m2-round-button> </span> </section> </footer> </main>';const templates_ResourceXmlView=ResourceXmlView_code;var M2Switch_code='<style>main{position:relative;display:inline-block;width:36px;height:20px;top:2px}main input{opacity:0;width:0;height:0}span{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--text-color-disabled);-webkit-transition:.4s;transition:.4s;border-radius:34px}span:before{position:absolute;content:"";height:14px;width:14px;left:3px;bottom:3px;background-color:#fff;-webkit-transition:.4s;transition:.4s;border-radius:50%}.checked span{background-color:var(--primary-color)}.focus span{box-shadow:0 0 1px var(--primary-color)}.checked span:before{transform:translateX(15px)}</style> <main> <span></span> </main>';const templates_M2Switch=M2Switch_code;class M2Switch extends HTMLElement{#b;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2Switch,e.addEventListener("click",this.#xe),this.#b=e.querySelector("main")}static get observedAttributes(){return["data-checked"]}attributeChangedCallback(e,t,o){"data-checked"===e&&(null===o?this.#b.classList.remove("checked"):this.#b.classList.add("checked"))}#xe=e=>{this.hasAttribute("data-checked")?this.removeAttribute("data-checked"):this.setAttribute("data-checked","")}}window.customElements.define("m2-switch",M2Switch);class ResourceXmlView extends HTMLElement{#pt;#mt;#gt;#Ot;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ResourceXmlView,this.#pt=null,this.#mt=e.getElementById("content"),this.#mt.onclick=this.#vt,this.#Ot=Preferences.A.get("xmlView",{sorted:!1}).sorted,this.#gt=e.getElementById("sort-toggle"),this.#gt.onclick=this.#wt,e.getElementById("download").onclick=this.#Z,e.getElementById("copy").onclick=this.#Y,e.getElementById("share").onclick=this.#kt}connectedCallback(){this.#xt()}#wt=()=>{this.#Ot=!this.#Ot,Preferences.A.set("xmlView",{sorted:this.#Ot}),this.#xt()};#xt=()=>{this.#gt.style.color=this.#Ot?"var(--primary-color)":"unset",this.#pt&&(this.source=this.#pt)};#vt=({target:e,offsetX:t,offsetY:o,ctrlKey:r})=>{if(e.classList.contains("object")){const i=e.childNodes[0];if(i&&t<i.offsetLeft&&o<i.offsetHeight&&(e.classList.toggle("collapsed"),r)){const t=e.classList.contains("collapsed");Array.from(e.querySelectorAll("dt")).filter((e=>e.classList.contains("object"))).forEach((e=>{t?e.classList.add("collapsed"):e.classList.remove("collapsed")}))}}};clear=()=>{this.#mt.scrollTo(0,0),this.#mt.innerHTML="Loading...",this.#mt.style.cursor="wait",this.#pt=null};get resourceType(){return this.#pt?.documentElement?.nodeName}get resourceId(){return this.#pt?.documentElement?.querySelector("id[value]")?.getAttribute("value")}get source(){return this.#pt}set source(e){this.#mt.scrollTo(0,0),this.#mt.innerHTML=this.#qt(e).outerHTML,this.#mt.style.cursor="default",this.#pt=e}#qt=e=>{const t=document.createElement("dl"),o=Array.from(e.children);return this.#Ot&&o.sort(((e,t)=>e.nodeName.localeCompare(t.nodeName))),o.forEach((e=>{const o=document.createElement("dt");let r=document.createElement("span");r.className="key",r.innerText=e.nodeName,o.appendChild(r),e.attributes.length&&Array.from(e.attributes).forEach((t=>{const o=document.createElement("span");o.className="attributes",o.innerText=` ${t.nodeName}=`,r.appendChild(o);const i=document.createElement("span");if(i.className="values","reference"===e.nodeName&&"value"===t.nodeName){let e=t.nodeValue.replace(`${Context.A.server.url}`,"");e.startsWith("/")||e.startsWith("?")||(e=`/${e}`);const o=document.createElement("a");o.setAttribute("href",`#${e}`),o.appendChild(document.createTextNode(`"${t.nodeValue}"`)),i.appendChild(o)}else i.innerText=`"${t.nodeValue}"`;o.appendChild(i)}));const i=document.createElement("span");i.classList.add("value"),e.children.length?(o.classList.add("object"),i.innerHTML=this.#qt(e).outerHTML,o.appendChild(i),r=document.createElement("span"),r.className="key end",r.innerText=`/${e.nodeName}`,o.appendChild(r)):r.innerHTML+="/",t.appendChild(o)})),t};#Z=()=>{const e=(new XMLSerializer).serializeToString(this.#pt),t=new File([e],this.resourceId,{type:"data:text/xml;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${this.resourceType}#${t.name}.xml`,r.click(),r.remove(),window.URL.revokeObjectURL(o)};#Y=()=>{const e=(new XMLSerializer).serializeToString(this.#pt);navigator.clipboard.writeText(e).then((function(){Snackbar.A.info("Copying to clipboard was successful")}),(function(){Snackbar.A.error("Could not copy text")}))};#kt=()=>{const e=(new XMLSerializer).serializeToString(this.#pt),t=`${this.resourceType}.${this.resourceId}.txt`,o=new File([e],t,{type:"text/plain"});navigator.share({title:t,files:[o]})}}customElements.define("resource-xml-view",ResourceXmlView);class Resource extends HTMLElement{#$t;#Vt;#jt;#Ft;#Ut;#Nt;#Kt;#zt;#Wt;#q;#K;#lt;#Gt;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_Resource,e.getElementById("help").onclick=this.#W,this.#$t=e.getElementById("validateToggle"),this.#$t.onclick=this.#Jt,this.#Vt=e.querySelector("resource-validate"),this.#Ft=e.getElementById("referencesToggle"),this.#Ft.onclick=this.#Xt,this.#Ut=e.querySelector("resource-references"),this.#zt=null,this.#Nt=e.getElementById("historyToggle"),this.#Nt.onclick=this.#Yt,this.#Kt=e.querySelector("resource-history"),this.#Wt=e.querySelector("m2-tabs"),this.#Wt.addEventListener("select",this.#Zt),this.#q=e.getElementById("title"),this.#K=null,this.#lt=null,this.#Gt={}}connectedCallback(){Context.A.addListener(this.#Qt),new MutationObserver(this.#eo).observe(this.#Ut,{attributes:!0}),new MutationObserver(this.#eo).observe(this.#Kt,{attributes:!0}),new MutationObserver(this.#eo).observe(this.#Vt,{attributes:!0})}#eo=e=>{e.forEach((({type:e,attributeName:t,target:o})=>{"attributes"===e&&"hidden"===t&&(o===this.#Kt?this.#Nt.hidden=this.#zt||!o.hidden:o===this.#Ut?this.#Ft.hidden=!o.hidden:o===this.#Vt&&(this.#$t.hidden=this.#jt||!o.hidden))}))};#Zt=({detail:e})=>{const t=e.caption,o=location.hash.match(/\?([^?]+)$/);if(o?.length>0){const e=new URLSearchParams(o[1]);e.set("_format",t),location.hash=location.hash.replace(/\?[^?]+$/,`?${e.toString()}`)}else location.hash=`${location.hash}?_format=${t}`};#Jt=()=>{this.#Vt.hidden&&(this.#Ut.hidden=!0,this.#Kt.hidden=!0,this.#Vt.load(this.#K,this.#lt)),this.#Vt.hidden=!this.#Vt.hidden};#Xt=()=>{this.#Ut.hidden&&(this.#Vt.hidden=!0,this.#Kt.hidden=!0,this.#Ut.load(this.#K,this.#lt)),this.#Ut.hidden=!this.#Ut.hidden};#Yt=()=>{this.#Kt.hidden&&(this.#Vt.hidden=!0,this.#Ut.hidden=!0,this.#Kt.load(this.#K,this.#lt)),this.#Kt.hidden=!this.#Kt.hidden};#W=()=>{window.open(`${Context.A.server.resourceHelpUrl(this.#K.type)}#resource`,"FhirBrowserHelp")};#Qt=()=>{for(;this.#Wt.firstChild;)this.#Wt.removeChild(this.#Wt.lastChild);this.#Gt={};const e=Context.A.server;if(e.isFormatEnable("json")){const e=new ResourceJsonView,t=document.createElement("section");t.dataset.caption="json",t.appendChild(e),this.#Wt.appendChild(t),this.#Gt.json=e}if(e.isFormatEnable("xml")){const e=new ResourceXmlView,t=document.createElement("section");t.dataset.caption="xml",t.appendChild(e),this.#Wt.appendChild(t),this.#Gt.xml=e}if(e.isFormatEnable("ttl")){const e=new ResourceTtlView,t=document.createElement("section");t.dataset.caption="ttl",t.appendChild(e),this.#Wt.appendChild(t),this.#Gt.ttl=e}};set source(e){let t;if(t=e instanceof Document?"xml":"object"==typeof e?"json":"ttl",t){const o=this.#Gt[t];o.source=e;const r=o.resourceType;this.#q.innerText=r;const i=o.resourceId;i===this.#lt&&r===this.#K?.type||(this.#K=Context.A.server.capabilities.rest[0].resource.find((e=>e.type===r)),this.#lt=i,Object.entries(this.#Gt).filter((([e])=>e!==t)).forEach((([,e])=>e.clear()))),this.#Wt.value=t}window.matchMedia("(max-width: 480px)").matches&&(this.#Vt.hidden=!0,this.#Ut.hidden=!0,this.#Kt.hidden=!0),this.#jt=!(this.#K?.operation?.find((({name:e})=>"validate"===e))||Context.A.server.capabilities.rest[0].operation?.find((({name:e})=>"validate"===e))),this.#jt?(this.#Vt.hidden=!0,this.#$t.hidden=!0):this.#$t.hidden=!this.#Vt.hidden,this.#Vt.hidden||this.#Vt.load(this.#K,this.#lt),this.#zt=void 0===this.#K?.interaction.find((({code:e})=>"vread"===e)),this.#zt?(this.#Kt.hidden=!0,this.#Nt.hidden=!0):this.#Nt.hidden=!this.#Kt.hidden,this.#Kt.hidden||this.#Kt.load(this.#K,this.#lt),this.#Ut.hidden||this.#Ut.load(this.#K,this.#lt)}get resourceType(){return this.#K.type}}customElements.define("fhir-resource",Resource);class SettingsService{#_="conf";setAll(e){localStorage.setItem(this.#_,JSON.stringify(e))}async getAll(){const e=localStorage.getItem(this.#_);return null===e?await fetch("./default.conf",{cache:"reload"}).then((e=>e.json())).then((e=>(localStorage.setItem(this.#_,JSON.stringify(e)),e))):JSON.parse(e)}async get(e){return await this.getAll().then((t=>t[e]))}}const Settings=new SettingsService;var Server=__webpack_require__(805),ServerDialog_code='<style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%;min-width:400px}#list{flex:1 1 auto;height:0}#setupAdd{position:absolute;bottom:4em;right:1em;background-color:var(--primary-color);border-radius:100%;color:#fff;box-shadow:0 3px 5px -1px rgb(0 0 0 / .2),0 6px 10px 0 rgb(0 0 0 / .14),0 1px 18px 0 rgb(0 0 0 / .12)}footer{border-top:1px solid var(--border-color);padding:9px 16px;text-align:right;overflow:hidden}m2-dialog #setupToggle,m2-dialog.edit #setupAdd,m2-dialog.edit footer{display:block}m2-dialog #setupAdd,m2-dialog footer,m2-dialog.edit #setupToggle{display:none}#setupClose{display:none}@media (max-width:480px){main{min-width:none}#setupClose{display:block}}</style> <m2-dialog id="serverDialog" data-title="Connections"> <m2-round-button slot="appBarLeft" id="setupClose" title="close" data-icon="close"></m2-round-button> <m2-round-button slot="appBarRight" id="setupToggle" title="setup" data-icon="edit"></m2-round-button> <main> <section id="list"> <server-list></server-list> <m2-round-button id="setupAdd" title="add" data-icon="add"></m2-round-button> </section> <footer> <m2-button id="setupCancel">cancel</m2-button> <m2-button id="setupSave">save</m2-button> </footer> </main> </m2-dialog> <server-form hidden></server-form>';const templates_ServerDialog=ServerDialog_code;var M2Dialog_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{position:absolute;top:0;left:0;background-color:rgb(0 0 0 / 32%);min-height:100%;min-width:100%}.surface{background-color:var(--background-color,#fff);border-radius:4px;height:60%;max-width:50%;position:absolute;top:1em;right:1em}.surface.centered{left:50%;right:unset;top:50%;transform:translateX(-50%) translateY(-50%)}.surface.fullscreen{width:95%;height:95%;max-width:unset}.overlay{background-color:rgb(255 255 255 / 4%);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:var(--font-family);height:100%}#title{margin:.5em 0}#content{overflow:hidden;flex:1 1 auto;height:0}@media (max-width:480px){.surface,.surface.centered,.surface.fullscreen{top:0;left:0;right:unset;bottom:unset;transform:unset;height:100%;width:100%;max-height:unset;max-width:unset}.overlay{background-color:transparent}}</style> <main> <div class="surface"> <div class="overlay"> <section id="header"> <m2-app-bar> <section slot="left"> <slot name="appBarLeft"></slot> </section> <h3 id="title" slot="middle"></h3> <section slot="right"> <slot name="appBarRight"></slot> </section> </m2-app-bar> </section> <section id="content"> <slot></slot> </section> </div> </div> </main>';const templates_M2Dialog=M2Dialog_code;class M2Dialog extends HTMLElement{#to;#q;constructor(e){super();const t=this.attachShadow({mode:"closed"});t.innerHTML=templates_M2Dialog,t.querySelector("main").addEventListener("mousedown",(e=>this.onClose(e))),this.#to=t.querySelector(".surface"),this.#to.addEventListener("mousedown",(e=>e.stopPropagation())),this.#q=t.getElementById("title"),e&&(this.title=e)}connectedCallback(){window.addEventListener("hashchange",(e=>this.onClose(e)))}#oo=()=>{this.hidden=!0};get onClose(){return this.#oo}set onClose(e){this.#oo=e}static get observedAttributes(){return["data-title","centered","fullscreen"]}attributeChangedCallback(e,t,o){"centered"===e?this.#to.classList.add("centered"):"fullscreen"===e?this.#to.classList.add("fullscreen"):"data-title"===e&&(this.#q.innerText=o)}set title(e){this.setAttribute("data-title",e)}get title(){return this.getAttribute("data-title")}set fullscreen(e){e?this.setAttribute("fullscreen",""):this.removeAttribute("fullscreen")}get fullscreen(){return this.hasAttribute("fullscreen")}set centered(e){e?this.setAttribute("centered",""):this.removeAttribute("centered")}get centered(){return this.hasAttribute("centered")}}window.customElements.define("m2-dialog",M2Dialog);var ServerForm_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%;font-family:var(--font-family)}#content{flex:1 1 auto;height:0;padding:1em;overflow-y:auto;min-width:40em}#formDialog footer{border-top:1px solid var(--border-color)}footer{padding:9px 16px;text-align:right;overflow:hidden}p{margin:0;padding:1em}.radioGroup{display:flex;flex-flow:row wrap;gap:.5em;padding:0 0 15px 15px}.radioGroup label{font-family:inherit;font-size:inherit;white-space:nowrap}legend{padding:0;color:var(--text-color-disabled);font-size:smaller;padding-left:15px}@media (max-width:480px){#content{min-width:unset}}</style> <m2-dialog id="formDialog" centered> <m2-round-button slot="appBarRight" id="formDelete" title="Delete" data-icon="delete"></m2-round-button> <main> <section id="content"> <m2-textfield id="key" placeholder="Code" required></m2-textfield> <m2-textfield id="url" type="url" pattern="https?://.+" placeholder="Url" required></m2-textfield> <legend>Auth method:</legend> <div class="radioGroup"> <label for="authNo">No Auth <input type="radio" id="authNo" name="authMethod" value="No Auth" checked="checked"/> </label> <label for="authApi">API Key <input type="radio" id="authApi" name="authMethod" value="API Key"/> </label> <label for="authBasic">Basic <input type="radio" id="authBasic" name="authMethod" value="Basic"/> </label> <label for="authOauth">OAuth 2 <input type="radio" id="authOauth" name="authMethod" value="OAuth 2"/> </label> </div> <section id="apiSection" hidden> <m2-textfield id="apiKey" placeholder="Key" required></m2-textfield> <m2-textfield id="apiValue" placeholder="Value" required></m2-textfield> </section> <section id="basicSection" hidden> <m2-textfield id="basicUsername" placeholder="Username" required></m2-textfield> <m2-textfield id="basicPassword" placeholder="Password" required></m2-textfield> </section> <section id="oauthSection" hidden> <m2-textfield id="oauthGranttype" placeholder="Grant Type" value="client_credentials" required readonly="readonly"></m2-textfield> <m2-textfield id="oauthTokenurl" type="url" pattern="https?://.+" placeholder="Access Token URL" required></m2-textfield> <m2-textfield id="oauthClientid" placeholder="Client ID" required></m2-textfield> <m2-textfield id="oauthClientsecret" placeholder="Client Secret" required></m2-textfield> <m2-textfield id="oauthScope" placeholder="Scope"></m2-textfield> <legend>Add credential to:</legend> <div class="radioGroup"> <label for="oauthCredentialsHeader">Basic Auth Header <input type="radio" id="oauthCredentialsHeader" name="oauthCredentials" value="header" checked="checked"/> </label> <label for="oauthCredentialsBody">Request body <input type="radio" id="oauthCredentialsBody" name="oauthCredentials" value="body"/> </label> </div> </section> </section> <footer> <m2-button id="formCancel">cancel</m2-button> <m2-button id="formOk">apply</m2-button> </footer> </main> </m2-dialog> <m2-confirm data-ok-text="delete" hidden> <p>Delete this configuration?</p> </m2-confirm>';const templates_ServerForm=ServerForm_code;var M2Confirm_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{position:absolute;top:0;left:0;background-color:rgb(0 0 0 /32%);min-height:100%;min-width:100%}.surface{background-color:var(--background-color,#fff);border-radius:4px;position:absolute;left:50%;top:50%;transform:translateX(-50%) translateY(-50%)}.overlay{background-color:rgb(255 255 255 / 4%);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:var(--font-family);height:100%}h2{margin:.5em 1em}footer{padding:9px 16px;text-align:right;overflow:visible}@media (max-width:480px){.surface{width:90%}.overlay{background-color:transparent}}</style> <main> <div class="surface"> <div class="overlay"> <h2></h2> <slot></slot> <footer> <m2-button id="btnCancel">cancel</m2-button> <m2-button id="btnOk">ok</m2-button> </footer> </div> </div> </main>';const templates_M2Confirm=M2Confirm_code;class M2Confirm extends HTMLElement{#q;#ro;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2Confirm,e.querySelector("main").onclick=this.#oo,e.querySelector(".surface").onclick=e=>e.stopPropagation(),this.#q=e.querySelector("h2"),this.#ro=e.getElementById("btnOk"),this.#ro.onclick=this.#io,e.getElementById("btnCancel").onclick=this.#oo}#oo=e=>{this.hidden=!0};#io=e=>{this.onValidate(e),this.hidden=!0};#Me=e=>{};get onValidate(){return this.#Me}set onValidate(e){this.#Me=e}static get observedAttributes(){return["data-title","data-ok-text"]}attributeChangedCallback(e,t,o){"data-title"===e?this.#q.innerText=o:"data-ok-text"===e&&this.#ro.setAttribute("value",o)}}window.customElements.define("m2-confirm",M2Confirm);var M2TextField_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}#field{background-color:var(--hover-color,#d3d3d3);border-bottom:1px solid rgb(0 0 0 / 42%);display:flex;font-size:1em;position:relative}main:focus-within{border-bottom-color:var(--primary-color,#000)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;caret-color:var(--primary-color,black);color:var(--text-color-normal,#000);flex:auto;font:inherit;padding:15px}input[readonly]{cursor:default}input:focus{outline:0;padding:23px 15px 7px 15px;border-color:var(--primary-color)}input::placeholder{font-size:1em;color:var(--text-color-disabled,#000)}input::selection{color:#fff;background:var(--primary-color)}input:focus::placeholder{visibility:hidden}input:not(:placeholder-shown){padding:23px 15px 7px 15px}label{color:var(--text-color-disabled,#000);font-size:12px;left:15px;pointer-events:none;position:absolute;top:6px;visibility:hidden}input:focus+label,input:not(:placeholder-shown)+label{visibility:visible}input:focus+label{color:var(--primary-color,#000)}input:invalid+label,input:invalid:focus{color:var(--background-error);border-color:var(--background-error)}input:required+label::after{content:\'*\'}#helper{font-size:smaller;margin:0 0 1em 1em}</style> <main> <section id="field"> <input type="text" placeholder="" spellcheck="false"> <label></label> </section> <section id="helper"></section> </main>';const templates_M2TextField=M2TextField_code;class M2TextField extends HTMLElement{#so;#We;#ao;#no;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2TextField,this.#so=e.querySelector("label"),this.#no="",this.#We=e.querySelector("input"),this.#ao=e.getElementById("helper")}static get observedAttributes(){return["type","pattern","placeholder","readonly","required","value","helper"]}attributeChangedCallback(e,t,o){switch(e){case"type":this.#We.setAttribute("type",o);break;case"pattern":this.#We.setAttribute("pattern",o);break;case"placeholder":this.#no=o,this.#We.setAttribute("placeholder",o),this.#so.innerText=o;break;case"readonly":case"required":null==o?this.#We.removeAttribute(e):this.#We.setAttribute(e,"");break;case"value":this.#We.setAttribute("value",o);break;case"helper":this.#ao.innerText=o}this.#We.hasAttribute("required")&&this.#We.setAttribute("placeholder",`${this.#no}*`)}checkValidity=function(){return this.#We.checkValidity()};focus=function(){this.#We.focus()};get value(){return this.#We.value}set value(e){this.#We.value=e}}window.customElements.define("m2-textfield",M2TextField);var ServerConfiguration=__webpack_require__(77);class ServerForm extends HTMLElement{#lo;#mt;#co;#r;#do;#ho;#uo;#po;#mo;#a;#n;#go;#l;#c;#bo;#d;#fo;#u;#m;#yo;#vo;#p;#wo;#xo;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ServerForm,this.#lo=e.querySelector("m2-dialog"),this.#lo.onClose=this.appDialogClose,this.#mt=e.getElementById("content"),e.querySelectorAll('input[name="authMethod"]').forEach((e=>{e.addEventListener("change",this.authMethodChange)})),e.querySelector("main").onkeydown=this.mainKeyDown,this.#co=e.getElementById("key"),this.#r=e.getElementById("url"),this.#do=e.getElementById("authNo"),this.#ho=e.getElementById("authApi"),this.#uo=e.getElementById("authBasic"),this.#po=e.getElementById("authOauth"),this.#mo=e.getElementById("apiSection"),this.#a=e.getElementById("apiKey"),this.#n=e.getElementById("apiValue"),this.#go=e.getElementById("basicSection"),this.#l=e.getElementById("basicUsername"),this.#c=e.getElementById("basicPassword"),this.#bo=e.getElementById("oauthSection"),this.#d=e.getElementById("oauthTokenurl"),this.#fo=e.getElementById("oauthClientid"),this.#u=e.getElementById("oauthClientsecret"),this.#m=e.getElementById("oauthScope"),this.#p=e.getElementById("oauthGranttype"),this.#yo=e.getElementById("oauthCredentialsHeader"),this.#vo=e.getElementById("oauthCredentialsBody"),this.#wo=e.querySelector("m2-confirm"),this.#wo.onValidate=this.deleteConfirm,e.getElementById("formOk").onclick=this.formOkClick,e.getElementById("formCancel").onclick=this.formCancelClick,this.#xo=e.getElementById("formDelete"),this.#xo.onclick=this.formDeleteClick}static get observedAttributes(){return["data-title"]}attributeChangedCallback(e,t,o){"data-title"===e&&this.#lo.setAttribute("data-title",o)}appDialogClose=e=>{this.onCancel(e),e.preventDefault(),e.stopPropagation()};formOkClick=e=>{this.checkValidity()&&this.onOk(e)&&(this.hidden=!0)};formCancelClick=e=>{this.onCancel(e)};formDeleteClick=()=>{this.#wo.hidden=!1};deleteConfirm=e=>{this.onDelete(e),this.hidden=!0};mainKeyDown=e=>{["Enter","NumpadEnter"].includes(e.code)&&this.checkValidity()&&this.onOk(e)&&(this.hidden=!0)};authMethodChange=()=>{const e=this.#mt.querySelector("input[name='authMethod']:checked").value;this.#mo.hidden="API Key"!==e,this.#go.hidden="Basic"!==e,this.#bo.hidden="OAuth 2"!==e};#_o=e=>{this.hidden=!0};get onOk(){return this.#_o}set onOk(e){this.#_o=e}#ko=e=>{this.hidden=!0};get onCancel(){return this.#ko}set onCancel(e){this.#ko=e}#Co=()=>{this.hidden=!0};get onDelete(){return this.#Co}set onDelete(e){this.#Co=e}checkValidity=()=>{if(e(this.#co)&&e(this.#r))switch(this.#mt.querySelector("input[name='authMethod']:checked")){case this.#do:return!0;case this.#ho:return e(this.#a)&&e(this.#n);case this.#uo:return e(this.#l)&&e(this.#c);case this.#po:return e(this.#d)&&e(this.#fo)&&e(this.#u)&&e(this.#p)}return!1;function e(e){return!!e.checkValidity()||(e.focus(!0),!1)}};get value(){const e=this.#mt.querySelector("input[name='authMethod']:checked"),t={serverCode:this.#co.value,url:this.#r.value,auth:{method:"noauth",setup:{}}};switch(e){case this.#ho:t.auth.method="apikey",t.auth.setup.key=this.#a.value,t.auth.setup.value=this.#n.value;break;case this.#uo:t.auth.method="basic",t.auth.setup.username=this.#l.value,t.auth.setup.password=this.#c.value;break;case this.#po:t.auth.method="oauth2",t.auth.setup.access_token_url=this.#d.value,t.auth.setup.client_id=this.#fo.value,t.auth.setup.client_secret=this.#u.value,t.auth.setup.scope=this.#m.value,t.auth.setup.grant_type=this.#p.value,t.auth.setup.credentials=this.#mt.querySelector("input[name='oauthCredentials']:checked")?.value}return t}set value({serverCode:e,server:t}){e?(this.#lo.setAttribute("data-title",e),this.#xo.hidden=!1):(this.#lo.setAttribute("data-title","New"),this.#xo.hidden=!0),this.clear(),this.#co.value=e;const o=new ServerConfiguration.A(t);switch(this.#r.value=o.url,o.method){case"apikey":this.#ho.checked=!0,this.#a.value=o.apiKey,this.#n.value=o.apiValue;break;case"basic":this.#uo.checked=!0,this.#l.value=o.basicUsername,this.#c.value=o.basicPassword;break;case"oauth2":this.#po.checked=!0,this.#d.value=o.oauthTokenUrl,this.#fo.value=o.oauthClientId,this.#u.value=o.oauthClientSecret,this.#m.value=o.oauthScope,this.#p.value=o.oauthGrantType,o.oauthCredentials===ServerConfiguration.A.CREDENTIALS.Body?this.#vo.checked=!0:this.#yo.checked=!0;break;default:this.#do.checked=!0}this.authMethodChange()}clear(){this.#mt.querySelectorAll("m2-textfield").forEach((e=>{e.value=""})),this.#p.value="client_credentials"}}customElements.define("server-form",ServerForm);var ServerList_code="<style>main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}</style> <main> <m2-list></m2-list> </main>";const templates_ServerList=ServerList_code;class ServerList extends HTMLElement{#L;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ServerList,this.onclick=()=>{},this.#L=e.querySelector("m2-list"),this.#L.onclick=this.#ct}#ct=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("m2-list-row");t&&this.onclick(t.dataset.id)};load(e){this.#L.clear(),this.#L.append(...Object.keys(e).sort(((e,t)=>e.localeCompare(t))).map((t=>{const o=new M2ListRow;return o.setAttribute("data-id",t),o.appendChild(new M2ListItem.A(void 0,t,e[t].url)),o})))}get value(){return this.#L.querySelector("m2-list-row[selected]")?.dataset.id}set value(e){this.#L.querySelector("m2-list-row[selected]")?.removeAttribute("selected");const t=this.#L.querySelector(`m2-list-row[data-id="${e}"]`);t&&(t.setAttribute("selected","true"),t.scrollIntoView())}}customElements.define("server-list",ServerList);class ServerDialog extends HTMLElement{#L;#lo;#So;#Eo;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ServerDialog,this.#Eo=!1,this.#L=e.querySelector("server-list"),this.#L.onclick=this.#To,this.#So=e.querySelector("server-form"),this.#So.onOk=this.#Mo,this.#So.onDelete=this.#Ao,this.#lo=e.querySelector("m2-dialog"),this.#lo.onClose=e=>{e.preventDefault(),e.stopPropagation(),this.#Se()},e.getElementById("setupAdd").onclick=this.#Lo,e.getElementById("setupCancel").onclick=this.#Do,e.getElementById("setupSave").onclick=this.#Ro,e.getElementById("setupClose").onclick=this.#Se,e.getElementById("setupToggle").onclick=()=>{this.editMode=!0}}connectedCallback(){this.editMode=!1,this.#Bo()}#Bo=()=>{Settings.getAll().then((e=>{this._conf=e,this.#L.load(e),this.#L.value=Context.A.server?.serverCode}))};#Ro=()=>{Settings.setAll(this._conf),this.editMode=!1,this.#Bo()};#Do=()=>{this.editMode=!1,this.#Bo()};#Lo=()=>{this.value="",this.#So.value={serverCode:"",server:{url:""}},this.#So.hidden=!1};#To=e=>{const t=this._conf[e];this.editMode?(this.#So.value={serverCode:e,server:t},this.#So.hidden=!1):(this.editMode=!1,this.hidden=!0,this.#Io({code:e,configuration:t}))};#Io=()=>{};get onSelect(){return this.#Io}set onSelect(e){this.#Io=e}#Ao=()=>{const e=this.#So.value.serverCode;return delete this._conf[e],this.#L.load(this._conf),!0};#Mo=()=>{const e=this.#So.value,t=this.value,o=e.serverCode;if(delete e.serverCode,t)delete this._conf[t];else if(this._conf[o])return Snackbar.A.error("this configuration already exists"),!1;return this._conf[o]=e,this.#L.load(this._conf),!0};#Se=()=>{this.editMode=!1,this.hidden=!0};get value(){return this.#L.value}set value(e){this.#L.value=e}get editMode(){return this.#Eo}set editMode(e){this.#Eo=e,e?this.#lo.classList.add("edit"):this.#lo.classList.remove("edit")}}customElements.define("server-dialog",ServerDialog);var ServerPanel_code='<style>main{display:flex;flex-direction:column;height:100%}header{padding:1em;display:flex;align-items:center}m2-tabs{flex:1 1 auto}m2-tabs>section{border-top:1px solid var(--border-color)}</style> <main> <header> <m2-avatar data-icon="database"></m2-avatar> <m2-list-item id="serverTitle"></m2-list-item> </header> <m2-tabs> <section data-caption="Resource Types"> <server-resources></server-resources> </section> <section data-caption="Details"> <server-capabilities></server-capabilities> </section> </m2-tabs> </main>';const templates_ServerPanel=ServerPanel_code;var M2Avatar_code='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{border-radius:50%;background-color:var(--border-color);padding:8px}</style> <main class="material-symbols-sharp"></main>';const templates_M2Avatar=M2Avatar_code;class M2Avatar extends HTMLElement{#b;constructor(e){super();const t=this.attachShadow({mode:"closed"});t.innerHTML=templates_M2Avatar,this.#b=t.querySelector("main"),e&&(this.icon=e)}static get observedAttributes(){return["data-icon"]}attributeChangedCallback(e,t,o){"data-icon"===e&&(this.#b.innerText=o)}get icon(){return this.getAttribute("data-icon")}set icon(e){this.setAttribute("data-icon",e)}}window.customElements.define("m2-avatar",M2Avatar);var ServerCapabilities_code="<style>main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}m2-list>*{cursor:default}</style> <main> <m2-list></m2-list> </main>";const templates_ServerCapabilities=ServerCapabilities_code;class ServerCapabilities extends HTMLElement{#L;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ServerCapabilities,this.#L=e.querySelector("m2-list")}load=e=>{const t=(e,t)=>{if(void 0===t)return;const o=new M2ListRow;o.append(new M2ListItem.A(void 0,e,t)),this.#L.append(o)};this.#L.clear(),t("copyright",e.copyright),t("description",e.description),t("fhirVersion",`${e.fhirVersion} (${Context.A.server.release})`);const o=document.createElement("UL");o.append(...e.format.map((e=>{const t=document.createElement("LI");return t.innerText=e,t}))),t("format",o.outerHTML),e.implementation&&(t("implementation description",e.implementation.description),t("implementation name",e.implementation.name),t("implementation url",e.implementation.url)),t("language",e.language),t("name",e.name),t("publisher",e.publisher),e.software&&(t("software name",e.software.name),t("software version",e.software.version),t("software release date",e.software.releaseDate))}}customElements.define("server-capabilities",ServerCapabilities);var ServerResources_code="<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}main{display:flex;flex-direction:column;height:100%}span{display:block;padding:.5em 1em;color:var(--text-color);font-size:smaller}hr{border-color:var(--border-color)}m2-list{flex:1 1 auto;height:0}</style> <main> <m2-list></m2-list> </main>";const templates_ServerResources=ServerResources_code;var M2Badge_code="<style>main{padding:.1em .5em;border-radius:1em;white-space:nowrap;color:var(--text-color-normal);background-color:inherit;border:1px solid var(--border-color);text-decoration:none;text-align:center;font-size:x-small;display:inline-block;min-width:2.4em}</style> <main></main>";const templates_M2Badge=M2Badge_code;class M2Badge extends HTMLElement{#mt=null;#Po=null;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_M2Badge,this.#mt=e.querySelector("main"),this.#Po=null}connectedCallback(){this.#Ho()}#Ho=()=>{if(!this.#mt)return;if(null==this.#Po||void 0===this.#Po||0===this.#Po.length)return this.#mt.innerText="?",void(this.title=this.#Po);const e=function(e,t=0){const o=[{suffix:"T",threshold:1e12},{suffix:"B",threshold:1e9},{suffix:"M",threshold:1e6},{suffix:"K",threshold:1e3},{suffix:"",threshold:1}].find((t=>Math.abs(e)>=t.threshold));return o?(e/o.threshold).toFixed(t)+o.suffix:e}(this.#Po);this.#mt.innerText=e,this.title=this.#Po!==e?this.#Po:""};get value(){return this.#Po}set value(e){this.#Po=e,this.#Ho()}}window.customElements.define("m2-badge",M2Badge);var Favorites=__webpack_require__(508);class ServerResources extends HTMLElement{#L;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ServerResources,this.#L=e.querySelector("m2-list"),this.#L.onFilter=this.#Ce,this.#L.onclick=this.#ct}load=e=>{this.#L.clear();const t=Favorites.A.favorites,o=[];if(o.push(...e.rest[0].resource.filter((e=>t.includes(e.type))).map((e=>e.type))),0!==o.length){let e=document.createElement("span");Object.assign(e,{inert:!0,innerText:"Favorites"}),this.#L.append(e),o.sort(((e,t)=>e.localeCompare(t,void 0,{sensitivity:"base"}))),this.#L.append(...o.map((e=>this.#Oo(e))));const t=document.createElement("hr");t.inert=!0,this.#L.append(t),e=document.createElement("span"),Object.assign(e,{inert:!0,innerText:"Other resources"}),this.#L.append(e)}this.#L.append(...e.rest[0].resource.filter((e=>e.interaction?.some((({code:e})=>"search-type"===e)))).filter((e=>!o.includes(e.type))).sort(((e,t)=>e.type.localeCompare(t.type,void 0,{sensitivity:"base"}))).map((e=>this.#Oo(e.type))))};get value(){return this.#L.querySelector("m2-list-row[selected]").dataset.type}set value(e){this.#qo(this.#L.querySelector(`m2-list-row[data-type="${e}"]`))}#Oo=e=>{const t=new M2ListRow;return t.setAttribute("data-type",e),t.append(new M2ListItem.A(fhirIconSet[e.toLowerCase()]||"unknown_med",e)),t};#ct=({target:e})=>{const t=e.closest("m2-list-row");t&&(this.#L.querySelector("m2-list-row[selected]")?.removeAttribute("selected"),t.setAttribute("selected",""),location.hash=`#/${t.dataset.type}?_summary=true&_format=json&_sort=-_lastUpdated`)};#Ce=({value:e,caseSensitive:t})=>{const o=new RegExp(e,t?"":"i");this.#L.querySelectorAll("m2-list-row").forEach((e=>{e.hidden=!o.exec(e.dataset.type)})),this.#L.querySelector("m2-list-row[selected]")?.scrollIntoView()};#qo=e=>{const t=this.#L.querySelector("m2-list-row[selected]");if("m2-list-row"!==e?.localName)return t?.removeAttribute("selected"),void(this.#L.scrollTop=0);e!==t&&(t?.removeAttribute("selected"),e.setAttribute("selected",""),e.scrollIntoView());const o=e.querySelector("m2-list-item");let r=o.querySelector('m2-badge[slot="trailling"]');r||(r=this.#$o("..."),o.append(r),this.#Vo(e.dataset.type).then((({total:e})=>{r.value=e})))};#Vo=async e=>{const t=new URL(`${Context.A.server.url}/${e}`);return t.searchParams.set("_summary","count"),t.searchParams.set("_format","json"),(await fetch(t,{headers:Context.A.server.headers})).json()};#$o=e=>{const t=new M2Badge;return t.slot="trailling",t.value=void 0===e?"?":e,t}}customElements.define("server-resources",ServerResources);class ServerPanel extends HTMLElement{#jo;#Fo;#Uo;#Wt;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_ServerPanel,this.#jo=e.getElementById("serverTitle"),this.#Wt=e.querySelector("m2-tabs"),this.#Fo=e.querySelector("server-resources"),this.#Uo=e.querySelector("server-capabilities"),Favorites.A.addListener(this.#le)}connectedCallback(){Context.A.addListener(this.#No),Favorites.A.addListener(this.#le)}#No=()=>{const e=Context.A.server;this.#jo.setAttribute("data-primary",e.serverCode),this.#jo.setAttribute("data-secondary",e.capabilities?.implementation?.description||e.capabilities?.software?.name||e.url),this.#Fo.load(e.capabilities),this.#Uo.load(e.capabilities)};#le=()=>{const e=this.#Fo.value;this.#Fo.load(Context.A.server.capabilities),this.value=e};set value(e){this.#Wt.value="Resource Types",this.#Fo.value=e}}customElements.define("server-panel",ServerPanel),"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js");class App extends HTMLElement{#Ko;#zo;#Wo;#Go;#Jo;#Xo;#Yo;#he;#Zo;constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML=templates_App,Context.A.appContainer=e,this.#Jo=e.querySelector("server-panel"),this.#he=e.getElementById("bdy"),this.#Go=e.getElementById("navigation"),this.#Go.onclick=()=>this.#Jo.classList.toggle("hidden"),this.#Zo=e.querySelector("m2-waiting"),this.#Ko=e.querySelector("server-dialog"),this.#Ko.onSelect=this.#Qo,e.getElementById("serverDialogToggle").onclick=()=>{this.#Ko.value=Context.A.server?.serverCode,this.#Ko.hidden=!1},e.getElementById("aboutDialogToggle").onclick=this.#er,this.#Xo=e.querySelector("fhir-bundle"),this.#Yo=e.querySelector("fhir-resource"),this.#Wo=e.querySelector("fhir-operation-outcome")}#er=()=>{this.#zo?this.#zo.hidden=!1:(this.#zo=new AboutDialog,Context.A.appContainer.appendChild(this.#zo))};#tr=async e=>{Snackbar.A.clear();const t=setTimeout((()=>{this.#Zo.show()}),500);try{const t=await Context.A.server.fetchHash(e),o=t.headers.get("Content-Type");if(!t.ok){const e=`${t.status} ${t.statusText}`;if(!o)throw new Error(e);Snackbar.A.error(e)}let r,i;if(this.#he.style.visibility="visible",o?.includes("json"))i=await t.json(),r=i.resourceType;else if(o?.includes("xml"))i=(new DOMParser).parseFromString(await t.text(),"application/xml"),r=i.documentElement.nodeName;else{i=await t.text();const e=i.match(/rdf:type\s+fhir:(\w+)/);e&&(r=e[1])}if(!r)throw new Error("Unknown response format");"OperationOutcome"===r?(this.#Xo.hidden=!0,this.#Yo.hidden=!0,this.#Wo.hidden=!1,this.#Wo.source=i):"Bundle"===r?(this.#Xo.hidden=!1,this.#Yo.hidden=!0,this.#Wo.hidden=!0,this.#Xo.source=i,this.#Jo.value=this.#Xo.resourceType):(this.#Xo.hidden=!0,this.#Yo.hidden=!1,this.#Wo.hidden=!0,this.#Yo.source=i,this.#Jo.value=this.#Yo.resourceType)}catch(e){Snackbar.A.error(e)}finally{clearTimeout(t),this.#Zo.hide()}};#or=()=>{const e=window.location.hash.replace("#","").trim();e.length?(window.matchMedia("(max-width: 480px)").matches&&this.#Jo.classList.add("hidden"),this.#tr(e)):(this.#Jo.value="",this.#he.style.visibility="hidden",this.#Jo.classList.remove("hidden"))};connectedCallback(){window.addEventListener("hashchange",this.#or);const e=Preferences.A.get("server");e?Settings.get(e).then((t=>{this.#Qo({code:e,configuration:t})})):this.#Ko.hidden=!1}#Qo=({code:e,configuration:t})=>{this.#Zo.show();const o=new ServerConfiguration.A(t),r=new Server.A(e,o);r.connect().then((()=>{Context.A.server=r,Snackbar.A.info(`Connected to "${e}" server.`),Preferences.A.set("server",e),this.#Go.hidden=!1,location.hash?location.hash="":this.#or()})).catch((t=>{Snackbar.A.error(`An error occurred while connecting to the server "${e}"`),console.log(t)})).finally((()=>{this.#Zo.hide()}))}}customElements.define("fhir-browser",App)})();