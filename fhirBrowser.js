(()=>{"use strict";var __webpack_modules__={541:(e,t,i)=>{i.d(t,{Z:()=>s});var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link href="'+o()(a)+'" rel="stylesheet"/> <style>#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}#bundleCnt{display:flex;flex-direction:column;height:100%;flex:auto;width:0}main{flex:1 1 auto;height:0;border-top:1px solid var(--border-color);border-bottom:1px solid var(--border-color)}#title{margin:0;overflow:hidden;text-overflow:ellipsis}linear-progress{position:relative;top:0}#table{flex:auto}fhir-search{border-left:1px solid var(--border-color);flex:none;transition:all .3s;width:400px}fhir-search.hidden{transition:all .3s;margin-right:-400px}@media (max-width:480px){fhir-search{background-color:var(--background-color,#fff);position:relative;width:100%}fhir-search.hidden{margin-right:-100%}}</style> <div id="wrapper"> <div id="bundleCnt"> <header> <app-bar> <round-button id="help" title="Help" data-icon="help" slot="left"></round-button> <h3 slot="middle" id="title"></h3> <div class="toolbar" slot="right"> <round-button id="settingsDialogToggle" title="Settings" data-icon="view_column"></round-button> <round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></round-button> <round-button id="download" title="Download" data-icon="download"></round-button> <round-button id="searchToggle" title="Search" data-icon="search"></round-button> </div> </app-bar> <linear-progress></linear-progress> </header> <main> <data-table id="table"></data-table> </main> <footer> <data-table-pagination id="pagination"> <div slot="rows"><span id="paginationRange"></span> of <span id="paginationCount"></span></div> <round-button slot="arrows" id="paginationFirst" title="first" data-icon="first_page" disabled="disabled"></round-button> <round-button slot="arrows" id="paginationPrevious" title="previous" data-icon="chevron_left" disabled="disabled"></round-button> <round-button slot="arrows" id="paginationNext" title="next" data-icon="chevron_right" disabled="disabled"></round-button> <round-button slot="arrows" id="paginationLast" title="last" data-icon="last_page" disabled="disabled"/> </data-table-pagination> </footer> </div> <fhir-search id="search" class="hidden"></fhir-search> </div> <fhir-bundle-columns id="columnsSelector" hidden></fhir-bundle-columns>'},237:(e,t,i)=>{i.d(t,{Z:()=>r});const r='<style>main{display:flex;flex-direction:column;height:100%}main>section{flex:1 1 auto;height:0}main>footer{border-top:1px solid var(--border-color);padding:9px 16px;text-align:center;overflow:hidden}main #dragZone{display:flex;flex-direction:row;height:100%}#form{flex:1 1 auto;height:auto;padding:1em;overflow-y:auto;padding-bottom:7em}#form fieldset{border:0;padding:0}#form fieldset>input[type=text]{border:0 none;font-family:inherit;font-size:inherit;margin-bottom:1em;background-color:inherit}#form section{display:flex;flex-flow:row wrap;align-content:flex-start;gap:.2em 1em;border:0 none;background-color:inherit;min-height:50px}#form section.over,#form text-field.over,#form.drag fieldset.over,#form.drag.over{border:1px dashed #000;background-color:var(--hover-color,rgb(0 0 0 / 4%))}side-panel{border-left:1px solid var(--border-color)}</style> <main> <section> <section id="dragZone"> <section id="form"></section> <side-panel data-title="Data"> <linear-progress slot="main"></linear-progress> <app-list slot="main"></app-list> </side-panel> </section> </section> <footer> <app-button id="formCancel" value="Cancel"></app-button> <app-button id="formOk" value="Apply"></app-button> </footer> </main>'},91:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},759:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _templates_fhirBundle_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(541),_components_AppBar__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(856),_components_DataTable__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(699),_components_DataTablePagination__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(39),_components_LinearProgress__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(196),_FhirSearch__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(421),_FhirBundleColumns__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(346),_services_Fhir__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(916),_services_Snackbars__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(332),_services_Preferences__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(571);class FhirBundle extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_templates_fhirBundle_html__WEBPACK_IMPORTED_MODULE_0__.Z,this._resourceType=null,this._skip=0,this._pageSize=20,this._count=null,this._columns=null,this._filters=[],this._page=null,this._dateOptions={year:"numeric",month:"2-digit",day:"2-digit"},this._timeOptions={hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"},this._columnsSelector=null}connectedCallback(){this._shadow.getElementById("help").onclick=this.helpClick,this._shadow.querySelector("data-table-pagination").onclick=this.paginationClick;const e=this._shadow.getElementById("table");e.addEventListener("rowclick",(({detail:e})=>{location.hash=`#${this._resourceType.type}/${e.resourceId}`})),e.onColumnReorder=this.handleColumnChanged,this._shadow.getElementById("searchToggle").addEventListener("click",(()=>{this._shadow.getElementById("search")?.classList.toggle("hidden")})),this._shadow.getElementById("copy").onclick=this.copyClick,this._shadow.getElementById("download").onclick=this.downloadClick,this._columnsSelector=this._shadow.querySelector("fhir-bundle-columns"),this._columnsSelector.onValidate=this.handleColumnSetup,this._shadow.getElementById("settingsDialogToggle").onclick=this.settingsDialogToggleClick}handleColumnSetup=e=>{let t=this._columns.filter((t=>e.includes(t)));t.push(...e.filter((e=>!t.includes(e)))),this.handleColumnChanged(t)};handleColumnChanged=e=>{this._columns=e;const t=this._shadow.getElementById("table");t.clear(),this._columns.forEach((e=>t.addColumn(e))),this.loadPage();const i=_services_Preferences__WEBPACK_IMPORTED_MODULE_9__.y.get("columns",{});i[this._resourceType.type]=this._columns,_services_Preferences__WEBPACK_IMPORTED_MODULE_9__.y.set("columns",i)};settingsDialogToggleClick=()=>{this._columnsSelector.load(this._resourceType.type,this._columns),this._columnsSelector.hidden=!1};paginationClick=({target:e})=>{e.matches("round-button")&&this.loadPage(e.dataset)};helpClick=()=>{window.open(_services_Fhir__WEBPACK_IMPORTED_MODULE_7__.t.helpUrl(this._resourceType.type),"FhirBrowserHelp")};copyClick=()=>{navigator.clipboard.writeText(JSON.stringify(this._page)).then((function(){_services_Snackbars__WEBPACK_IMPORTED_MODULE_8__.h.show("Copying to clipboard was successful")}),(function(e){console.error("Async: Could not copy text: ",e)}))};downloadClick=()=>{const e=`${this._resourceType.type}-${this._skip}`,t=new File([JSON.stringify(this._page)],e,{type:"data:text/json;charset=utf-8"}),i=URL.createObjectURL(t),r=document.createElement("a");r.href=i,r.download=`${e}.json`,this._shadow.appendChild(r),r.click(),this._shadow.removeChild(r),window.URL.revokeObjectURL(i)};load(e,t=[]){if(e===this._resourceType&&JSON.stringify(this._filters)===JSON.stringify(t))return;window.matchMedia("(max-width: 480px)").matches&&this._shadow.getElementById("search")?.classList.add("hidden"),this._resourceType=e,this._filters=t;const i=_services_Preferences__WEBPACK_IMPORTED_MODULE_9__.y.get("columns",{});this._columns=i[e.type]||["id","meta.lastUpdated"],this._columnsSelector.hidden=!0,this._shadow.getElementById("title").innerText=e.type;const r=this._shadow.getElementById("table");r.clear(),this._columns.forEach((e=>{r.addColumn(e)})),this.loadPage()}get resourceType(){return this._resourceType}loadPage(e={url:`${_services_Fhir__WEBPACK_IMPORTED_MODULE_7__.t.server.url}/${this._resourceType.type}?_count=${this._pageSize}`}){switch(e.relation){case"previous":this._skip-=this._pageSize;break;case"next":this._skip+=this._pageSize;break;case"last":this._skip=Math.floor(this._count/this._pageSize)*this._pageSize;break;default:this._skip=0}this._shadow.getElementById("table").removeAll();const t=this._shadow.querySelector("linear-progress");t.style.visibility="visible",_services_Fhir__WEBPACK_IMPORTED_MODULE_7__.t.searchByLink(e.url,this._filters).then((i=>{this._page=i,this.parsePage(i),t.style.visibility="hidden",void 0===e.relation?i.total?(this._count=i.total,this.fillPaginationRange(),this._shadow.getElementById("paginationCount").innerHTML=this._count):this.getCount():this.fillPaginationRange()})).catch((e=>{_services_Snackbars__WEBPACK_IMPORTED_MODULE_8__.h.show("An error occurred while searching",void 0,void 0,"error")}))}getCount(){const e=this._shadow.getElementById("paginationCount");e.innerHTML="<circular-progress></circular-progress>",_services_Fhir__WEBPACK_IMPORTED_MODULE_7__.t.searchCount(this._resourceType.type,this._filters).then((({total:t})=>{this._count=t,this.fillPaginationRange(),e.innerHTML=t?.toLocaleString()||"Unkown"}))}fillPaginationRange(){const e=this._shadow.getElementById("paginationRange");let t="0";void 0===this._count?t=`${this._skip+1}-${this._skip+this._pageSize}`:0!=this._count&&(t=`${this._skip+1}-${Math.min(this._skip+this._pageSize,this._count)}`),e.innerText=t}beautifyDate(e){const t=new Date(e);try{return`${t.toLocaleString(void 0,this._dateOptions)}<br>${t.toLocaleString(void 0,this._timeOptions)}`}catch(t){return e}}parsePage(data){if(data.entry){const dataTable=this._shadow.getElementById("table");data.entry.filter((e=>this._resourceType.type===e?.resource?.resourceType)).forEach((entry=>{let row={};this._columns.forEach((column=>{let value=entry.resource,path=column.split(".");path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx==path.length-1?value.join(", "):value[0]),!0)))),"meta.lastUpdated"===column&&(value=this.beautifyDate(value)),row[column]=value||""})),dataTable.addRow(entry.resource.id,row)}));const buttons={first:this._shadow.getElementById("paginationFirst"),previous:this._shadow.getElementById("paginationPrevious"),next:this._shadow.getElementById("paginationNext"),last:this._shadow.getElementById("paginationLast")};for(const[e,t]of Object.entries(buttons))t.setAttribute("disabled",""),t.removeAttribute("data-relation"),t.removeAttribute("data-url");let button=null;data.link.forEach((e=>{const t="prev"===e.relation?"previous":e.relation;(button=buttons[t])&&(button.removeAttribute("disabled"),button.setAttribute("data-relation",t),button.setAttribute("data-url",e.url))}))}}}customElements.define("fhir-bundle",FhirBundle)},346:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link rel="stylesheet" href="'+o()(a)+'"> <style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}#actions{border-top:1px solid var(--border-color);padding:.5em 1em;text-align:right;overflow:hidden}</style> <app-dialog id="settingsDialog" data-title="Settings"> <main> <linear-progress></linear-progress> <app-list></app-list> <section id="actions"> <app-button id="btnCancel" value="Cancel"></app-button> <app-button id="btnOk" value="Apply"></app-button> </section> </main> </app-dialog>';i(627),i(937),i(251),i(196),i(72);class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{padding:.5em 1em;background-color:inherit;display:flex;flex-direction:row;align-items:center}main:hover,main[selected]{background-color:var(--hover-color,rgba(0,0,0,5%))}div{flex-grow:1}input[type=checkbox]{margin-left:1em}</style> <main> <div> <slot></slot> </div> <input type="checkbox"> </main>'}static get observedAttributes(){return["selected"]}attributeChangedCallback(e,t,i){"selected"===e&&(this._shadow.querySelector("input[type=checkbox]").checked=null!==i)}connectedCallback(){this.onclick=e=>{null!==this.getAttribute("selected")?this.removeAttribute("selected"):this.setAttribute("selected","")}}}customElements.define("list-row-check",n);var l=i(916);class d extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s,this._resourceType=null,this._release=null,this._onValidate=()=>{},this._list=null}connectedCallback(){this._shadow.querySelector("app-dialog").onClose=this.appDialogClose,this._list=this._shadow.querySelector("app-list"),this._list.onFilter=this.appListFilter,this._shadow.getElementById("btnCancel").onclick=this.btnCancelClick,this._shadow.getElementById("btnOk").onclick=this.btnOkClick}btnOkClick=e=>{e.preventDefault(),e.stopPropagation(),this.hidden=!0;const t=Array.from(this._list.querySelectorAll("list-row-check[selected]")).map((e=>e.dataset.id));this._onValidate(t)};btnCancelClick=()=>{this.hidden=!0};appListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!e.dataset.id.toLowerCase().includes(t)}))};appDialogClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};get onValidate(){return this._onValidate}set onValidate(e){this._onValidate=e}checkValues=e=>{Array.from(this._list.querySelectorAll("list-row-check")).forEach((t=>{e.includes(t.dataset.id)?t.setAttribute("selected",""):t.removeAttribute("selected")}))};load=(e,t)=>{e!==this._resourceType||l.t.release!==this._release?(this._resourceType=e,this._release=l.t.release,this._list.clear(),this._shadow.querySelector("linear-progress").hidden=!1,function e(t,i){return new Promise((r=>{const o=[];l.t.structureDefinition(t).then((t=>{const a=[];t.snapshot.element.filter((e=>e.isSummary&&e.type)).forEach((t=>{const r=t.path.substr(t.path.indexOf(".")+1);if(!i.includes(`${r}.`)){const s=(i?`${i}.`:"")+r,n=t.type[0].code;n.match(/^([A-Z][a-z]+)+$/)?a.push(e(n,s)):o.push({id:s,path:s,short:t.short,type:n})}})),a.length>0?Promise.all(a).then((e=>{e.forEach((e=>o.push(...e))),r(o)})):r(o)}))}))}(e,"").then((e=>{e.sort(((e,t)=>e.path.localeCompare(t.path))),e.forEach((e=>{const t=document.createElement("list-item");t.setAttribute("data-primary",e.path),t.setAttribute("data-secondary",e.short);const i=document.createElement("list-row-check");i.setAttribute("data-id",e.id),i.appendChild(t),this._list.appendChild(i)})),this._shadow.querySelector("linear-progress").hidden=!0,this.checkValues(t)}))):this.checkValues(t)}}customElements.define("fhir-bundle-columns",d)},85:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _templates_fhirResourceFormEditor_html__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(237),_components_AppList__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(251),_components_SidePanel__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(59),_components_TextField__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(719),_services_Fhir__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(916);class FhirResourceForm extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_templates_fhirResourceFormEditor_html__WEBPACK_IMPORTED_MODULE_4__.Z,this._resource=null,this._dragSrcEl=null,this._form=null}connectedCallback(){this._form=this._shadow.getElementById("form");const e=this._shadow.getElementById("dragZone");e.ondragstart=this.onDragStart,e.ondragover=this.onDragOver,e.ondragenter=this.onDragEnter,e.ondragleave=this.onDragLeave,e.ondragend=this.onDragEnd,e.ondrop=this.onDragDrop,this._list=this._shadow.querySelector("app-list"),this._list.onFilter=this.dataListFilter,this._shadow.querySelector("side-panel").onClose=this.dataPanelClose}dataPanelClose=()=>{this._shadow.querySelector("side-panel").hidden=!0};dataListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!e.dataset.id.toLowerCase().includes(t)}))};clear=()=>{for(;this._form.firstChild;)this._form.removeChild(this._form.lastChild)};buildTemplate=e=>{this.clear(),e.forEach((e=>{const t=this.createFieldset(e.label);e.row.forEach((e=>{const i=this.createSection();e.forEach((e=>{i.appendChild(this.createField(e.name,e.placeholder))})),t.appendChild(i)})),this._form.appendChild(t)}))};createFieldset=(e="unamed")=>{const t=document.createElement("fieldset");t.setAttribute("draggable","true");const i=document.createElement("input");return i.setAttribute("spellcheck","false"),i.type="text",i.classList.add("label"),i.value=e,t.appendChild(i),t};createSection=()=>{const e=document.createElement("section");return e.setAttribute("draggable","true"),e};createField=(e,t)=>{const i=document.createElement("text-field");return i.id=e,i.setAttribute("placeholder",t),i.setAttribute("readonly",""),i.setAttribute("draggable","true"),i};setValues=e=>{Array.from(this._shadow.querySelectorAll("text-field")).forEach((t=>{let i="";t.id&&(i=this.calcValue(e,t.id)),t.setAttribute("value",i)}))};calcValue=(resource,id)=>{let value=resource;const path=id.split(".");return path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx==path.length-1?value.join(", "):value[0]),!0)))),value};set source(e){if(e.resourceType!=this._resource?.resourceType){this.load(e.resourceType);const t=JSON.parse(localStorage.getItem("templates")||"{}")[e.resourceType];t&&(this.buildTemplate(t),this.cleanEmpty(),this.setValues(e))}this._resource=e}load=e=>{this._list.clear(),this._shadow.querySelector("linear-progress").hidden=!1,function e(t,i){return new Promise((r=>{const o=[];_services_Fhir__WEBPACK_IMPORTED_MODULE_3__.t.structureDefinition(t).then((t=>{const a=[];t.snapshot.element.filter((e=>e.type)).forEach((t=>{const r=t.path.substr(t.path.indexOf(".")+1);if(!i.includes(`${r}.`)){const s=(i?`${i}.`:"")+r,n=t.type[0].code;n.match(/^([A-Z][a-z]+)+$/)?a.push(e(n,s)):o.push({id:s,path:s,short:t.short,type:n})}})),a.length>0?Promise.all(a).then((e=>{e.forEach((e=>o.push(...e))),r(o)})):r(o)}))}))}(e,"").then((e=>{e.sort(((e,t)=>e.path.localeCompare(t.path))),e.forEach((e=>{const t=document.createElement("list-item");t.setAttribute("data-primary",e.path),t.setAttribute("data-secondary",e.short);const i=document.createElement("list-row");i.setAttribute("draggable","true"),i.setAttribute("data-id",e.id),i.appendChild(t),this._list.appendChild(i)})),this._shadow.querySelector("linear-progress").hidden=!0}))};cleanEmpty=()=>{Array.from(this._form.querySelectorAll("section:not(:has(text-field))")).forEach((e=>e.remove())),Array.from(this._form.querySelectorAll("fieldset:not(:has(section))")).forEach((e=>e.remove()))};isDropAvailable=(e,t)=>e!=t&&("form"==t.id||null==t.closest("#form")||"FIELDSET"==e.tagName&&("form"==t.id||"FIELDSET"==t.tagName)||"SECTION"==e.tagName&&("form"==t.id||"FIELDSET"==t.tagName||"SECTION"==t.tagName)||"TEXT-FIELD"==e.tagName&&("form"==t.id||"FIELDSET"==t.tagName||"SECTION"==t.tagName||"TEXT-FIELD"==t.tagName)||"LIST-ROW"==e.tagName&&("form"==t.id||"FIELDSET"==t.tagName||"SECTION"==t.tagName||"TEXT-FIELD"==t.tagName));onDragStart=e=>{this._form.classList.add("drag"),this._dragSrcEl=e.target,this._dragSrcEl.style.opacity="0.4"};onDragEnter=e=>{e.target?.classList.add("over")};onDragLeave=e=>{e.target?.classList.remove("over")};onDragOver=e=>(e.preventDefault(),this.isDropAvailable(this._dragSrcEl,e.target)?e.dataTransfer.dropEffect="move":e.dataTransfer.dropEffect="none",!1);onDragDrop=e=>{e.stopPropagation();let t=e.target,i=this._dragSrcEl;if(this.isDropAvailable(this._dragSrcEl,t)){if(null==t.closest("#form"))this._dragSrcEl.remove();else{if(this._dragSrcEl.parentNode==t.parentNode){const e=Array.from(t.parentNode.childNodes);e.findIndex((e=>e==this._dragSrcEl))<e.findIndex((e=>e==t))&&(t=t.nextSibling)}if("LIST-ROW"==i.tagName){const e=this._dragSrcEl.dataset.id;if(i=this.createField(e,e.split(".").pop()),i.setAttribute("value",this.calcValue(this._resource,e)),"form"==t.id){const e=this.createSection();e.appendChild(i);const r=this.createFieldset();r.appendChild(e),t.appendChild(r)}else if("FIELDSET"==t.tagName){const e=this.createSection();e.appendChild(i),t.appendChild(e)}else"SECTION"==t.tagName?t.appendChild(i):"TEXT-FIELD"==t.tagName&&t.parentNode.insertBefore(i,t)}else if("FIELDSET"==i.tagName)"form"==t.id?t.appendChild(i):"FIELDSET"==t.tagName&&t.parentNode.insertBefore(i,t);else if("SECTION"==i.tagName)if("form"==t.id){const e=this.createFieldset();e.appendChild(i),t.appendChild(e)}else"FIELDSET"==t.tagName?t.appendChild(i):"SECTION"==t.tagName&&t.parentNode.insertBefore(i,t);else if("TEXT-FIELD"==i.tagName)if("form"==t.id){const e=this.createSection();e.appendChild(i);const r=this.createFieldset();r.appendChild(e),t.appendChild(r)}else if("FIELDSET"==t.tagName){const e=this.createSection();e.appendChild(i),t.appendChild(e)}else"SECTION"==t.tagName?t.appendChild(i):"TEXT-FIELD"==t.tagName&&t.parentNode.insertBefore(i,t)}this.cleanEmpty()}return!1};onDragEnd=e=>{this._dragSrcEl.style.opacity="1",this._dragSrcEl=null,this._form.classList.remove("drag"),this._form.querySelectorAll('[class~="over"]').forEach((e=>e.classList.remove("over")))}}customElements.define("fhir-resource-form",FhirResourceForm)},421:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link rel="stylesheet" href="'+o()(a)+'"> <style>section{display:flex;flex-direction:column;height:100%}main{border-bottom:1px solid var(--border-color);padding:.5em;overflow:hidden auto;flex:1 1 auto;height:0}footer{padding:9px 16px;text-align:center;overflow:hidden}@media (max-width:480px){.surface{left:0;right:unset;width:100%;max-width:unset;max-height:unset}.overlay{background-color:transparent}}</style> <side-panel data-title="Search"> <round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></round-button> <round-button id="clear" title="Clear" data-icon="clear_all" slot="appBarRight"></round-button> <section slot="main"> <main></main> <footer> <app-button id="apply" value="Search"></app-button> </footer> </section> </side-panel>';i(914);class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray;display:flex;flex-direction:row;flex-wrap:wrap}main:focus-within,main:focus-within input{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:4px 5px;max-width:120px;min-width:100px}input:focus{outline:0}</style> <main> <input type="date"> <input type="time"> </main>'}get value(){const e=this._shadow.querySelector('input[type="date"]');if(e.value){const t=this._shadow.querySelector('input[type="time"]');let i=new Date(`${e.value}T${t.value||"00:00"}`);return new Date(i.getTime()).toISOString()}return null}set value(e){this._shadow.querySelector('input[type="date"]').value="",this._shadow.querySelector('input[type="time"]').value=""}}customElements.define("fhir-search-date",n);class l extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px;width:90px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input placeholder="Modifier" list="FhirSearchFieldModifierList"> <datalist id="FhirSearchFieldModifierList"> <option value="contains"></option> <option value="exact"></option> </datalist> </main>'}get value(){return this._shadow.querySelector("input").value}set value(e){this._shadow.querySelector("input").value=e}}customElements.define("fhir-search-modifier",l);class d extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px;width:90px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input placeholder="Prefix" list="FhirSearchPrefixList"> <datalist id="FhirSearchPrefixList"> <option value="eq">Is equal to</option> <option value="ne">is not equal to</option> <option value="gt">is greater than</option> <option value="lt">is less than</option> <option value="ge">is greater or equal to</option> <option value="le">is less or equal to</option> </datalist> </main>'}get value(){return this._shadow.querySelector("input").value}set value(e){this._shadow.querySelector("input").value=e}}customElements.define("fhir-search-prefix",d);class c extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray;display:flex}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input type="text"> </main>'}connectedCallback(){let e=this.getAttribute("placeholder");e&&this._shadow.querySelector("input").setAttribute("placeholder",e)}get value(){return this._shadow.querySelector("input").value}set value(e){this._shadow.querySelector("input").value=e}}customElements.define("fhir-search-text",c);class h extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{margin-bottom:1em}fieldset{display:flex;flex-direction:row;border:none;padding:0;gap:1em}fieldset:focus-within legend{font-weight:700;color:var(--primary-color)}fhir-search-date,fhir-search-text{flex:auto}span{color:var(--text-color-disabled);font-size:small;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;padding-top:2px}</style> <main> <fieldset> <legend inert></legend> <slot></slot> </fieldset> <span inert></span> </main>"}clear(){this._shadow.querySelectorAll("fhir-search-text, fhir-search-date, fhir-search-modifier, fhir-search-prefix").forEach((e=>e.value=""))}set value(e){let t;const i=e.value.split("|"),r=e.name.split(":");switch(this._search.type){case"token":t=this._shadow.querySelector("fhir-search-text:not([data-type])"),i[1]?(this._shadow.querySelector('fhir-search-text[data-type="system"]').value=i[0],t.value=i[1]):t.value=i[0];break;case"string":case"reference":r[1]&&(this._shadow.querySelector("fhir-search-modifier").value=r[1]),t=this._shadow.querySelector("fhir-search-text"),t.value=e.value}}get value(){let e;switch(this._search.type){case"token":let t="";const i=this._shadow.querySelector('fhir-search-text[data-type="system"]');return i?.value&&(t=`${i.value}|`),e=this._shadow.querySelector("fhir-search-text:not([data-type])"),e?.value&&(t+=e.value),t?{name:this._search.name,value:t}:null;case"string":case"reference":if(e=this._shadow.querySelector("fhir-search-text"),e?.value){let t=this._search.name;const i=this._shadow.querySelector("fhir-search-modifier");return i?.value&&(t+=`:${i.value}`),{name:t,value:e.value}}break;case"date":case"datetime":if(e=this._shadow.querySelector("fhir-search-date"),e?.value){let t=e.value;const i=this._shadow.querySelector("fhir-search-prefix");return i?.value&&(t=i.value+t),{name:this._search.name,value:t}}}return null}get name(){return this._search.name}init(e){function t(e,t){let r=document.createElement("fhir-search-text");r.setAttribute("name",e.name),t&&r.setAttribute("placeholder",t),i.appendChild(r)}if("_format"===e.name)return!1;this._search=e,this._shadow.querySelector("legend").innerText=e.name,this._shadow.querySelector("span").innerText=e.documentation||"";const i=this._shadow.querySelector("fieldset");let r;if("_id"==e.name)t(e);else if("_filter"==e.name)t(e);else switch(e.type){case"token":!function(e){let t=document.createElement("fhir-search-text");t.setAttribute("placeholder","System"),t.setAttribute("data-type","system"),t.setAttribute("name",e.name),i.appendChild(t)}(e),t(e,"code");break;case"string":case"reference":!function(e){let t=document.createElement("fhir-search-modifier");t.setAttribute("data-name",e.name),i.appendChild(t)}(e),t(e);break;case"date":case"datetime":r=document.createElement("fhir-search-prefix"),r.setAttribute("data-name",e.name),i.appendChild(r),r=document.createElement("fhir-search-date"),r.setAttribute("name",e.name),i.appendChild(r);break;default:return!1}return!0}}customElements.define("fhir-search-item",h);var u=i(916);class p extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s,this._resourceType=null}connectedCallback(){window.addEventListener("hashchange",this.locationHandler),this._shadow.querySelector("side-panel").onClose=this.sidePanelClose,this._shadow.getElementById("clear").addEventListener("click",this.clearClick),this._shadow.getElementById("help").addEventListener("click",this.helpClick),this._shadow.getElementById("apply").addEventListener("click",this.applyClick),this._shadow.querySelector("main").addEventListener("keydown",this.mainKeyDown),this.locationHandler()}mainKeyDown=e=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||this.applyClick(e)};applyClick=e=>{e.preventDefault(),e.stopPropagation(),window.matchMedia("(max-width: 480px)").matches&&this.classList.add("hidden");const t=[];this._shadow.querySelector("main").querySelectorAll("fhir-search-item").forEach((({value:e})=>{e&&t.push(`${e.name}=${encodeURIComponent(e.value)}`)})),location.hash=`#${this._resourceType.type}`+(t.length?`?${t.join("&")}`:"")};helpClick=e=>{window.open(u.t.helpUrl("search"),"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};clearClick=e=>{this.clear(),e.preventDefault(),e.stopPropagation()};sidePanelClose=e=>{this.classList.add("hidden"),e.preventDefault(),e.stopPropagation()};locationHandler=async()=>{let e=window.location.hash.replace("#","").trim();if(!e||e.indexOf("/")>0)return;const t=e.split("?")[0];if(!t)return;for(;!u.t.server;)await r(1e3);const i=u.t.server.capabilities.rest[0].resource.find((e=>e.type===t));if(i&&(i.type!==this._resourceType?.type&&(this._resourceType=i,this.metadata=i),this.clear(),e.indexOf("?")>0)){let t=e.slice(e.indexOf("?")+1).split("&").map((e=>{const[t,i]=e.split("=");return{name:t,value:decodeURIComponent(i)}}));this.filters=t}function r(e){return new Promise((t=>{setTimeout(t,e)}))}};clear(){this._shadow.querySelector("main").querySelectorAll("fhir-search-item").forEach((e=>e.clear()))}set filters(e){const t=this._shadow.querySelector("main");e.forEach((e=>{const i=e.name.split(":")[0],r=t.querySelector(`fhir-search-item[data-name="${i}"`);r&&(r.value=e)}))}set metadata(e){const t=this._shadow.querySelector("main");for(t.scrollTop=0;t.firstChild;)t.removeChild(t.lastChild);e?.searchParam.sort(((e,t)=>e.name.localeCompare(t.name))).forEach((e=>{const i=document.createElement("fhir-search-item");i.init(e)&&(i.setAttribute("data-name",e.name),t.appendChild(i))}))}}customElements.define("fhir-search",p)},856:()=>{class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML='<style>main{align-items:center;display:flex;flex-direction:row;padding:.5em;flex-wrap:wrap;justify-content:flex-end}#barMiddle{flex-grow:1;margin:0;overflow:hidden;padding-left:.5em;font-size:1.17em;font-weight:700}#barRight{white-space:nowrap}</style> <main> <section id="barLeft"> <slot name="left"></slot> </section> <section id="barMiddle"> <slot name="middle"></slot> </section> <section id="barRight"> <slot name="right"></slot> </section> </main>'}}window.customElements.define("app-bar",e)},627:()=>{class e extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>input[type=button]{background:0 0;border:1px solid transparent;border-radius:4px;color:var(--primary-color);cursor:pointer;font:inherit;padding:5px 16px;text-transform:uppercase}input[type=button]:hover{background-color:var(--hover-color)}</style> <input type="button">'}static get observedAttributes(){return["value"]}attributeChangedCallback(e,t,i){"value"==e&&(this._shadow.querySelector('input[type="button"]').value=i)}}window.customElements.define("app-button",e)},937:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link rel="stylesheet" href="'+o()(a)+'"> <style>main{position:absolute;top:0;left:0;background-color:rgba(0,0,0,32%);min-height:100%;min-width:100%}.surface{background-color:var(--background-color,#fff);border-radius:4px;height:60%;max-width:50%;position:absolute;top:1em;right:1em}.surface.centered{left:50%;right:unset;top:50%;transform:translateX(-50%) translateY(-50%)}.overlay{background-color:rgba(255,255,255,4%);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:Roboto,Arial,monospace;height:100%}#title{margin:.5em 0}#content{overflow:hidden;flex:1 1 auto;height:0}@media (max-width:480px){.surface{top:0;left:0;height:100%;width:100%;max-width:unset}.overlay{background-color:transparent}}</style> <main> <div class="surface"> <div class="overlay"> <section id="header"> <app-bar> <section slot="left"> <slot name="appBarLeft"></slot> </section> <h3 id="title" slot="middle"></h3> <section slot="right"> <slot name="appBarRight"></slot> </section> </app-bar> </section> <section id="content"> <slot></slot> </section> </div> </div> </main>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s,this._onClose=function(){this.hidden=!0}}connectedCallback(){this._shadow.querySelector("main").addEventListener("click",(e=>{this.onClose(e)})),this._shadow.querySelector(".surface").addEventListener("click",(e=>{e.stopPropagation()}))}get onClose(){return this._onClose}set onClose(e){this._onClose=e}static get observedAttributes(){return["data-title","centered"]}attributeChangedCallback(e,t,i){"centered"==e?this._shadow.querySelector(".surface").classList.add("centered"):"data-title"===e&&(this._shadow.getElementById("title").innerText=i)}}window.customElements.define("app-dialog",n)},251:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link href="'+o()(a)+'" rel="stylesheet"/> <style>main{display:flex;flex-direction:column;height:100%}#list{overflow:auto;flex:1 1 auto;height:0}#list>*{cursor:pointer}</style> <main> <list-filter></list-filter> <section id="list"> <slot></slot> </section> </main>';var n=new URL(i(156),i.b);const l='<link href="'+o()(n)+'" rel="stylesheet"/> <style>main{display:flex;padding:.7em;font-size:smaller;border-bottom:1px solid var(--border-color)}main:focus-within{border-bottom-color:var(--primary-color,#000)}#text{background:0 0;border:0 none;color:var(--text-color-normal);flex:1 1 auto;font-family:inherit;font-size:inherit}#text:focus{outline:0}#clear{cursor:pointer;font-size:inherit;line-height:unset}</style> <main> <input id="text" type="text" placeholder="Type to filter" spellcheck="false"/> <i id="clear" class="material-symbols" title="clear">close</i> </main>';class d extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=l,this._onChange=()=>{}}connectedCallback(){const e=this._shadow.getElementById("text");this._shadow.querySelector("main").addEventListener("mousedown",(t=>{e.focus()})),this._shadow.getElementById("clear").addEventListener("click",(()=>{e.value&&(e.value="",this._onChange(e.value))})),e.addEventListener("input",(()=>{this._onChange(e.value)}))}clear(){this._shadow.getElementById("clear").click()}get onChange(){return this._onChange}set onChange(e){this._onChange=e}}customElements.define("list-filter",d);class c extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s,this._list=null,this._slot=null,this._onFilter=null}connectedCallback(){this._list=this._shadow.getElementById("list"),this._slot=this._shadow.querySelector("slot"),this._filter=this._shadow.querySelector("list-filter"),this._filter.hidden=this._slot.children.length<=10,this._slot.addEventListener("slotchange",(()=>{this._filter.hidden="function"!=typeof this._onFilter||this._slot.assignedNodes().length<=10})),this._filter.onChange=e=>{"function"==typeof this._onFilter&&(""==e&&(this._list.scrollTop=0),this._onFilter(e))}}clear=()=>{this._slot.assignedNodes().forEach((e=>this.removeChild(e))),this._filter.clear(),this._list.scrollTop=0};get onFilter(){return this._onFilter}set onFilter(e){this._onFilter=e}}customElements.define("app-list",c)},699:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link href="'+o()(a)+'" rel="stylesheet"/> <style>div{height:100%;overflow:auto}table{border-collapse:collapse;min-width:100%;white-space:nowrap}thead{background-color:var(--background-color);box-shadow:0 2px 4px var(--border-color);position:sticky;top:0}td,th{height:56px;padding:1px 16px;text-align:left}th{text-transform:capitalize;cursor:grab}tbody tr{border-bottom:1px solid var(--border-color,gray);cursor:pointer}tbody tr td::first-line{font-size:medium}tbody tr td{font-size:smaller}tbody tr.selected,tbody tr:hover{background-color:var(--hover-color,rgb(0 0 0 / 4%))}tr.drag th.over{background-color:var(--hover-color,rgb(0 0 0 / 4%))}</style> <div> <table> <thead> <tr id="header"></tr> </thead> <tbody id="body"></tbody> </table> </div>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"open"}),this._shadow.innerHTML=s,this._onColumnReorder=()=>{}}connectedCallback(){this._header=this._shadow.getElementById("header"),this._header.ondragstart=this.onDragStart,this._header.ondragover=this.onDragOver,this._header.ondragenter=this.onDragEnter,this._header.ondragleave=this.onDragLeave,this._header.ondragend=this.onDragEnd,this._header.ondrop=this.onDragDrop,this._body=this._shadow.getElementById("body"),this._body.onclick=this.bodyClick}get onColumnReorder(){return this._onColumnReorder}set onColumnReorder(e){this._onColumnReorder=e}addColumn=e=>{const t=document.createTextNode(e),i=document.createElement("th");i.dataset.id=e,i.appendChild(t),i.setAttribute("draggable","true"),this._header.appendChild(i)};addRow=(e,t)=>{let i=document.createElement("tr");i.id=e,Object.entries(t).forEach((([,e])=>{i.insertAdjacentHTML("beforeend",`<td>${e}</td>`)})),this._body.appendChild(i)};bodyClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("tr");t&&(this._body.querySelector("tr[class~=selected]")?.classList.remove("selected"),t.classList.add("selected"),this.dispatchEvent(new CustomEvent("rowclick",{bubbles:!1,cancelable:!1,detail:{resourceId:t.id}})))};clear=()=>{for(;this._header.firstChild;)this._header.removeChild(this._header.lastChild);this.removeAll()};removeAll=()=>{for(;this._body.firstChild;)this._body.removeChild(this._body.lastChild)};onDragStart=e=>{const t=e.target.closest("th");t.style.opacity="0.4",this._header.classList.add("drag"),this.dragSrcEl=t};onDragEnter=e=>{e.target.closest("th")?.classList.add("over")};onDragLeave=e=>{e.target.closest("th")?.classList.remove("over")};onDragOver=e=>{e.preventDefault();const t=e.target.closest("th");return this.dragSrcEl==t?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move",!1};onDragDrop=e=>{e.stopPropagation();let t=e.target.closest("th");if(this.dragSrcEl!=t){const e=Array.from(this._header.childNodes);e.findIndex((e=>e==this.dragSrcEl))<e.findIndex((e=>e==t))&&(t=t.nextSibling),this._header.insertBefore(this.dragSrcEl,t),this.dragSrcEl=null,this._onColumnReorder(Array.from(this._header.childNodes).map((e=>e.dataset.id)))}return!1};onDragEnd=e=>{e.target.closest("th").style.opacity="1",this._header.classList.remove("drag"),this._header.childNodes.forEach((e=>e.classList.remove("over")))}}customElements.define("data-table",n)},39:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link rel="stylesheet" href="'+o()(a)+'"> <style>main{align-items:center;display:flex;flex-direction:row;font-family:inherit;font-size:.875rem;padding:.5em;text-align:right;white-space:nowrap}.rows{margin:0 24px;flex:auto}</style> <main> <div class="rows"> <slot name="rows"></slot> </div> <div class="arrows"> <slot name="arrows"></slot> </div> </main>';i(914);class n extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML=s}}customElements.define("data-table-pagination",n)},196:()=>{class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML='<style>main{background-color:var(--border-color);overflow:hidden}.thumb{height:.2em;width:50%;background-color:var(--primary-color);left:-50%;position:relative;animation:loading 2s ease-in .5s infinite}@keyframes loading{0%{transform:translateX(0)}to{transform:translateX(400%)}}</style> <main> <div class="thumb"/> </main>'}}customElements.define("linear-progress",e)},72:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link href="'+o()(a)+'" rel="stylesheet"/> <style>main{background-color:inherit;display:flex;align-items:center;gap:.5em}#primary{display:inline-block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:var(--text-color-normal,#000)}#primary:first-letter{text-transform:uppercase}#secondary{display:block;font-size:smaller;color:var(--text-color-disabled);overflow-wrap:break-word}</style> <main> <span id="icon" class="material-symbols"></span> <span class="text"> <span id="primary"></span> <span id="secondary"></span> </span> </main>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s}static get observedAttributes(){return["data-primary","data-secondary","data-icon"]}attributeChangedCallback(e,t,i){switch(e){case"data-icon":this._shadow.getElementById("icon").innerText=i;break;case"data-primary":this._shadow.getElementById("primary").innerText=i;break;case"data-secondary":this._shadow.getElementById("secondary").innerHTML=i}}}customElements.define("list-item",n)},914:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link href="'+o()(a)+'" rel="stylesheet"/> <style>main{padding:8px;text-align:center;border:0 none;color:inherit;background-color:transparent;border-radius:50%;user-select:none}main:not([disabled]):hover{background-color:var(--hover-color,rgb(0 0 0 /5%));cursor:pointer}main[disabled]{color:var(--text-color-disabled)}</style> <main class="material-symbols"/>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s}static get observedAttributes(){return["data-icon","disabled"]}attributeChangedCallback(e,t,i){const r=this._shadow.querySelector("main");"data-icon"===e?r.innerText=i:"disabled"===e&&(null===i?r.removeAttribute("disabled"):r.setAttribute("disabled",""))}connectedCallback(){this._shadow.addEventListener("click",this._onClick)}disconnectedCallback(){this._shadow.removeEventListener("click",this._onClick)}_onClick(e){e.target.hasAttribute("disabled")&&e.stopPropagation()}}customElements.define("round-button",n)},59:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link rel="stylesheet" href="'+o()(a)+'"> <style>main{background-color:var(--background-color,#fff);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:Roboto,Arial,monospace;height:100%;width:400px}header{padding-bottom:3px;border-bottom:1px solid var(--border-color)}header h3{margin:0}#content{overflow:auto;flex:1 1 auto;height:0}@media (max-width:480px){main{top:0;left:0;height:100%;width:100%}}</style> <main> <header slot="header"> <app-bar> <section slot="left"> <slot name="appBarLeft"></slot> </section> <h3 id="title" slot="middle">Side panel</h3> <section slot="right"> <slot name="appBarRight"></slot> <round-button id="close" title="Close" data-icon="close"></round-button> </section> </app-bar> </header> <section id="content"> <slot name="main"></slot> </section> </main>';i(914),i(856);class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s,this._onClose=function(){this.classList.add("hidden")}}static get observedAttributes(){return["data-title"]}attributeChangedCallback(e,t,i){"data-title"==e&&(this._shadow.getElementById("title").innerText=i)}connectedCallback(){this._shadow.getElementById("close").addEventListener("click",(e=>{this.onClose(e)}))}get onClose(){return this._onClose}set onClose(e){this._onClose=e}}window.customElements.define("side-panel",n)},719:(e,t,i)=>{var r=i(91),o=i.n(r),a=new URL(i(156),i.b);const s='<link href="'+o()(a)+'" rel="stylesheet"/> <style>#field{background-color:var(--hover-color,#d3d3d3);border-bottom:1px solid rgba(0,0,0,42%);display:flex;font-size:1em;position:relative}main:focus-within{border-bottom-color:var(--primary-color,#000)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;caret-color:var(--primary-color,black);color:var(--text-color-normal,#000);flex:auto;font:inherit;padding:15px}input[readonly]{cursor:default}input:focus{outline:0;padding:23px 15px 7px 15px;border-color:var(--primary-color)}input::placeholder{font-size:1em;color:var(--text-color-disabled,#000)}input::selection{color:#fff;background:var(--primary-color)}input:focus::placeholder{visibility:hidden}input:not(:placeholder-shown){padding:23px 15px 7px 15px}label{color:var(--text-color-disabled,#000);font-size:12px;left:15px;pointer-events:none;position:absolute;top:6px;visibility:hidden}input:focus+label,input:not(:placeholder-shown)+label{visibility:visible}input:focus+label{color:var(--primary-color,#000)}input:invalid+label,input:invalid:focus{color:var(--background-error);border-color:var(--background-error)}input:required+label::after{content:\'*\'}#helper{font-size:smaller;margin:0 0 1em 1em}</style> <main> <section id="field"> <input type="text" placeholder="" spellcheck="false"> <label></label> </section> <section id="helper"></section> </main>';class n extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=s,this._label=""}static get observedAttributes(){return["placeholder","readonly","required","value","helper"]}attributeChangedCallback(e,t,i){const r=this._shadow.querySelector('input[type="text"]');switch(e){case"placeholder":this._label=i,r.setAttribute("placeholder",i),this._shadow.querySelector("label").innerText=i;break;case"readonly":null==i?r.removeAttribute("readonly"):r.setAttribute("readonly","");break;case"required":null==i?r.removeAttribute("required"):r.setAttribute("required","");break;case"value":r.setAttribute("value",i);break;case"helper":this._shadow.getElementById("helper",i)}r.hasAttribute("required")&&r.setAttribute("placeholder",`${this._label}*`)}checkValidity=function(){return this._shadow.querySelector('input[type="text"]').checkValidity()};focus=function(){this._shadow.querySelector('input[type="text"]').focus()};get value(){return this._shadow.querySelector('input[type="text"]').value}set value(e){this._shadow.querySelector('input[type="text"]').value=e}}window.customElements.define("text-field",n)},916:(e,t,i)=>{i.d(t,{t:()=>o});const r=JSON.parse('{"account":"account_balance_wallet","accountreport":"account_balance_wallet","activitydefinition":"quiz","adverseevent":"emergency_home","allergyintolerance":"allergy","appointment":"today","appointmentresponse":"event_available","auditevent":"browse_activity","basic":"shapes","binary":"data_object","biologicallyderivedproduct":"fork_right","bodystructure":"skeleton","bundle":"format_paragraph","capabilitystatement":"campaign","careplan":"flowsheet","careteam":"groups","catalogentry":"description","chargeitem":"sell","chargeitemdefinition":"sell","claim":"request_quote","claimresponse":"task","clinicalimpression":"comment","codesystem":"data_array","communication":"mail","communicationrequest":"outgoing_mail","compartmentdefinition":"category","composition":"blender","conceptmap":"integration_instructions","condition":"coronavirus","consent":"done","contract":"contract","coverage":"shield","coverageeligibilityrequest":"policy","coverageeligibilityresponse":"verified_user","detectedissue":"bug_report","device":"electrical_services","devicedefinition":"inventory_2","devicemetric":"health_metrics","devicerequest":"unknown_document","deviceusestatement":"home_iot_device","diagnosticreport":"diagnosis","documentmanifest":"dataset","documentreference":"bookmarks","effectevidencesynthesis":"clinical_notes","encounter":"medical_services","enrollmentrequest":"contact_support","enrollmentresponse":"support_agent","endpoint":"location_on","episodeofcare":"blood_pressure","evidence":"search_check","evidencevariable":"troubleshoot","eventdefinition":"event_note","examplescenario":"video_library","explanationofbenefit":"speaker_notes","familymemberhistory":"family_restroom","familimemberhistory":"history","flag":"flag","goal":"sports_score","graphdefinition":"bar_chart","group":"group","guidanceresponse":"mark_email_read","healthcareservice":"mixture_med","implementationguide":"developer_guide","imagingstudy":"radiology","immunization":"immunology","immunizationevaluation":"microbiology","immunizationrecommendation":"mixture_med","insuranceplan":"payments","invoice":"receipt_long","library":"local_library","linkage":"link","list":"list","location":"pin_drop","manifest":"dataset","measure":"scale","measurereport":"lab_profile","media":"perm_media","medicinalproduct":"pill","medicinalproductauthorization":"pill","medicinalproductcontraindication":"pill_off","medicinalproductindication":"pill","medicinalproductingredient":"pill","medicinalproductinteraction":"pill","medicinalproductmanufactured":"pill","medicinalproductpackaged":"pill","medicinalproductpharmaceutical":"pill","medicinalproductundesirableeffect":"sick","medication":"medication","medicationadministration":"medication_liquid","medicationdispense":"prescriptions","medicationknowledge":"medication","medicationrequest":"medication","medicationstatement":"medication","messagedefinition":"developer_guide","messageheader":"code","molecularsequence":"genetics","namingsystem":"import_contacts","nutritionorder":"restaurant","observation":"description","observationdefinition":"file_present","operationdefinition":"function","operationoutcome":"function","organization":"local_hospital","organizationaffiliation":"account_tree","parameters":"settings","patient":"personal_injury","paymentnotice":"credit_card","paymentreconciliation":"credit_score","person":"person","plandefinition":"view_list","practitioner":"stethoscope","practitionerrole":"medical_information","procedure":"checklist","provenance":"deployed_code_history","questionnaire":"assignment","questionnaireresponse":"assignment_turned_in","relatedperson":"family_restroom","requestgroup":"group_work","researchdefinition":"lab_panel","researchelementdefinition":"labs","researchstudy":"biotech","researchsubject":"biotech","resource":"description","riskevidencesynthesis":"feedback","riskassessment":"problem","schedule":"calendar_month","searchparameter":"screen_search_desktop","servicerequest":"ecg","slot":"view_agenda","specimen":"colorize","specimendefinition":"colorize","structuredefinition":"developer_guide","structuremap":"table","subscription":"loyalty","substance":"science","substancenucleicacid":"science","substancepolymer":"science","substanceprotein":"science","substancereferenceinformation":"science","substancesourcematerial":"science","substancespecification":"science","supplydelivery":"deployed_code","supplyrequest":"deployed_code_history","task":"task","terminologycapabilities":"developer_guide","testreport":"integration_instructions","testscript":"code_blocks","valueset":"data_array","verificationresult":"new_releases","visionprescription":"ophthalmology"}');class o{static{this._server=null,this._references={},this._fhirReferences=null,this._serverChangeListener=[]}static addListener=e=>{this._serverChangeListener.push(e)};static dispatchServerChange=()=>{this._serverChangeListener.forEach((e=>{e.call()}))};static get release(){return{"5.0.0":"R5","4.6.0":"R5","4.5.0":"R5","4.4.0":"R5","4.3.0":"R4B","4.2.0":"R5","4.1.0":"R4B","4.0.1":"R4","3.5.0":"R4","3.3.0":"R4","3.2.0":"R4","3.0.2":"STU3","3.0.1":"STU3","3.0.0":"STU3"}[this._server.capabilities.fhirVersion]||null}static set server(e){e!=this._server&&(this._server=e,this.dispatchServerChange())}static get server(){return this._server}static helpUrl(e){return`https://hl7.org/fhir/${this.release}/${e.toLowerCase()}.html`}static references(e){return this._references[e]}static formatEnable(e){let t=[];switch(e){case"json":t.push("json"),t.push("application/fhir+json"),t.push("html/json");break;case"xml":t.push("xml"),t.push("application/fhir+xml"),t.push("html/xml");break;case"ttl":t.push("ttl"),t.push("application/x-turtle"),t.push("html/turtle")}return this.server.capabilities.format.some((e=>t.includes(e)))}static async capabilities(e){const t=new URL(`${e.url}/metadata`);t.searchParams.set("_format","json");try{const i=await fetch(t,{cache:"reload",headers:e.headers});return i.ok?i.json():Promise.reject(i)}catch(e){return Promise.reject(e)}}static async structureDefinition(e){const t=new URL(`https://hl7.org/fhir/${this.release}/${e.toLowerCase()}.profile.json`);return(await fetch(t,{cache:"force-cache"})).json()}static async read(e,t){const i=new URL(`${this._server.url}/${e}/${t}`);return i.searchParams.set("_format","json"),(await fetch(i,{headers:this._server.headers})).json()}static async readHistory(e,t){const i=new URL(`${this._server.url}/${e}/${t}/_history`);return i.searchParams.set("_summary","text"),i.searchParams.set("_format","json"),(await fetch(i,{headers:this._server.headers})).json()}static async readXml(e,t){const i=new URL(`${this._server.url}/${e}/${t}`);return i.searchParams.set("_format","xml"),(await fetch(i,{headers:this._server.headers})).text()}static async readTtl(e,t){const i=new URL(`${this._server.url}/${e}/${t}`);return i.searchParams.set("_format","ttl"),(await fetch(i,{headers:this._server.headers})).text()}static async searchByLink(e,t=[]){const i=new URL(e);i.searchParams.set("_summary","true"),i.searchParams.set("_format","json"),t.forEach((e=>{i.searchParams.set(e.name,e.value)}));try{const e=await fetch(i,{headers:this._server.headers});return e.ok?e.json():Promise.reject(e)}catch(e){return Promise.reject(e)}}static async searchCount(e,t=[]){const i=new URL(`${this._server.url}/${e}`);i.searchParams.set("_summary","count"),i.searchParams.set("_format","json"),t.forEach((e=>{i.searchParams.set(e.name,e.value)}));const r=await fetch(i,{headers:this._server.headers});if(!r.ok)throw r;return r.json()}static async execute(e){const t=new URL(`${this._server.url}/${e}`);t.searchParams.set("_format","json");const i=await fetch(t,{headers:this._server.headers});if(!i.ok)throw i;return i.json()}static async connect(e,t){switch(t.auth?.method){case"oauth2":this.oauth2_getToken(t.auth.setup).then((e=>{t.headers||(t.headers={}),t.headers.Authorization=`${e.token_type} ${e.access_token}`}));break;case"basic":let e=btoa(`${t.auth.setup.username}:${t.auth.setup.password}`);t.headers||(t.headers={}),t.headers.Authorization=`Basic ${e}`;break;case"apikey":t.headers||(t.headers={}),t.headers[t.auth.setup.key]=t.auth.setup.value}const i=await o.capabilities(t);t.serverCode=e,t.capabilities=i,o.server=t,this._references=await this.parseReferences(i)}static async parseReferences(e){const t={},i=e.rest[0].resource,r=await this.getAllReferences();return e.rest[0].resource.forEach((e=>{const o=r[this.release][e.type];if(o){const r=JSON.parse(JSON.stringify(o));Object.entries(r).forEach((([e,t])=>{let o=i.find((t=>e==t.type));o&&o.searchParam?(r[e].forEach(((t,i)=>{const a=o.searchParam.find((e=>t==e.name));a?r[e][i]={name:t,documentation:a.documentation}:r[e].splice(i,1)})),0===r[e].length&&delete r[e]):delete r[e]})),0!==Object.keys(r).length&&(t[e.type]=r)}})),t}static async getAllReferences(){if(!this._fhirReferences){const e=await fetch("./assets/references.json");this._fhirReferences=await e.json()}return this._fhirReferences}static async oauth2_getToken(e){let t={grant_type:e.grant_type};const i={"Content-type":"application/x-www-form-urlencoded"};if("client_credentials"==e.grant_type){const t=btoa(`${e.client_id}:${e.client_secret}`);i.Authorization=`Basic ${t}`}let r=new URLSearchParams(t);return(await fetch(e.access_token_url,{headers:i,method:"POST",body:r.toString()})).json()}static ResourceIcon(e){return r[e.toLowerCase()]||"unknown_med"}}},571:(e,t,i)=>{i.d(t,{y:()=>r});class r{static{this.KEY="preferences"}static get(e,t=null){const i=localStorage.getItem(this.KEY);let r=null;return null===i?t:(r=JSON.parse(i),r[e]||t)}static set(e,t){const i=localStorage.getItem(this.KEY);let r=null;r=null!==i?JSON.parse(i):{},r[e]=t,localStorage.setItem(this.KEY,JSON.stringify(r))}}},332:(e,t,i)=>{i.d(t,{h:()=>o});class r extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{background-color:#fff;border-radius:4px;box-shadow:0 11px 15px -7px rgb(0 0 0 / 20%),0 24px 38px 3px rgb(0 0 0 / 14%),0 9px 46px 8px rgb(0 0 0 / 12%);bottom:1em;margin:0 1em;min-width:344px;position:absolute}.overlay{align-items:center;background-color:rgba(0,0,0,85%);color:#fff;display:flex;flex-direction:row;font-family:Roboto,Arial,monospace;min-height:48px;padding:0 1em}main.error .overlay{background-color:var(--background-error)}#message{flex-grow:1;overflow:hidden;padding:0 1em;text-overflow:ellipsis;white-space:nowrap}slot[name=right]{margin-left:1em}@media (max-width:480px){main{min-width:unset;width:calc(100% - 2em)}}</style> <main> <div class="overlay"> <div id="message"> <slot></slot> </div> <slot name="right"></slot> </div> </main>'}set type(e="info"){this._shadow.querySelector("main").classList.add(e)}}customElements.define("snack-bars",r);class o{static{this._container=document.body}static set container(e){this._container=e}static show(e,t,i=4e3,r="info"){let o=document.createElement("snack-bars");o.type=r,o.appendChild(document.createTextNode(e)),t&&(t.setAttribute("slot","right"),o.appendChild(t)),this._container.appendChild(o),setTimeout((()=>{o.remove()}),i)}}},156:(e,t,i)=>{e.exports=i.p+"d353739f137f323d232b.css"}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&!e;)e=i[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})(),__webpack_require__.b=document.baseURI||self.location.href;var __webpack_exports__={};(()=>{var e=__webpack_require__(91),t=__webpack_require__.n(e),i=new URL(__webpack_require__(156),__webpack_require__.b);const r='<link rel="stylesheet" href="'+t()(i)+'"> <style>:host{background-color:var(--background-color,#fff);color:var(--text-color-normal,rgb(0,0,0,87%));display:flex;flex-direction:column;font-family:Roboto,Arial,monospace;font-size:1rem;font-weight:400;height:100vh;line-height:1.5}header{background-color:var(--primary-color,#000);color:#fff}h3{margin:0}main{flex:1 1 auto;height:0;overflow:hidden}main>div{display:flex;flex-direction:row;height:100%}#leftPanel{border-right:1px solid var(--border-color,gray);flex:none;transition:all .3s;margin-left:0;width:300px}#leftPanel.hidden{transition:all .3s;margin-left:-300px}#bdy{flex:1 1 auto;overflow:hidden;width:0;position:relative;block-size:100%;display:grid;grid-auto-flow:column;grid-auto-columns:100%;grid-auto-rows:100%}#waiting{align-items:center;background-color:rgba(0,0,0,32%);display:flex;font-size:5em;justify-content:center;left:0;min-height:100%;min-width:100%;position:absolute;top:0;visibility:hidden}@media (max-width:480px){#leftPanel{background-color:var(--background-color,#fff);position:static;width:100%}#leftPanel.hidden{margin-left:-100%}}</style> <header> <app-bar id="header" caption=""> <round-button slot="left" id="navigation" title="Menu" data-icon="menu" hidden></round-button> <span id="appTitle" slot="middle">FHIR Browser</span> <color-scheme slot="right"></color-scheme> <round-button slot="right" id="serverDialogToggle" title="Connections" data-icon="database"></round-button> <round-button slot="right" id="aboutDialogToggle" title="About" data-icon="help"></round-button> </app-bar> </header> <main> <div> <app-left-panel id="leftPanel" class="hidden"> <fhir-metadata id="metadata"></fhir-metadata> </app-left-panel> <div id="bdy" style="visibility:hidden"> <fhir-bundle id="bundle"></fhir-bundle> <fhir-resource id="resource"></fhir-resource> </div> </div> </main> <app-dialog id="aboutDialog" data-title="About FHIR Browser" hidden> <round-button slot="appBarLeft" id="aboutClose" title="close" data-icon="close"></round-button> <fhir-browser-about></fhir-browser-about> </app-dialog> <fhir-server-dialog hidden></fhir-server-dialog> <div id="waiting"> <circular-progress></circular-progress> </div>';__webpack_require__(856),__webpack_require__(937);var o=__webpack_require__(571);class a extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<round-button title="" data-icon=""></round-button>'}connectedCallback(){this._shadow.addEventListener("click",this.onClick),this.setColorScheme(o.y.get("colorScheme","auto"))}disconnectedCallback(){this._shadow.removeEventListener("click",this.onClick)}onClick=e=>{const t=["light","dark","auto"];let i=o.y.get("colorScheme","auto"),r=t.findIndex((e=>e===i))+1;i=t[r%3],o.y.set("colorScheme",i),this.setColorScheme(i)};setColorScheme=e=>{let t="",i=e;switch(e){case"dark":t="brightness_4";break;case"light":t="light_mode";break;default:"auto"===e&&(i=window?.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),t="brightness_auto"}const r=this._shadow.querySelector("round-button");r.setAttribute("data-icon",t),r.title=`Theme ${e}`,document.body.setAttribute("color-scheme",i)};get value(){return o.y.get("colorScheme","auto")}}customElements.define("color-scheme",a);class s extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{height:.7em;width:.7em;color:var(--primary-color);display:inline-block;border:.15em solid;border-radius:50%;border-top-color:transparent;animation:rotate 1s linear infinite}@keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style> <main/>"}setColor(e){this._shadow.querySelector("main").setAttribute("style","color:"+e+";")}}customElements.define("circular-progress",s);var n=new URL(__webpack_require__(156),__webpack_require__.b);const l='<link rel="stylesheet" href="'+t()(n)+'"> <style>main{display:flex;flex-direction:column;height:100%}::slotted(*){flex:1 1 auto;height:0}</style> <main> <slot></slot> </main>';class d extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML=l}}customElements.define("app-left-panel",d);var c=new URL(__webpack_require__(156),__webpack_require__.b);const h='<link href="'+t()(c)+'" rel="stylesheet"/> <style>main{padding:1em}a{color:var(--primary-color)}</style> <main> <p> FHIR Browser is and <a target="_blank" href="https://github.com/hprieurgarrouste/fhirBrowser.git">open source</a> utility developed by and intended for FHIR developers<br/>and all IT professionals who work with a FHIR server. <br/>Its purpose is to help users analyze FHIR servers and learn about their content. </p> <p> All content on the website is published under Creative Commons License <a target="_blank" href="https://github.com/hprieurgarrouste/fhirBrowser/blob/master/licence.md">CC-BY-NC-ND 4.0</a> </p> </main>';class u extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=h}}customElements.define("fhir-browser-about",u),__webpack_require__(759);class p extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}header{display:flex;flex-direction:row;flex-wrap:nowrap;border-bottom:1px solid var(--border-color)}header>section{background-color:transparent;color:inherit;cursor:pointer;font:inherit;height:3em;line-height:3em;text-transform:uppercase;text-align:center;white-space:nowrap;width:100%;flex-grow:1;border-bottom:2px solid transparent;font-size:smaller}header>section:hover{background-color:var(--hover-color,rgba(0,0,0,5%))}header>section[selected]{border-bottom-color:var(--primary-color,#000);font-weight:700;color:var(--primary-color,#000)}::slotted(section){flex:1 1 auto;height:0}</style> <main> <header></header> <slot></slot> </main>",this._slot=null,this._header=null}connectedCallback(){this._shadow.onclick=e=>{e.preventDefault(),e.stopPropagation()},this._header=this._shadow.querySelector("header"),this._header.onclick=this.headerClick,this._slot=this._shadow.querySelector("slot"),this._slot.addEventListener("slotchange",this.slotChanged)}clear=()=>{for(;this._header.firstChild;)this._header.removeChild(this._header.lastChild)};slotChanged=()=>{this.clear(),this._slot.assignedElements().forEach((e=>{e.hidden=!0;const t=document.createElement("section");t.dataset.caption=e.dataset.caption,t.innerText=e.dataset.caption,this._header.appendChild(t)})),this.value||(this.value=this._header.querySelector("section:nth-child(1)")?.dataset.caption)};headerClick=({target:e})=>{this.value=e.dataset.caption};get value(){return this._header.querySelector("section[selected]")?.dataset?.caption}set value(e){this._header.querySelector("section[selected]")?.removeAttribute("selected"),this._slot.assignedElements().forEach(((t,i)=>{t.dataset.caption==e?(t.hidden=!1,this._header.querySelector(`section:nth-child(${i+1})`)?.setAttribute("selected","")):t.hidden=!0})),this.dispatchEvent(new CustomEvent("select",{bubbles:!1,cancelable:!1,detail:{caption:e}}))}}customElements.define("app-tabs",p);var m=new URL(__webpack_require__(156),__webpack_require__.b);const _='<link href="'+t()(m)+'" rel="stylesheet"/> <style>main{display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}</style> <main> <app-list></app-list> </main>';__webpack_require__(251),__webpack_require__(72);class f extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{padding:.5em 1em;background-color:inherit}main:hover,main[selected]{background-color:var(--hover-color,rgba(0,0,0,5%))}</style> <main> <slot></slot> </main>"}static get observedAttributes(){return["selected"]}attributeChangedCallback(e,t,i){if("selected"===e){const e=this._shadow.querySelector("main");null===i?e.removeAttribute("selected"):e.setAttribute("selected","")}}}customElements.define("list-row",f);var g=__webpack_require__(916);class b extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_,this._metadata=null,this._resourceType=null}connectedCallback(){const e=this._shadow.querySelector("app-list");e.onFilter=this.appListFilter,e.onclick=this.appListClick}appListClick=({target:e})=>{const t=e.closest("list-row");t&&(this._shadow.querySelector("app-list").querySelector("[selected]")?.removeAttribute("selected"),t.setAttribute("selected",""),this._resourceType=t.dataset.type,location.hash=`#${t.dataset.type}`)};appListFilter=e=>{const t=e.toLowerCase();this._shadow.querySelector("app-list").childNodes.forEach((e=>{e.hidden=!e.dataset.type.toLowerCase().includes(t)}))};get value(){return this._resourceType}set value(e){const t=this._shadow.querySelector("app-list");if(e){if(e!=this._resourceType){const i=Array.from(t.childNodes).filter((t=>t.dataset.type===e));i?.length&&(this._resourceType=e,t.querySelector("[selected]")?.removeAttribute("selected"),i[0].setAttribute("selected",""),i[0].scrollIntoView())}}else t.querySelector("[selected]")?.removeAttribute("selected"),t.scrollTop=0}set metadata(e){this._metadata=e;const t=this._shadow.querySelector("app-list");t.clear(),e.rest[0].resource.filter((e=>e.interaction.map((e=>e.code)).includes("search-type"))).forEach((e=>{const i=document.createElement("list-row");i.setAttribute("data-type",e.type);const r=document.createElement("list-item");r.setAttribute("data-primary",e.type),r.setAttribute("data-icon",g.t.ResourceIcon(e.type)),i.appendChild(r),t.appendChild(i)}))}}customElements.define("fhir-resource-types",b);class y extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}app-list>*{cursor:default}</style> <main> <app-list></app-list> </main>"}clear(){const e=this._shadow.querySelector("main");for(;e.firstChild;)e.removeChild(e.lastChild)}set metadata(e){const t=this._shadow.querySelector("app-list");t.clear(),r("copyright",e.copyright),r("description",e.description),r("fhirVersion",`${e.fhirVersion} (${g.t.release})`);const i=document.createElement("UL");function r(e,i){if(void 0===i)return;const r=document.createElement("list-row"),o=document.createElement("list-item");o.setAttribute("data-primary",e),o.setAttribute("data-secondary",i),r.appendChild(o),t.appendChild(r)}e.format.forEach((e=>{const t=document.createElement("LI");t.innerText=e,i.appendChild(t)})),r("format",i.outerHTML),e.implementation&&(r("implementation description",e.implementation.description),r("implementation name",e.implementation.name),r("implementation url",e.implementation.url)),r("language",e.language),r("name",e.name),r("publisher",e.publisher),e.software&&(r("software name",e.software.name),r("software version",e.software.version),r("software release date",e.software.releaseDate))}}customElements.define("fhir-capability",y);class w extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{display:flex;flex-direction:column;height:100%;overflow:hidden}app-tabs{flex:1 1 auto}#server{padding:1em}</style> <main> <header id="server"> <list-item id="serverTitle" data-primary="" data-secondary="" data-icon=""></list-item> </header> <app-tabs> <section data-caption="Resource Types"> <fhir-resource-types id="resourceTypes"></fhir-resource-types> </section> <section data-caption="Details"> <fhir-capability id="capability"></fhir-capability> </section> </app-tabs> </main>',this._metadata=null}connectedCallback(){window.addEventListener("hashchange",this.locationHandler),g.t.addListener(this.serverChanged)}locationHandler=()=>{let e=window.location.hash.replace("#","").trim();if(e.length){let t="";t=e.indexOf("?")>0?e.split("?")[0]:e.split("/")[0],this._shadow.getElementById("resourceTypes").value=t}else this._shadow.getElementById("resourceTypes").value=null};serverChanged=()=>{const e=g.t.server;this._shadow.getElementById("serverTitle").setAttribute("data-primary",e.serverCode),this._shadow.getElementById("serverTitle").setAttribute("data-secondary",e.capabilities?.implementation?.description||e.capabilities?.software?.name||e.url),this._shadow.getElementById("resourceTypes").metadata=e.capabilities,this._shadow.getElementById("capability").metadata=e.capabilities,this.locationHandler()}}customElements.define("fhir-metadata",w);var v=new URL(__webpack_require__(156),__webpack_require__.b);const k='<link rel="stylesheet" href="'+t()(v)+'"> <style>#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}#resourceCnt{display:flex;flex-direction:column;height:100%;flex:auto;width:0}main{flex:1 1 auto;height:0}#title{margin:0;overflow:hidden;text-overflow:ellipsis}tab-bar{border-bottom:1px solid var(--border-color)}#formView,#jsonView,#ttlView,#xmlView{flex:1 1 auto;height:0}#header.error{background-color:var(--background-error,transparent);color:#fff}#error{padding:1em}#tabs{display:flex;flex-direction:column;height:100%}fhir-history,fhir-references{border-left:1px solid var(--border-color)}@media (max-width:480px){fhir-history,fhir-references{background-color:var(--background-color,#fff);position:relative;width:100%}}</style> <div id="wrapper"> <section id="resourceCnt"> <header> <app-bar id="header"> <round-button slot="left" id="help" title="Help" data-icon="help"></round-button> <h3 slot="middle" id="title"></h3> <round-button slot="right" id="share" title="Share" data-icon="share"></round-button> <round-button slot="right" id="copy" title="Copy to clipboard" data-icon="content_copy"></round-button> <round-button slot="right" id="download" title="Download" data-icon="download"></round-button> <round-button slot="right" id="referencesToggle" title="References" data-icon="article_shortcut"></round-button> <round-button slot="right" id="historyToggle" title="History" data-icon="history"></round-button> </app-bar> </header> <main> <app-tabs></app-tabs> </main> </section> <fhir-references slot="main" hidden></fhir-references> <fhir-history slot="main" hidden></fhir-history> </div>';var x=new URL(__webpack_require__(156),__webpack_require__.b);const E='<link href="'+t()(x)+'" rel="stylesheet"/> <style>main{display:flex;align-items:center;gap:.5em;padding:.2em .5em;border-radius:1em;white-space:nowrap;border:1px solid var(--border-color);color:var(--text-color-normal);cursor:pointer;text-decoration:none;text-align:center}main:hover{background-color:var(--hover-color)}</style> <main> <span id="icon" class="material-symbols"></span> <span id="text"></span> </main>';class C extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=E}static get observedAttributes(){return["data-text","data-icon"]}attributeChangedCallback(e,t,i){switch(e){case"data-icon":this._shadow.getElementById("icon").innerText=i;break;case"data-text":this._shadow.getElementById("text").innerText=i}}}window.customElements.define("app-chips",C),__webpack_require__(914),__webpack_require__(59);var S=new URL(__webpack_require__(156),__webpack_require__.b);const L='<link href="'+t()(S)+'" rel="stylesheet"/> <style>#list{display:flex;flex-direction:column;flex-wrap:nowrap;background:linear-gradient(90deg,var(--background-color) calc(100% - 2px),var(--text-color-normal) 0);background-size:19px;background-repeat:no-repeat}#list>*{cursor:pointer}</style> <side-panel data-title="History"> <round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></round-button> <section id="list" slot="main"></section> </side-panel>';class T extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=L,this._resourceType=null,this._resourceId=null}connectedCallback(){this._shadow.getElementById("help").onclick=this.helpClick,this._shadow.getElementById("list").onclick=this.listClick,this._shadow.querySelector("side-panel").onClose=this.sidePanelClose}listClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("list-row");if(t){if(t.hasAttribute("selected"))return;this._shadow.querySelector("list-row[selected]")?.removeAttribute("selected"),t.setAttribute("selected",""),location.hash=`#${this._resourceType}/${this._resourceId}/_history/${t.dataset.versionid}`}else e.preventDefault(),e.stopPropagation()};helpClick=e=>{window.open(`https://hl7.org/fhir/${g.t.release}/http.html#history`,"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};sidePanelClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};clear(){const e=this._shadow.getElementById("list");for(;e.firstChild;)e.removeChild(e.lastChild)}load(e,t){e.interaction.find((({code:e})=>"vread"==e))&&(e.type==this._resourceType&&t==this._resourceId||g.t.read(e.type,t).then((t=>{const i=this._shadow.getElementById("list");this._resourceType=e.type,this._resourceId=t.id;const r=t.meta?.versionId;this.clear(),g.t.readHistory(e.type,t.id).then((e=>{"Bundle"==e.resourceType&&"history"==e.type&&e.total>1&&e.entry.sort(((e,t)=>{const i=new Date(e.resource.meta.lastUpdated);return new Date(t.resource.meta.lastUpdated)-i})).forEach((e=>{const t=document.createElement("list-row");t.setAttribute("data-versionid",e.resource.meta.versionId),r==e.resource.meta.versionId&&t.setAttribute("selected","");const o=new Date(e.resource.meta.lastUpdated),a=document.createElement("list-item");a.setAttribute("data-icon","line_end_circle"),a.setAttribute("data-primary",`${o.toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"})}`),a.setAttribute("data-secondary",`${o.toLocaleString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"})}`),t.appendChild(a),i.appendChild(t)}))}))})))}}customElements.define("fhir-history",T);var q=new URL(__webpack_require__(156),__webpack_require__.b);const I='<link href="'+t()(q)+'" rel="stylesheet"/> <style>main{display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}</style> <side-panel data-title="References"> <main slot="main"> <app-list></app-list> </main> </side-panel>';class A extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=I,this._resourceType=null,this._resourceId=null,this._list=null}connectedCallback(){this._list=this._shadow.querySelector("app-list"),this._list.onclick=this.appListClick,this._list.onFilter=this.appListFilter,this._shadow.querySelector("side-panel").onClose=this.sidePanelClose}appListClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("list-row");t&&(location.hash=`#${t.dataset.target}?${t.dataset.search}=${this._resourceId}`)};appListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!(e.dataset.target.toLowerCase().includes(t)||e.dataset.search.toLowerCase().includes(t))}))};sidePanelClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};load(e,t){this._resourceType=e,this._resourceId=t,this._list.clear();const i=g.t.references(e.type);return i&&Object.entries(i).forEach((([e,t])=>{t.forEach((t=>{const i=document.createElement("list-row");i.setAttribute("data-target",e),i.setAttribute("data-search",t.name);const r=document.createElement("list-item");r.setAttribute("data-icon",g.t.ResourceIcon(e)),r.setAttribute("data-primary",`${e}.${t.name}`),r.setAttribute("data-secondary",t.documentation.length>100?`${t.documentation.substring(0,100)}...`:t.documentation),i.appendChild(r),this._list.appendChild(i)}))})),this._list.children.length>0}}customElements.define("fhir-references",A),__webpack_require__(85);var B=new URL(__webpack_require__(156),__webpack_require__.b);const M='<link rel="stylesheet" href="'+t()(B)+"\"> <style>main{--indent:32px;display:flex;flex-direction:column;height:100%}#content{color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;white-space:nowrap}dl{margin:0;padding-left:var(--indent)}dt{list-style-type:none}span{color:var(--json-viewer-values-color,#000);cursor:inherit}span.key{color:var(--json-viewer-properties-color,#000)}span.key::before{content:'\"'}span.key::after{content:'\": '}dt.array>span.value>dl>dt>span.key::before{content:''}dt.array>span.value>dl>dt>span.key::after{content:': '}span.value a{color:inherit}span.value.string::before{content:'\"'}span.value.string::after{content:'\"'}dt.array>span.value::before{content:'['}dt.array>span.value::after{content:']'}dt.object>span.value::before{content:'{'}dt.object>span.value::after{content:'}'}dt,dt.array>span.value::after,dt.object>span.value::after{padding-left:var(--indent)}dt.array,dt.object{padding-left:0}dt.array::before,dt.object::before{cursor:pointer;content:'expand_less ';font-family:'Material Symbols Sharp';font-weight:700;line-height:inherit;vertical-align:middle;color:var(--text-color-disabled,#000)}dt:not(:last-child)::after{content:\",\"}dt.collapsed::before{content:'expand_more '}dt.collapsed>span dl{display:none}dt.array.collapsed span.value::after{content:'...]';padding-left:0}dt.object.collapsed span.value::after{content:'...}';padding-left:0}footer{text-align:right;padding:.5em;border-top:1px solid var(--border-color)}footer app-switch{vertical-align:middle}@media (max-width:480px){#content{line-height:2em}}</style> <main> <div id=\"content\"></div> <footer>Sorted <app-switch></app-switch></footer> </main>";class D extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{position:relative;display:inline-block;width:36px;height:20px}main input{opacity:0;width:0;height:0}span{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--text-color-disabled);-webkit-transition:.4s;transition:.4s;border-radius:34px}span:before{position:absolute;content:"";height:14px;width:14px;left:3px;bottom:3px;background-color:#fff;-webkit-transition:.4s;transition:.4s;border-radius:50%}input:checked+span{background-color:var(--primary-color)}input:focus+span{box-shadow:0 0 1px var(--primary-color)}input:checked+span:before{transform:translateX(15px)}</style> <main> <input type="checkbox"> <span></span> </main>',this._input=null}static get observedAttributes(){return["data-checked"]}attributeChangedCallback(e,t,i){const r=this._shadow.querySelector("input");"data-checked"==e&&(null===i?r.removeAttribute("checked"):r.setAttribute("checked",""))}connectedCallback(){this._input=this._shadow.querySelector("input"),this._shadow.addEventListener("click",this.onclickHandler)}onclickHandler=e=>{this.hasAttribute("data-checked")?this.removeAttribute("data-checked"):this.setAttribute("data-checked","")}}window.customElements.define("app-switch",D);class P extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=M,this._sorted=!1,this._resource=null}connectedCallback(){this._shadow.getElementById("content").onclick=this.contentClick,this._sorted=o.y.get("jsonView",{sorted:!0}).sorted;const e=this._shadow.querySelector("app-switch");this._shadow.querySelector("app-switch").onclick=this.sortedClickHandler,this._sorted?e.setAttribute("data-checked",""):e.removeAttribute("data-checked")}sortedClickHandler=e=>{this._sorted=this._shadow.querySelector("app-switch").hasAttribute("data-checked"),o.y.set("jsonView",{sorted:this._sorted}),this.source=this._resource};contentClick=({target:e,offsetX:t,offsetY:i,ctrlKey:r})=>{if(e.classList.contains("array")||e.classList.contains("object")){const o=e.childNodes[0];if(o&&t<o.offsetLeft&&i<o.offsetHeight&&(e.classList.toggle("collapsed"),r)){const t=e.classList.contains("collapsed");Array.from(e.querySelectorAll("dt")).filter((e=>e.classList.contains("object")||e.classList.contains("array"))).forEach((e=>{t?e.classList.add("collapsed"):e.classList.remove("collapsed")}))}}};clear=()=>{const e=this._shadow.getElementById("content");e.scrollTo(0,0),e.innerHTML="Loading...",e.style.cursor="wait"};set source(e){const t=this._shadow.getElementById("content");t.scrollTo(0,0),t.innerHTML="",t.appendChild(document.createTextNode("{")),t.appendChild(this.parse(e)),t.appendChild(document.createTextNode("}")),t.style.cursor="default",this._resource=e}parse=e=>{let t=document.createElement("dl"),i=Object.entries(e);return this._sorted&&(i=i.sort()),i.forEach((([e,i])=>{const r=document.createElement("dt"),o=document.createElement("span");o.className="key",o.innerText=e,r.appendChild(o);const a=document.createElement("span");if(a.classList.add("value"),null===i)a.innerText="null";else if("string"==typeof i)if(a.classList.add("string"),"reference"===e){let e=i;e.startsWith(g.t.server.url)&&(e=e.slice(g.t.server.url.length+1));let t=document.createElement("a");t.setAttribute("href",`#${e}`),t.appendChild(document.createTextNode(i)),a.appendChild(t)}else a.innerText=i;else"object"==typeof i?(r.classList.add(Array.isArray(i)?"array":"object"),a.appendChild(this.parse(i))):a.innerText=i;r.appendChild(a),t.appendChild(r)})),t}}customElements.define("fhir-resource-json",P);class O extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{display:flex;flex-direction:column;height:100%}#content{color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;white-space:pre;margin:0}@media (max-width:480px){#content{line-height:2em}}</style> <main> <pre id="content"></pre> </main>'}clear=()=>{const e=this._shadow.getElementById("content");e.scrollTo(0,0),e.innerHTML="Loading...",e.style.cursor="wait"};set source(e){const t=this._shadow.getElementById("content");t.scrollTo(0,0),t.innerText=e,t.style.cursor="default"}}customElements.define("fhir-resource-ttl",O);var R=new URL(__webpack_require__(156),__webpack_require__.b);const H='<link rel="stylesheet" href="'+t()(R)+"\"> <style>main{--indent:32px;display:flex;flex-direction:column;height:100%}#content{color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;margin:0;white-space:nowrap}dl{margin:0;padding-left:var(--indent)}#content>dl{padding-left:0}dt{list-style-type:none}span.key{color:var(--xml-viewer-nodes-color,#000)}span.key::before{content:'<'}span.key::after{content:'>'}span.attributes{color:var(--xml-viewer-attributes-color,#000)}span.values{color:var(--xml-viewer-values-color,#000)}span.values a{color:inherit}span.key.end{padding-left:var(--indent)}dt,dt.object>span.value::after{padding-left:var(--indent)}dt.object{padding-left:0}dt.object::before{cursor:pointer;content:'expand_less ';font-family:'Material Symbols Sharp';font-weight:700;line-height:inherit;vertical-align:middle;color:var(--text-color-disabled,#000)}dt.collapsed::before{content:'expand_more '}dt.collapsed>span dl{display:none}dt.object.collapsed span.value::after{content:'...';padding-left:0}dt.object.collapsed span.key.end{padding-left:0}footer{text-align:right;padding:.5em;border-top:1px solid var(--border-color)}footer app-switch{vertical-align:middle}@media (max-width:480px){#content{line-height:2em}}</style> <main> <div id=\"content\"></div> <footer>Sorted <app-switch></app-switch></footer> </main>";class N extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=H,this._sorted=!1,this._resource=null}connectedCallback(){this._shadow.getElementById("content").onclick=this.contentClick,this._sorted=o.y.get("xmlView",{sorted:!0}).sorted;const e=this._shadow.querySelector("app-switch");this._shadow.querySelector("app-switch").onclick=this.sortedClickHandler,this._sorted?e.setAttribute("data-checked",""):e.removeAttribute("data-checked")}sortedClickHandler=e=>{this._sorted=this._shadow.querySelector("app-switch").hasAttribute("data-checked"),o.y.set("xmlView",{sorted:this._sorted}),this.source=this._resource};contentClick=({target:e,offsetX:t,offsetY:i,ctrlKey:r})=>{if(e.classList.contains("object")){const o=e.childNodes[0];if(o&&t<o.offsetLeft&&i<o.offsetHeight&&(e.classList.toggle("collapsed"),r)){const t=e.classList.contains("collapsed");Array.from(e.querySelectorAll("dt")).filter((e=>e.classList.contains("object"))).forEach((e=>{t?e.classList.add("collapsed"):e.classList.remove("collapsed")}))}}};clear=()=>{const e=this._shadow.getElementById("content");e.scrollTo(0,0),e.innerHTML="Loading...",e.style.cursor="wait"};set source(e){const t=this._shadow.getElementById("content");t.scrollTo(0,0),t.innerHTML=this.parse(e).outerHTML,t.style.cursor="default",this._resource=e}parse=e=>{let t=document.createElement("dl"),i=Array.from(e.children);return this._sorted&&i.sort(((e,t)=>e.nodeName.localeCompare(t.nodeName))),i.forEach((e=>{const i=document.createElement("dt");let r=document.createElement("span");r.className="key",r.innerText=e.nodeName,i.appendChild(r),e.attributes.length&&Array.from(e.attributes).forEach((t=>{let i=document.createElement("span");i.className="attributes",i.innerText=` ${t.nodeName}=`,r.appendChild(i);let o=document.createElement("span");if(o.className="values","reference"===e.nodeName&&"value"===t.nodeName){let e=t.nodeValue;e.startsWith(g.t.server.url)&&(e=e.slice(g.t.server.url.length+1));let i=document.createElement("a");i.setAttribute("href",`#${e}`),i.appendChild(document.createTextNode(`"${t.nodeValue}"`)),o.appendChild(i)}else o.innerText=`"${t.nodeValue}"`;i.appendChild(o)}));const o=document.createElement("span");o.classList.add("value"),e.children.length?(i.classList.add("object"),o.innerHTML=this.parse(e).outerHTML,i.appendChild(o),r=document.createElement("span"),r.className="key end",r.innerText=`/${e.nodeName}`,i.appendChild(r)):r.innerHTML+="/",t.appendChild(i)})),t}}customElements.define("fhir-resource-xml",N);var $=__webpack_require__(332);class U extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=k,this._resourceType=null,this._resourceId=null,this._resource={}}async getJson(e,t){let i=null;try{i=await g.t.read(this._resourceType.type,this._resourceId),this._resource.json=i;const e=this._shadow.querySelector("fhir-resource-json");e&&(e.source=i)}catch(e){$.h.show("An error occurred while reading json",void 0,void 0,"error")}return i}connectedCallback(){this._shadow.getElementById("help").onclick=this.helpClick,this._shadow.getElementById("download").onclick=this.downloadClick,this._shadow.getElementById("copy").onclick=this.copyClick,this._shadow.getElementById("share").onclick=this.shareClick,this._shadow.getElementById("referencesToggle").onclick=this.referenceToggleClick,this._shadow.getElementById("historyToggle").onclick=this.historyToggleClick,this._shadow.querySelector("app-tabs").addEventListener("select",(({detail:e})=>{if(this._resourceType?.type&&this._resourceId){switch(e.caption){case"json":this._resource.json||(this._resource.json=this.getJson(this._resourceType.type,this._resourceId));break;case"xml":g.t.readXml(this._resourceType.type,this._resourceId).then((e=>{this._resource.xml=e;const t=(new DOMParser).parseFromString(e,"application/xml"),i=this._shadow.querySelector("fhir-resource-xml");i&&(i.source=t)})).catch((e=>{this._resource.xml=null,$.h.show("An error occurred while reading xml",void 0,void 0,"error")}));break;case"ttl":g.t.readTtl(this._resourceType.type,this._resourceId).then((e=>{this._resource.ttl=e;const t=this._shadow.querySelector("fhir-resource-ttl");t&&(t.source=e)})).catch((e=>{this._resource.ttl=null,$.h.show("An error occurred while reading ttl",void 0,void 0,"error")}));break;case"form":const e=this._shadow.querySelector("fhir-resource-form");e&&(e.source=this._resource.json)}const t=this._shadow.querySelector("fhir-history");t&&!t.hidden&&t.load(this._resourceType,this._resourceId)}})),g.t.addListener(this.serverChanged)}helpClick=()=>{window.open(`${g.t.helpUrl(this._resourceType.type)}#resource`,"FhirBrowserHelp")};downloadClick=()=>{let e,t,i=this.getCurrentContent();switch(i.type){case"ttl":e="data:text/plain;charset=utf-8",t="txt";break;case"xml":e="data:text/xml;charset=utf-8",t="xml";break;default:e="data:text/json;charset=utf-8",t="json"}const r=new File([i.value],this._resourceId,{type:e}),o=URL.createObjectURL(r),a=document.createElement("a");a.href=o,a.download=`${this._resourceType.type}#${r.name}.${t}`,this._shadow.appendChild(a),a.click(),this._shadow.removeChild(a),window.URL.revokeObjectURL(o)};copyClick=()=>{let e=this.getCurrentContent().value;navigator.clipboard.writeText(e).then((function(){$.h.show("Copying to clipboard was successful")}),(function(e){$.h.error("Could not copy text")}))};shareClick=()=>{let e=this.getCurrentContent().value;const t=`${this._resourceType.type}.${this._resourceId}.txt`,i=new File([e],t,{type:"text/plain"});navigator.share({title:t,files:[i]})};referenceToggleClick=()=>{const e=this._shadow.querySelector("fhir-references");e.hidden&&(this._shadow.querySelector("fhir-history").hidden=!0),e.hidden=!e.hidden};historyToggleClick=()=>{const e=this._shadow.querySelector("fhir-history");e.hidden&&(this._shadow.querySelector("fhir-references").hidden=!0,e.load(this._resourceType,this._resourceId)),e.hidden=!e.hidden};getCurrentContent=()=>{let e={};switch(this._shadow.querySelector("app-tabs").value){case"xml":e.value=this._resource.xml,e.type="xml";break;case"ttl":e.value=this._resource.ttl,e.type="ttl";break;default:e.value=JSON.stringify(this._resource.json),e.type="json"}return e};serverChanged=()=>{const e=this._shadow.querySelector("app-tabs");for(;e.firstChild;)e.removeChild(e.lastChild);if(g.t.formatEnable("json")){const e=document.createElement("fhir-resource-json"),t=document.createElement("section");t.dataset.caption="json",t.appendChild(e),this._shadow.querySelector("app-tabs").appendChild(t)}if(g.t.formatEnable("xml")){const e=document.createElement("fhir-resource-xml"),t=document.createElement("section");t.dataset.caption="xml",t.appendChild(e),this._shadow.querySelector("app-tabs").appendChild(t)}if(g.t.formatEnable("ttl")){const e=document.createElement("fhir-resource-ttl"),t=document.createElement("section");t.dataset.caption="ttl",t.appendChild(e),this._shadow.querySelector("app-tabs").appendChild(t)}if(o.y.get("experimental")){const e=document.createElement("fhir-resource-form"),t=document.createElement("section");t.dataset.caption="form",t.appendChild(e),this._shadow.querySelector("app-tabs").appendChild(t)}};load=({resourceType:e,resourceId:t})=>{e===this._resourceType&&t===this._resourceId||(this._resourceType=e,this._resourceId=t,window.matchMedia("(max-width: 480px)").matches&&(this._shadow.querySelector("fhir-references").hidden=!0,this._shadow.querySelector("fhir-history").hidden=!0),e.interaction.find((({code:e})=>"vread"==e))?this._shadow.getElementById("historyToggle").hidden=!1:(this._shadow.getElementById("historyToggle").hidden=!0,this._shadow.querySelector("fhir-history").hidden=!0),this._shadow.querySelector("fhir-references").load(e,t)?this._shadow.getElementById("referencesToggle").hidden=!1:(this._shadow.getElementById("referencesToggle").hidden=!0,this._shadow.querySelector("fhir-references").hidden=!0),this._shadow.getElementById("title").innerText=e.type,this._resource={},this._shadow.querySelector("app-tabs").value="json")}}customElements.define("fhir-resource",U),__webpack_require__(627);class j extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}app-list{flex:1 1 auto;height:0}</style> <main> <app-list></app-list> </main>",this._list=null}connectedCallback(){this._list=this._shadow.querySelector("app-list"),this._list.onclick=this.appListClick}appListClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("list-row");t&&(this.value=t.dataset.id,this.dispatchEvent(new CustomEvent("serverchanged",{bubbles:!0,cancelable:!0,detail:{serverCode:t.dataset.id}})))};load(e){this._list.clear(),Object.keys(e).sort(((e,t)=>e.localeCompare(t))).forEach((t=>{const i=document.createElement("list-row");i.setAttribute("data-id",t);const r=document.createElement("list-item");r.setAttribute("data-primary",t),r.setAttribute("data-secondary",e[t].url),i.appendChild(r),this._list.appendChild(i)}))}get value(){return this._list.querySelector("list-row[selected]")?.dataset.id}set value(e){this._list.querySelector("list-row[selected]")?.removeAttribute("selected");const t=this._list.querySelector(`list-row[data-id="${e}"]`);t&&(t.setAttribute("selected","true"),t.scrollIntoView())}}customElements.define("fhir-server-list",j);var F=new URL(__webpack_require__(156),__webpack_require__.b);const K='<link rel="stylesheet" href="'+t()(F)+'"> <style>main{position:absolute;top:0;left:0;background-color:rgba(0,0,0,32%);min-height:100%;min-width:100%}.surface{background-color:var(--background-color,#fff);border-radius:4px;position:absolute;left:50%;top:50%;transform:translateX(-50%) translateY(-50%)}.overlay{background-color:rgba(255,255,255,4%);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:Roboto,Arial,monospace;height:100%}h2{margin:.5em 1em}footer{padding:9px 16px;text-align:right;overflow:visible}@media (max-width:480px){.surface{width:90%}.overlay{background-color:transparent}}</style> <main> <div class="surface"> <div class="overlay"> <h2></h2> <slot></slot> <footer> <app-button id="btnCancel" value="cancel"></app-button> <app-button id="btnOk" value="ok"></app-button> </footer> </div> </div> </main>';class V extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=K}connectedCallback(){this._shadow.querySelector("main").onclick=this._onClose,this._shadow.querySelector(".surface").onclick=e=>{e.stopPropagation()},this._shadow.getElementById("btnOk").onclick=this.validateClick,this._shadow.getElementById("btnCancel").onclick=this._onClose}_onClose=e=>{this.hidden=!0};validateClick=e=>{this.onValidate(e),this.hidden=!0};_onValidate=e=>{};get onValidate(){return this._onValidate}set onValidate(e){this._onValidate=e}static get observedAttributes(){return["data-title","data-ok-text"]}attributeChangedCallback(e,t,i){"data-title"===e?this._shadow.querySelector("h2").innerText=i:"data-ok-text"===e&&this._shadow.getElementById("btnOk").setAttribute("value",i)}}window.customElements.define("app-confirm",V),__webpack_require__(719);class z extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%;font-family:Roboto,Arial,monospace}#content{flex:1 1 auto;height:0;padding:1em;overflow-y:auto;min-width:40em}#formDialog footer{border-top:1px solid var(--border-color)}footer{padding:9px 16px;text-align:right;overflow:hidden}p{margin:0;padding:1em}.authMethod{padding-bottom:1em}.authMethod label{font-family:inherit;font-size:inherit;margin-right:1em}@media (max-width:480px){#content{min-width:unset}}</style> <app-dialog id="formDialog" centered> <round-button slot="appBarRight" id="formDelete" title="Delete" data-icon="delete"></round-button> <main> <section id="content"> <text-field id="key" placeholder="Code" required></text-field> <text-field id="url" placeholder="Url" required></text-field> <div class="authMethod"> <input type="radio" id="No Auth" name="authMethod" value="No Auth" checked="checked"/> <label for="No Auth">No Auth</label> <input type="radio" id="API Key" name="authMethod" value="API Key"/> <label for="API Key">API Key</label> <input type="radio" id="Basic" name="authMethod" value="Basic"/> <label for="Basic">Basic</label> <input type="radio" id="OAuth 2" name="authMethod" value="OAuth 2"/> <label for="OAuth 2">OAuth 2</label> </div> <section id="apiSection" hidden> <text-field id="apiKey" placeholder="Key" required></text-field> <text-field id="apiValue" placeholder="Value" required></text-field> </section> <section id="basicSection" hidden> <text-field id="basicUsername" placeholder="Username" required></text-field> <text-field id="basicPassword" placeholder="Password" required></text-field> </section> <section id="oauthSection" hidden> <text-field id="oauthTokenurl" placeholder="Access Token URL" required></text-field> <text-field id="oauthClientid" placeholder="Client ID" required></text-field> <text-field id="oauthClientsecret" placeholder="Client Secret" required></text-field> <text-field id="oauthGranttype" placeholder="Grant Type" value="client_credentials" required readonly="readonly"></text-field> </section> </section> <footer> <app-button id="formCancel" value="Cancel"></app-button> <app-button id="formOk" value="Apply"></app-button> </footer> </main> </app-dialog> <app-confirm data-ok-text="delete" hidden> <p>Delete this configuration?</p> </app-confirm>'}static get observedAttributes(){return["data-title"]}attributeChangedCallback(e,t,i){"data-title"==e&&this._shadow.querySelector("app-dialog").setAttribute("data-title",i)}connectedCallback(){this._shadow.querySelector("app-dialog").onClose=this.appDialogClose,this._shadow.querySelectorAll("input[name='authMethod']").forEach((e=>{e.addEventListener("change",this.authMethodChange)})),this._shadow.getElementById("formCancel").onclick=this.formCancelClick,this._shadow.getElementById("formDelete").onclick=this.formDeleteClick,this._shadow.getElementById("formOk").onclick=this.formOkClick,this._shadow.querySelector("main").onkeydown=this.mainKeyDown,this._shadow.querySelector("app-confirm").onValidate=this.deleteConfirm}appDialogClose=e=>{this.onCancel(e),e.preventDefault(),e.stopPropagation()};formOkClick=e=>{this.checkValidity()&&this.onOk(e)&&(this.hidden=!0)};formCancelClick=e=>{this.onCancel(e)};formDeleteClick=()=>{this._shadow.querySelector("app-confirm").hidden=!1};deleteConfirm=e=>{this.onDelete(e),this.hidden=!0};mainKeyDown=e=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||!this.checkValidity()||this.onOk(e)&&(this.hidden=!0)};authMethodChange=()=>{const e=this._shadow.querySelector("input[name='authMethod']:checked").value;this._shadow.getElementById("apiSection").hidden="API Key"!==e,this._shadow.getElementById("basicSection").hidden="Basic"!==e,this._shadow.getElementById("oauthSection").hidden="OAuth 2"!==e};_onOk=e=>{this.hidden=!0};get onOk(){return this._onOk}set onOk(e){this._onOk=e}_onCancel=e=>{this.hidden=!0};get onCancel(){return this._onCancel}set onCancel(e){this._onCancel=e}_onDelete=()=>{this.hidden=!0};get onDelete(){return this._onDelete}set onDelete(e){this._onDelete=e}checkValidity=function(){let e=this;if(t("key")&&t("url"))switch(this._shadow.querySelector("input[name='authMethod']:checked").value){case"No Auth":return!0;case"API Key":return t("apiKey")&&t("apiValue");case"Basic":return t("basicUsername")&&t("basicPassword");case"OAuth 2":return t("oauthTokenurl")&&t("oauthClientid")&&t("oauthClientsecret")&&t("oauthGranttype")}return!1;function t(t){let i=e._shadow.getElementById(t);return!!i.checkValidity()||(i.focus(!0),!1)}};get value(){const e=this._shadow.querySelector("input[name='authMethod']:checked").value;let t={serverCode:this._shadow.getElementById("key").value,url:this._shadow.getElementById("url").value,auth:{method:"noauth",setup:{}}};switch(e){case"API Key":t.auth.method="apikey",t.auth.setup.key=this._shadow.getElementById("apiKey").value,t.auth.setup.value=this._shadow.getElementById("apiValue").value;break;case"Basic":t.auth.method="basic",t.auth.setup.username=this._shadow.getElementById("basicUsername").value,t.auth.setup.password=this._shadow.getElementById("basicPassword").value;break;case"OAuth 2":t.auth.method="oauth2",t.auth.setup.access_token_url=this._shadow.getElementById("oauthTokenurl").value,t.auth.setup.client_id=this._shadow.getElementById("oauthClientid").value,t.auth.setup.client_secret=this._shadow.getElementById("oauthClientsecret").value,t.auth.setup.grant_type=this._shadow.getElementById("oauthGranttype").value}return t}set value({serverCode:e,server:t}){switch(e?(this._shadow.querySelector("app-dialog").setAttribute("data-title",e),this._shadow.getElementById("formDelete").hidden=!1):(this._shadow.querySelector("app-dialog").setAttribute("data-title","New"),this._shadow.getElementById("formDelete").hidden=!0),this.clear(),this._shadow.getElementById("key").value=e,this._shadow.getElementById("url").value=t.url,t?.auth?.method){case"apikey":this._shadow.getElementById("API Key").checked=!0,this._shadow.getElementById("apiKey").value=t.auth.setup.key,this._shadow.getElementById("apiValue").value=t.auth.setup.value;break;case"basic":this._shadow.getElementById("Basic").checked=!0,this._shadow.getElementById("basicUsername").value=t.auth.setup.username,this._shadow.getElementById("basicPassword").value=t.auth.setup.password;break;case"oauth2":this._shadow.getElementById("OAuth 2").checked=!0,this._shadow.getElementById("oauthTokenurl").value=t.auth.setup.access_token_url,this._shadow.getElementById("oauthClientid").value=t.auth.setup.client_id,this._shadow.getElementById("oauthClientsecret").value=t.auth.setup.client_secret,this._shadow.getElementById("oauthGranttype").value=t.auth.setup.grant_type;break;default:this._shadow.getElementById("No Auth").checked=!0}this.authMethodChange()}clear(){this._shadow.getElementById("content").querySelectorAll("text-field").forEach((e=>e.value="")),this._shadow.getElementById("oauthGranttype").value="client_credentials"}}customElements.define("fhir-server-form",z);class W{static{this.KEY="conf"}static setAll(e){localStorage.setItem(this.KEY,JSON.stringify(e))}static async getAll(){let e=localStorage.getItem(this.KEY);return null===e?await fetch("./default.conf",{cache:"reload"}).then((e=>e.json())).then((e=>(localStorage.setItem(this.KEY,JSON.stringify(e)),e))):JSON.parse(e)}static async get(e){return await this.getAll().then((t=>t[e]))}}class J extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%;min-width:400px}#list{flex:1 1 auto;height:0}#setupAdd{position:absolute;bottom:4em;right:1em;background-color:var(--primary-color);border-radius:100%;color:#fff;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}footer{border-top:1px solid var(--border-color);padding:9px 16px;text-align:right;overflow:hidden}app-dialog #setupToggle,app-dialog.edit #setupAdd,app-dialog.edit footer{display:block}app-dialog #setupAdd,app-dialog footer,app-dialog.edit #setupToggle{display:none}#setupClose{display:none}@media (max-width:480px){main{min-width:none}#setupClose{display:block}}</style> <app-dialog id="serverDialog" data-title="Connections"> <round-button slot="appBarLeft" id="setupClose" title="close" data-icon="close"></round-button> <round-button slot="appBarRight" id="setupToggle" title="setup" data-icon="edit"></round-button> <main> <section id="list"> <fhir-server-list></fhir-server-list> <round-button id="setupAdd" title="add" data-icon="add"></round-button> </section> <footer> <app-button id="setupCancel" value="cancel"></app-button> <app-button id="setupOk" value="save"></app-button> </footer> </main> </app-dialog> <fhir-server-form hidden></fhir-server-form>',this._editMode=!1,this._list=null,this._form=null}connectedCallback(){this._list=this._shadow.querySelector("fhir-server-list"),this._form=this._shadow.querySelector("fhir-server-form"),this._shadow.querySelector("app-dialog").onClose=e=>{e.preventDefault(),e.stopPropagation(),this.appDialogClose()},this._form.onOk=this.serverFormOk,this._form.onDelete=this.serverFormDelete,this._list.addEventListener("serverchanged",this.serverListClick),this._shadow.getElementById("setupAdd").onclick=this.setupAddClick,this._shadow.getElementById("setupCancel").onclick=this.setupCancel,this._shadow.getElementById("setupOk").onclick=this.setupOk,this._shadow.getElementById("setupClose").onclick=this.appDialogClose,this._shadow.getElementById("setupToggle").onclick=()=>{this.editMode=!0},this.editMode=!1,this.loadConf()}loadConf=()=>{W.getAll().then((e=>{this._conf=e,this._list.load(e),this._list.value=g.t.server?.serverCode}))};setupOk=()=>{W.setAll(this._conf),this.editMode=!1,this.loadConf()};setupCancel=()=>{this.editMode=!1,this.loadConf()};setupAddClick=()=>{this.value="",this._form.value={serverCode:"",server:{url:""}},this._form.hidden=!1};serverListClick=e=>{const t=e.detail.serverCode,i=this._conf[t];this.editMode?(this._form.value={serverCode:t,server:i},this._form.hidden=!1):(this.editMode=!1,this.hidden=!0,e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("serverchanged",{bubbles:!1,cancelable:!1,detail:{serverCode:t,server:i}})))};serverFormDelete=()=>{const e=this._form.value.serverCode;return delete this._conf[e],this._list.load(this._conf),!0};serverFormOk=()=>{const e=this._form.value,t=this.value,i=e.serverCode;if(delete e.serverCode,t)delete this._conf[t];else if(this._conf[i])return $.h.show("this configuration already exists",void 0,void 0,"error"),!1;return this._conf[i]=e,this._list.load(this._conf),!0};appDialogClose=()=>{this.editMode=!1,this.hidden=!0};get value(){return this._list.value}set value(e){this._list.value=e}get editMode(){return this._editMode}set editMode(e){this._editMode=e;const t=this._shadow.querySelector("app-dialog");e?t.classList.add("edit"):t.classList.remove("edit")}}customElements.define("fhir-server-dialog",J),"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js");class X extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=r}showResource(e,t){this._shadow.getElementById("bdy").style.visibility="visible",window.matchMedia("(max-width: 480px)").matches&&this._shadow.getElementById("leftPanel").classList.add("hidden"),this._shadow.getElementById("bundle").hidden=!0,this._shadow.getElementById("resource").load({resourceType:e,resourceId:t})}showBundle(e,t){this._shadow.getElementById("bdy").style.visibility="visible",window.matchMedia("(max-width: 480px)").matches&&this._shadow.getElementById("leftPanel").classList.add("hidden");const i=this._shadow.getElementById("bundle");i.hidden=!1,i.load(e,t)}locationHandler=()=>{let e=window.location.hash.replace("#","").trim();if(e.length){let t="",i="",r=[];if(e.indexOf("?")>0)i=e.split("?")[0],r=e.slice(e.indexOf("?")+1).split("&").map((e=>{const[t,i]=e.split("=");return{name:t,value:decodeURIComponent(i)}}));else{const r=e.split("/");i=r[0],t=e.slice(i.length+1)||""}const o=g.t.server.capabilities.rest[0].resource.find((e=>e.type===i));if(!o)return void $.h.show(`Resource "${o}" not found!`);t?this.showResource(o,t):this.showBundle(o,r)}else this._shadow.getElementById("bdy").style.visibility="hidden"};connectedCallback(){window.addEventListener("hashchange",this.locationHandler),$.h.container=this._shadow,this._shadow.getElementById("navigation").addEventListener("click",(()=>{this._shadow.getElementById("leftPanel").classList.toggle("hidden")})),this._shadow.getElementById("serverDialogToggle").addEventListener("click",(()=>{const e=this._shadow.querySelector("fhir-server-dialog");e.hidden=!e.hidden})),this._shadow.querySelector("fhir-server-dialog").addEventListener("serverchanged",(({detail:e})=>{location.hash="",this.connect(e.serverCode,e.server)})),this._shadow.getElementById("aboutDialogToggle").addEventListener("click",(()=>{this._shadow.getElementById("aboutDialog").hidden=!1})),this._shadow.getElementById("aboutClose").onclick=()=>{this._shadow.getElementById("aboutDialog").hidden=!0};const e=o.y.get("server");e?W.get(e).then((t=>{this.connect(e,t)})):this._shadow.querySelector("fhir-server-dialog").hidden=!1}connect(e,t){const i=this._shadow.getElementById("waiting");i.style.visibility="visible",g.t.connect(e,t).then((()=>{$.h.show(`Connected to "${e}" server.`),o.y.set("server",e),this._shadow.getElementById("bdy").style.visibility="hidden",this._shadow.getElementById("leftPanel").classList.remove("hidden"),this._shadow.getElementById("navigation").hidden=!1,this._shadow.querySelector("fhir-server-dialog").value=e,this.locationHandler()})).catch((t=>{$.h.show(`An error occurred while connecting to the server "${e}"`,void 0,void 0,"error")})).finally((()=>{i.style.visibility="hidden"}))}}customElements.define("fhir-browser",X)})()})();