(()=>{"use strict";var __webpack_modules__={616:(e,t,o)=>{o.d(t,{Z:()=>r});const r='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}#bundleCnt{display:flex;flex-direction:column;height:100%;flex:auto;width:0}main{flex:1 1 auto;height:0;border-top:1px solid var(--border-color)}#title{margin:0;overflow:hidden;text-overflow:ellipsis}#title::first-letter{text-transform:uppercase}#table{flex:auto}bundle-search-panel{border-left:1px solid var(--border-color);flex:none;transition:all .3s;width:400px}bundle-search-panel.hidden{transition:all .3s;margin-right:-400px}footer{border-top:1px solid var(--border-color);padding:.5em;display:flex;flex-flow:row nowrap}footer>section{display:flex;flex-direction:row;align-items:center}footer>section:nth-child(2){flex-grow:1}footer span:not(:last-child){border-right:1px solid var(--border-color);padding-right:.5em;margin-right:.25em}@media (max-width:480px){bundle-search-panel{background-color:var(--background-color,#fff);position:relative;width:100%}bundle-search-panel.hidden{margin-right:-100%}}</style> <div id="wrapper"> <div id="bundleCnt"> <header> <m2-app-bar> <m2-round-button id="help" title="Help" data-icon="help" slot="left"></m2-round-button> <h3 slot="middle" id="title">Bundle</h3> <div class="toolbar" slot="right"> <m2-round-button id="settingsDialogToggle" title="Settings" data-icon="view_column"></m2-round-button> <m2-round-button id="searchToggle" title="Search" data-icon="search"></m2-round-button> </div> </m2-app-bar> </header> <main> <m2-data-table id="table"></m2-data-table> </main> <footer> <section></section> <section></section> <section> <span id="total"></span> <span> <m2-round-button id="paginationFirst" title="first" data-icon="first_page" disabled="disabled"></m2-round-button> <m2-round-button id="paginationPrevious" title="previous" data-icon="chevron_left" disabled="disabled"></m2-round-button> <m2-round-button id="paginationNext" title="next" data-icon="chevron_right" disabled="disabled"></m2-round-button> <m2-round-button id="paginationLast" title="last" data-icon="last_page" disabled="disabled"/> </span> <span> <m2-round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></m2-round-button> <m2-round-button id="download" title="Download" data-icon="download"></m2-round-button> </span> </section> </footer> </div> <bundle-search-panel id="search" class="hidden"></bundle-search-panel> </div> <bundle-columns-dialog hidden></bundle-columns-dialog>'},466:(e,t,o)=>{o.d(t,{Z:()=>r});const r='<style>main{display:flex;flex-direction:row;height:100%;overflow:hidden}#template{flex:1 1 auto;overflow:auto;padding:1em}#template fieldset{border:0;padding:0}#template fieldset>input[type=text]{border:0 none;font-family:inherit;font-size:inherit;margin-bottom:1em;background-color:inherit}#template section{display:flex;flex-flow:row wrap;align-content:flex-start;gap:.2em 1em;border:0 none;background-color:inherit;min-height:50px}#template m2-textfield.over,#template section.over,#template.drag fieldset.over,#template.drag.over{border:1px dashed #000;background-color:var(--hover-color,rgb(0 0 0 / 4%))}m2-side-panel{border-left:1px solid var(--border-color)}m2-list>*{cursor:grab}</style> <main> <section id="template"></section> <m2-side-panel data-title="Data"> <m2-linear-progress slot="main"></m2-linear-progress> <m2-list slot="main"></m2-list> </m2-side-panel> </main>'},612:(e,t,o)=>{o.d(t,{Z:()=>r});const r='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;flex-direction:column;height:100%;position:relative}#template{flex:1 1 auto;height:auto;padding:1em;overflow-y:auto}#template fieldset{border:0;padding:0}#template legend{margin-bottom:1em;text-transform:lowercase}#template legend::first-letter{text-transform:uppercase}#template section{display:flex;flex-flow:row wrap;align-content:flex-start;gap:.2em 1em;border:0 none;background-color:inherit;min-height:50px}#emptyMsg{position:absolute;top:50%;left:50%;transform:translateX(-50%) translateY(-50%);color:var(--text-color-disabled);text-align:center}#emptyMsg p>i{vertical-align:middle;font-size:inherit}.fab{position:absolute;bottom:1em;right:1em;background-color:var(--primary-color);border-radius:100%;color:#fff;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}</style> <main> <section id="template"></section> <section id="emptyMsg" hidden> <p>There is no template yet for this resource type.</p> <p> Click the edit button <i class="material-symbols-sharp">edit</i> to design your own<br/> or use the view toggle <i class="material-symbols-sharp">wysiwyg</i> to switch back to the json view. </p> </section> <m2-round-button class="fab" title="setup" data-icon="edit"></m2-round-button> </main>'},131:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _templates_Bundle_html__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(616),_components_M2AppBar__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(136),_components_M2DataTable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(714),_components_M2LinearProgress__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(453),_BundleSearchPanel__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(675),_BundleColumnsDialog__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(758),_services_Context__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(727),_services_Fhir__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(323),_services_Preferences__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(571),_services_Snackbar__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(655);class Bundle extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_templates_Bundle_html__WEBPACK_IMPORTED_MODULE_9__.Z,this._resourceType=null,this._columns=null,this._filters=[],this._dateOptions={year:"numeric",month:"2-digit",day:"2-digit"},this._timeOptions={hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"},this._columnsDialog=null,this._source=null,this._shadow.getElementById("help").onclick=this.helpClick,this._total=this._shadow.getElementById("total"),this._shadow.getElementById("paginationFirst").onclick=this.paginationClick,this._shadow.getElementById("paginationPrevious").onclick=this.paginationClick,this._shadow.getElementById("paginationNext").onclick=this.paginationClick,this._shadow.getElementById("paginationLast").onclick=this.paginationClick;const e=this._shadow.getElementById("table");e.addEventListener("rowclick",this.onRowClick),e.onColumnReorder=this.handleColumnChanged,this._shadow.getElementById("copy").onclick=this.copyClick,this._shadow.getElementById("download").onclick=this.downloadClick,this._columnsDialog=this._shadow.querySelector("bundle-columns-dialog"),this._columnsDialog.onValidate=this.handleColumnSetup,this._shadow.getElementById("settingsDialogToggle").onclick=this.settingsDialogToggleClick,this._searchToggle=this._shadow.getElementById("searchToggle"),this._searchToggle.onclick=this.searchToggleClick,this._searchPanel=this._shadow.getElementById("search")}connectedCallback(){new MutationObserver(this.searchHiddenObserver).observe(this._searchPanel,{attributes:!0})}searchHiddenObserver=e=>{e.forEach((({type:e,attributeName:t,target:o})=>{"attributes"==e&&"class"==t&&(this._searchToggle.hidden=!o.classList.contains("hidden"))}))};searchToggleClick=()=>{this._searchPanel.classList.toggle("hidden")};onRowClick=({detail:e})=>{const t=this._source.entry.find((({resource:t})=>t.id==e.resourceId));if(t){const e=t.fullUrl.replace(`${_services_Context__WEBPACK_IMPORTED_MODULE_5__.Z.server.url}`,"");location.hash=`#${e}`}};handleColumnSetup=e=>{let t=this._columns.filter((t=>e.includes(t)));t.push(...e.filter((e=>!t.includes(e)))),this.handleColumnChanged(t)};handleColumnChanged=e=>{this._columns=e;const t=this._shadow.getElementById("table");t.clear(),this._columns.forEach((e=>t.addColumn(e))),this.parsePage(this._source);const o=_services_Preferences__WEBPACK_IMPORTED_MODULE_7__.Z.get("columns",{});o[this._resourceType.type]=this._columns,_services_Preferences__WEBPACK_IMPORTED_MODULE_7__.Z.set("columns",o)};settingsDialogToggleClick=()=>{this._columnsDialog.load(this._resourceType.type,this._columns),this._columnsDialog.hidden=!1};paginationClick=({target:e})=>{if("m2-round-button"!=e.localName)return;let t=e.dataset.url;t=t.replace(`${_services_Context__WEBPACK_IMPORTED_MODULE_5__.Z.server.url}`,""),location.hash=`#${t}`};helpClick=()=>{window.open(_services_Fhir__WEBPACK_IMPORTED_MODULE_6__.Z.helpUrl(this._resourceType.type),"FhirBrowserHelp")};copyClick=()=>{navigator.clipboard.writeText(JSON.stringify(this._source)).then((function(){_services_Snackbar__WEBPACK_IMPORTED_MODULE_8__.Z.show("Copying to clipboard was successful")}),(function(e){console.error("Async: Could not copy text: ",e)}))};downloadClick=()=>{const e=this._resourceType.type,t=new File([JSON.stringify(this._source)],e,{type:"data:text/json;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${e}.json`,this._shadow.appendChild(r),r.click(),this._shadow.removeChild(r),window.URL.revokeObjectURL(o)};get resourceType(){return this._resourceType}beautifyDate(e){const t=new Date(e);try{return`${t.toLocaleString(void 0,this._dateOptions)}<br>${t.toLocaleString(void 0,this._timeOptions)}`}catch(t){return e}}parsePage(data){if(this._total.hidden=!0,data.total&&(this._total.hidden=!1,this._total.innerHTML=`Total:&nbsp;${data.total}`),data.entry){const dataTable=this._shadow.getElementById("table");data.entry.forEach((entry=>{let row={};this._columns.forEach((column=>{let value=entry.resource,path=column.split(".");path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx==path.length-1?value.join(", "):value[0]),!0)))),"meta.lastUpdated"===column&&(value=this.beautifyDate(value)),row[column]=value||""})),dataTable.addRow(entry.resource.id,row)}));const buttons={first:this._shadow.getElementById("paginationFirst"),previous:this._shadow.getElementById("paginationPrevious"),prev:this._shadow.getElementById("paginationPrevious"),next:this._shadow.getElementById("paginationNext"),last:this._shadow.getElementById("paginationLast")};Object.entries(buttons).forEach((([,e])=>{e.setAttribute("disabled",""),e.removeAttribute("data-relation"),e.removeAttribute("data-url")})),data.link?.forEach((({relation:e,url:t})=>{buttons[e]?.removeAttribute("disabled"),buttons[e]?.setAttribute("data-relation",e),buttons[e]?.setAttribute("data-url",t)}))}}set source(e){let t,o=!1;if(e.entry?.length){const r=[...new Set(e.entry.map((e=>e.resource.resourceType)))];o=1==r.length,t=o?r[0]:"Bundle"}else{const e=window.location.hash.replace("#/","").trim();t=RegExp(/^\w+/).exec(e)[0]}this._resourceType=_services_Context__WEBPACK_IMPORTED_MODULE_5__.Z.server.capabilities.rest[0].resource.find((e=>e.type===t));let r=t;if(o){const e=_services_Preferences__WEBPACK_IMPORTED_MODULE_7__.Z.get("columns",{});this._columns=e[t]||["id","meta.lastUpdated"],this._shadow.getElementById("settingsDialogToggle").hidden=!1,this._searchPanel.hidden=!1}else this._shadow.getElementById("settingsDialogToggle").hidden=!0,this._searchPanel.hidden=!0,this._columns=["resourceType","id"],"Bundle"==t&&(r=`${e.type} ${r.toLowerCase()}`);this._shadow.getElementById("title").innerText=r;const i=this._shadow.getElementById("table");i.clear(),this._columns.forEach((e=>i.addColumn(e))),this._source=e,this.parsePage(e)}}customElements.define("fhir-bundle",Bundle)},758:(e,t,o)=>{o(696),o(840),o(718),o(453),o(889);class r extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{padding:.5em 1em;background-color:inherit;display:flex;flex-direction:row;align-items:center}main:hover,main[selected]{background-color:var(--hover-color,rgba(0,0,0,5%))}div{flex-grow:1}input[type=checkbox]{margin-left:1em}</style> <main> <div> <slot></slot> </div> <input type="checkbox"> </main>',e.querySelector("main").onclick=this.onclick,this._checkbox=e.querySelector("input[type=checkbox]")}static get observedAttributes(){return["selected"]}attributeChangedCallback(e,t,o){"selected"===e&&(this._checkbox.checked=null!==o)}onclick=e=>{null!==this.getAttribute("selected")?this.removeAttribute("selected"):this.setAttribute("selected","")}}customElements.define("m2-list-row-check",r);var i=o(727),a=o(323);class s extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}footer{border-top:1px solid var(--border-color);padding:.5em 1em;text-align:right;overflow:hidden}</style> <m2-dialog id="settingsDialog" data-title="Settings"> <main> <m2-linear-progress></m2-linear-progress> <m2-list></m2-list> <footer> <m2-button id="btnCancel">Cancel</m2-button> <m2-button id="btnOk">Apply</m2-button> </footer> </main> </m2-dialog>',this._resourceType=null,this._release=null,this._onValidate=()=>{},this._list=null,this._shadow.querySelector("m2-dialog").onClose=this.appDialogClose,this._list=this._shadow.querySelector("m2-list"),this._list.onFilter=this.appListFilter,this._shadow.getElementById("btnCancel").onclick=this.btnCancelClick,this._shadow.getElementById("btnOk").onclick=this.btnOkClick}btnOkClick=e=>{e.preventDefault(),e.stopPropagation(),this.hidden=!0;const t=Array.from(this._list.querySelectorAll("m2-list-row-check[selected]")).map((e=>e.dataset.id));this._onValidate(t)};btnCancelClick=()=>{this.hidden=!0};appListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!e.dataset.id.toLowerCase().includes(t)}))};appDialogClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};get onValidate(){return this._onValidate}set onValidate(e){this._onValidate=e}checkValues=e=>{Array.from(this._list.querySelectorAll("m2-list-row-check")).forEach((t=>{e.includes(t.dataset.id)?t.setAttribute("selected",""):t.removeAttribute("selected")}))};load=(e,t)=>{e!==this._resourceType||i.Z.server.release!==this._release?(this._resourceType=e,this._release=i.Z.server.release,this._list.clear(),this._shadow.querySelector("m2-linear-progress").hidden=!1,function e(t,o){return new Promise((r=>{const i=[];a.Z.structureDefinition(t).then((t=>{const a=[];t.snapshot.element.filter((e=>e.isSummary&&e.type)).forEach((t=>{const r=t.path.substr(t.path.indexOf(".")+1);if(!o.includes(`${r}.`)){const s=(o?`${o}.`:"")+r,l=t.type[0].code;l.match(/^([A-Z][a-z]+)+$/)?a.push(e(l,s)):i.push({id:s,path:s,short:t.short,type:l})}})),a.length>0?Promise.all(a).then((e=>{e.forEach((e=>i.push(...e))),r(i)})):r(i)}))}))}(e,"").then((e=>{e.sort(((e,t)=>e.path.localeCompare(t.path))),e.forEach((e=>{const t=document.createElement("m2-list-item");t.setAttribute("data-primary",e.path),t.setAttribute("data-secondary",e.short);const o=document.createElement("m2-list-row-check");o.setAttribute("data-id",e.id),o.appendChild(t),this._list.appendChild(o)})),this._shadow.querySelector("m2-linear-progress").hidden=!0,this.checkValues(t)}))):this.checkValues(t)}}customElements.define("bundle-columns-dialog",s)},675:(e,t,o)=>{o(19);class r extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray;display:flex;flex-direction:row;flex-wrap:wrap}main:focus-within,main:focus-within input{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:4px 5px;max-width:120px;min-width:100px}input:focus{outline:0}</style> <main> <input type="date"> <input type="time"> </main>',this._date=e.querySelector('input[type="date"]'),this._time=e.querySelector('input[type="time"]')}get value(){if(this._date.value){let e=new Date(`${this._date.value}T${this._time.value||"00:00"}`);return new Date(e.getTime()).toISOString()}return null}set value(e){this._date.value="",this._time.value=""}}customElements.define("bundle-search-date",r);class i extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px;width:90px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input placeholder="Modifier" list="FhirSearchFieldModifierList"> <datalist id="FhirSearchFieldModifierList"> <option value="contains"></option> <option value="exact"></option> </datalist> </main>',this._input=e.querySelector("input")}get value(){return this._input.value}set value(e){this._input.value=e}}customElements.define("bundle-search-modifier",i);class a extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px;width:90px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input placeholder="Prefix" list="FhirSearchPrefixList"> <datalist id="FhirSearchPrefixList"> <option value="eq">Is equal to</option> <option value="ne">is not equal to</option> <option value="gt">is greater than</option> <option value="lt">is less than</option> <option value="ge">is greater or equal to</option> <option value="le">is less or equal to</option> </datalist> </main>',this._input=e.querySelector("input")}get value(){return this._input.value}set value(e){this._input.value=e}}customElements.define("bundle-search-prefix",a);class s extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{background-color:var(--hover-color);border-bottom:1px solid gray;display:flex}main:focus-within{border-color:var(--primary-color)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;color:var(--text-color-normal);flex:auto;font:inherit;padding:5px}input:focus{outline:0;border-color:var(--primary-color)}</style> <main> <input type="text" spellcheck="false"> </main>',this._input=e.querySelector("input")}static get observedAttributes(){return["placeholder"]}attributeChangedCallback(e,t,o){"placeholder"==e&&this._input.setAttribute("placeholder",o)}get value(){return this._input.value}set value(e){this._input.value=e}}customElements.define("bundle-search-text",s);class l extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML="<style>main{margin-bottom:1em}fieldset{display:flex;flex-direction:row;border:none;padding:0;gap:1em}fieldset:focus-within legend{font-weight:700;color:var(--primary-color)}bundle-search-date,bundle-search-text{flex:auto}span{color:var(--text-color-disabled);font-size:small;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;padding-top:2px}</style> <main> <fieldset> <legend inert></legend> <slot></slot> </fieldset> <span inert></span> </main>"}clear(){this._shadow.querySelectorAll("bundle-search-text, bundle-search-date, bundle-search-modifier, bundle-search-prefix").forEach((e=>e.value=""))}set value(e){let t;const o=e.value.split("|"),r=e.name.split(":");switch(this._search.type){case"token":t=this._shadow.querySelector("bundle-search-text:not([data-type])"),o[1]?(this._shadow.querySelector('bundle-search-text[data-type="system"]').value=o[0],t.value=o[1]):t.value=o[0];break;case"string":case"reference":r[1]&&(this._shadow.querySelector("bundle-search-modifier").value=r[1]),t=this._shadow.querySelector("bundle-search-text"),t.value=e.value}}get value(){let e;switch(this._search.type){case"token":let t="";const o=this._shadow.querySelector('bundle-search-text[data-type="system"]');return o?.value&&(t=`${o.value}|`),e=this._shadow.querySelector("bundle-search-text:not([data-type])"),e?.value&&(t+=e.value),t?{name:this._search.name,value:t}:null;case"string":case"reference":if(e=this._shadow.querySelector("bundle-search-text"),e?.value){let t=this._search.name;const o=this._shadow.querySelector("bundle-search-modifier");return o?.value&&(t+=`:${o.value}`),{name:t,value:e.value}}break;case"date":case"datetime":if(e=this._shadow.querySelector("bundle-search-date"),e?.value){let t=e.value;const o=this._shadow.querySelector("bundle-search-prefix");return o?.value&&(t=o.value+t),{name:this._search.name,value:t}}}return null}get name(){return this._search.name}init(e){function t(e,t){let r=document.createElement("bundle-search-text");r.setAttribute("name",e.name),t&&r.setAttribute("placeholder",t),o.appendChild(r)}if("_format"===e.name)return!1;this._search=e,this._shadow.querySelector("legend").innerText=e.name,this._shadow.querySelector("span").innerText=e.documentation||"";const o=this._shadow.querySelector("fieldset");let r;if("_id"==e.name)t(e);else if("_filter"==e.name)t(e);else switch(e.type){case"token":!function(e){let t=document.createElement("bundle-search-text");t.setAttribute("placeholder","System"),t.setAttribute("data-type","system"),t.setAttribute("name",e.name),o.appendChild(t)}(e),t(e,"code");break;case"string":case"reference":!function(e){let t=document.createElement("bundle-search-modifier");t.setAttribute("data-name",e.name),o.appendChild(t)}(e),t(e);break;case"date":case"datetime":r=document.createElement("bundle-search-prefix"),r.setAttribute("data-name",e.name),o.appendChild(r),r=document.createElement("bundle-search-date"),r.setAttribute("name",e.name),o.appendChild(r);break;default:return!1}return!0}}customElements.define("bundle-search-item",l);var n=o(727),c=o(323);class d extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}section{display:flex;flex-direction:column;height:100%}main{padding:.5em;overflow:hidden auto;flex:1 1 auto;height:0}footer{border-top:1px solid var(--border-color);padding:.5em;text-align:center;overflow:hidden}@media (max-width:480px){.surface{left:0;right:unset;width:100%;max-width:unset;max-height:unset}.overlay{background-color:transparent}}</style> <m2-side-panel data-title="Search"> <m2-round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></m2-round-button> <m2-round-button id="clear" title="Clear" data-icon="clear_all" slot="appBarRight"></m2-round-button> <m2-round-button id="close" title="Close" data-icon="close" slot="appBarRight"></m2-round-button> <section slot="main"> <main></main> <footer> <m2-button id="apply">search</m2-button> </footer> </section> </m2-side-panel>',e.getElementById("close").onclick=this.sidePanelClose,e.getElementById("clear").onclick=this.clearClick,e.getElementById("help").onclick=this.helpClick,e.getElementById("apply").onclick=this.applyClick,this._main=e.querySelector("main"),this._main.addEventListener("keydown",this.mainKeyDown),this._resourceType=null}connectedCallback(){window.addEventListener("hashchange",this.locationHandler),this.locationHandler()}mainKeyDown=e=>{["Enter","NumpadEnter"].includes(e.code)&&this.applyClick(e)};applyClick=e=>{e.preventDefault(),e.stopPropagation(),window.matchMedia("(max-width: 480px)").matches&&this.classList.add("hidden");const t=[];this._main.querySelectorAll("bundle-search-item").forEach((({value:e})=>{e&&t.push(`${e.name}=${encodeURIComponent(e.value)}`)})),location.hash=`#/${this._resourceType.type}?${t.length?t.join("&")+"&":""}_summary=true&_format=json`};helpClick=e=>{window.open(c.Z.helpUrl("search"),"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};clearClick=e=>{this.clear(),e.preventDefault(),e.stopPropagation()};sidePanelClose=e=>{this.classList.add("hidden"),e.preventDefault(),e.stopPropagation()};locationHandler=async()=>{let e=window.location.hash.replace("#/","").trim();if(!e||e.indexOf("/")>0)return;const t=e.split("?")[0];if(!t)return;for(;!n.Z.server;)await r(1e3);const o=n.Z.server.capabilities.rest[0].resource.find((e=>e.type===t));if(o){o.type!==this._resourceType?.type&&(this._resourceType=o,this.metadata=o),this.clear();const t=new URLSearchParams(e.replace(/^[^?]+\?/,""));Array.from(t).forEach((([e,t])=>{const o=e.split(":")[0],r=this._main.querySelector(`bundle-search-item[data-name="${o}"`);r&&(r.value={name:e,value:t})}))}function r(e){return new Promise((t=>{setTimeout(t,e)}))}};clear(){this._main.querySelectorAll("bundle-search-item").forEach((e=>e.clear()))}set metadata(e){for(this._main.scrollTop=0;this._main.firstChild;)this._main.removeChild(this._main.lastChild);e?.searchParam.sort(((e,t)=>e.name.localeCompare(t.name))).forEach((e=>{const t=document.createElement("bundle-search-item");t.init(e)&&(t.setAttribute("data-name",e.name),this._main.appendChild(t))}))}}customElements.define("bundle-search-panel",d)},664:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _templates_ResourceTemplateEditor_html__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(466),_components_M2List__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(718),_components_M2SidePanel__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(489),_components_M2TextField__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(147),_services_Fhir__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(323);class ResourceTemplateEditor extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_templates_ResourceTemplateEditor_html__WEBPACK_IMPORTED_MODULE_4__.Z,this._resource=null,this._dragSrcEl=null,this._template=this._shadow.getElementById("template");const e=this._shadow.querySelector("main");e.ondragstart=this.onDragStart,e.ondragover=this.onDragOver,e.ondragenter=this.onDragEnter,e.ondragleave=this.onDragLeave,e.ondragend=this.onDragEnd,e.ondrop=this.onDragDrop,this._list=this._shadow.querySelector("m2-list"),this._list.onFilter=this.dataListFilter}dataListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!e.dataset.id.toLowerCase().includes(t)}))};clear=()=>{for(;this._template.firstChild;)this._template.removeChild(this._template.lastChild)};buildTemplate=e=>{this.clear(),e.forEach((e=>{const t=this.createFieldset(e.label);e.row.forEach((e=>{const o=this.createSection();e.forEach((e=>{o.appendChild(this.createField(e.name,e.placeholder))})),t.appendChild(o)})),this._template.appendChild(t)}))};createFieldset=(e="unamed")=>{const t=document.createElement("fieldset");t.setAttribute("draggable","true");const o=document.createElement("input");return o.setAttribute("spellcheck","false"),o.type="text",o.classList.add("label"),o.value=e,t.appendChild(o),t};createSection=()=>{const e=document.createElement("section");return e.setAttribute("draggable","true"),e};createField=(e,t)=>{const o=document.createElement("m2-textfield");return o.id=e,o.setAttribute("placeholder",t),o.setAttribute("readonly",""),o.setAttribute("draggable","true"),o};setValues=e=>{Array.from(this._shadow.querySelectorAll("m2-textfield")).forEach((t=>{let o="";t.id&&(o=this.calcValue(e,t.id)),t.setAttribute("value",o)}))};calcValue=(resource,id)=>{let value=resource;const path=id.split(".");return path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx==path.length-1?value.join(", "):value[0]),!0)))),value||""};get source(){return this._resource}set source(e){this._resource=e,this.loadData(this._resource.resourceType),this.setValues(this._resource)}set template(e){e?(this.buildTemplate(e),this.cleanEmpty()):this.clear()}get template(){let e=[];return Array.from(this._template.childNodes).filter((e=>"fieldset"==e.localName)).forEach((t=>e.push(function(e){let t={label:"",row:[]};return Array.from(e.childNodes).forEach((e=>{"input"==e.localName?t.label=e.value:"section"==e.localName&&t.row.push(function(e){let t=[];return Array.from(e.childNodes).filter((e=>"m2-textfield"==e.localName)).forEach((e=>{return t.push({placeholder:(o=e).getAttribute("placeholder"),name:o.id});var o})),t}(e))})),t}(t)))),e}loadData=e=>{this._list.clear(),this._shadow.querySelector("m2-linear-progress").hidden=!1,function e(t,o){return new Promise((r=>{const i=[];_services_Fhir__WEBPACK_IMPORTED_MODULE_3__.Z.structureDefinition(t).then((t=>{const a=[];t.snapshot.element.filter((e=>e.type)).forEach((t=>{const r=t.path.substr(t.path.indexOf(".")+1);if(!o.includes(`${r}.`)){const s=(o?`${o}.`:"")+r,l=t.type[0].code;l.match(/^([A-Z][a-z]+)+$/)?a.push(e(l,s)):i.push({id:s,path:s,short:t.short,type:l})}})),a.length>0?Promise.all(a).then((e=>{e.forEach((e=>i.push(...e))),r(i)})):r(i)}))}))}(e,"").then((e=>{e.sort(((e,t)=>e.path.localeCompare(t.path))),e.forEach((e=>{const t=document.createElement("m2-list-item");t.setAttribute("data-icon","drag_indicator"),t.setAttribute("data-primary",e.path),t.setAttribute("data-secondary",e.short);const o=document.createElement("m2-list-row");o.setAttribute("draggable","true"),o.setAttribute("data-id",e.id),o.appendChild(t),this._list.appendChild(o)})),this._shadow.querySelector("m2-linear-progress").hidden=!0}))};cleanEmpty=()=>{Array.from(this._template.querySelectorAll("section:not(:has(m2-textfield))")).forEach((e=>e.remove())),Array.from(this._template.querySelectorAll("fieldset:not(:has(section))")).forEach((e=>e.remove()))};isDropAvailable=(e,t)=>e!=t&&("template"==t.id||null==t.closest("#template")||"fieldset"==e.localName&&("template"==t.id||"fieldset"==t.localName)||"section"==e.localName&&("template"==t.id||"fieldset"==t.localName||"section"==t.localName)||"m2-textfield"==e.localName&&("template"==t.id||"fieldset"==t.localName||"section"==t.localName||"m2-textfield"==t.localName)||"m2-list-row"==e.localName&&("template"==t.id||"fieldset"==t.localName||"section"==t.localName||"m2-textfield"==t.localName));onDragStart=e=>{this._template.classList.add("drag"),this._dragSrcEl=e.target,this._dragSrcEl.style.opacity="0.4"};onDragEnter=e=>{e.target?.classList.add("over")};onDragLeave=e=>{e.target?.classList.remove("over")};onDragOver=e=>(e.preventDefault(),this.isDropAvailable(this._dragSrcEl,e.target)?e.dataTransfer.dropEffect="move":e.dataTransfer.dropEffect="none",!1);onDragDrop=e=>{e.stopPropagation();let t=e.target,o=this._dragSrcEl;if(this.isDropAvailable(this._dragSrcEl,t)){if(null==t.closest("#template"))this._dragSrcEl.remove();else{if(this._dragSrcEl.parentNode==t.parentNode){const e=Array.from(t.parentNode.childNodes);e.findIndex((e=>e==this._dragSrcEl))<e.findIndex((e=>e==t))&&(t=t.nextSibling)}if("m2-list-row"==o.localName){const e=this._dragSrcEl.dataset.id;if(o=this.createField(e,e.split(".").pop()),o.setAttribute("value",this.calcValue(this._resource,e)),"template"==t.id){const e=this.createSection();e.appendChild(o);const r=this.createFieldset();r.appendChild(e),t.appendChild(r)}else if("fieldset"==t.localName){const e=this.createSection();e.appendChild(o),t.appendChild(e)}else"section"==t.localName?t.appendChild(o):"m2-textfield"==t.localName&&t.parentNode.insertBefore(o,t)}else if("fieldset"==o.localName)"template"==t.id?t.appendChild(o):"fieldset"==t.localName&&t.parentNode.insertBefore(o,t);else if("section"==o.localName)if("template"==t.id){const e=this.createFieldset();e.appendChild(o),t.appendChild(e)}else"fieldset"==t.localName?t.appendChild(o):"section"==t.localName&&t.parentNode.insertBefore(o,t);else if("m2-textfield"==o.localName)if("template"==t.id){const e=this.createSection();e.appendChild(o);const r=this.createFieldset();r.appendChild(e),t.appendChild(r)}else if("fieldset"==t.localName){const e=this.createSection();e.appendChild(o),t.appendChild(e)}else"section"==t.localName?t.appendChild(o):"m2-textfield"==t.localName&&t.parentNode.insertBefore(o,t)}this.cleanEmpty()}return!1};onDragEnd=e=>{this._dragSrcEl.style.opacity="1",this._dragSrcEl=null,this._template.classList.remove("drag"),this._template.querySelectorAll('[class~="over"]').forEach((e=>e.classList.remove("over")))}}customElements.define("resource-template-editor",ResourceTemplateEditor)},154:()=>{class e extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML='<style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%}resource-template-editor{flex:1 1 auto;height:0}footer{border-top:1px solid var(--border-color);text-align:center;padding:.5em}</style> <m2-dialog data-title="Template" fullscreen centered> <main> <resource-template-editor></resource-template-editor> <footer> <m2-button id="cancel">cancel</m2-button> <m2-button id="save">save</m2-button> </footer> </main> </m2-dialog>',this._shadow.querySelector("m2-dialog").onClose=this.dialogOnClose,this._shadow.getElementById("cancel").onclick=this.dialogOnClose,this._shadow.getElementById("save").onclick=this.onSave,this._editor=this._shadow.querySelector("resource-template-editor"),this._dialog=this._shadow.querySelector("m2-dialog")}_onClose=()=>{};get onClose(){return this._onClose}set onClose(e){this._onClose=e}dialogOnClose=e=>{e.preventDefault(),e.stopPropagation(),this.remove()};onSave=()=>{const e=JSON.parse(localStorage.getItem("templates")||"{}");e[this._editor.source.resourceType]=this._editor.template,localStorage.setItem("templates",JSON.stringify(e)),this.remove(),this._onClose()};set source(e){const t=JSON.parse(localStorage.getItem("templates")||"{}");this._editor.template=t[e.resourceType],this._editor.source=e,this._dialog.dataset.title=`${e.resourceType} template`}}customElements.define("resource-template-editor-dialog",e)},898:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _templates_ResourceTemplateView_html__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(612),_components_M2TextField__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(147),_ResourceTemplateEditor__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(664),_ResourceTemplateEditorDialog__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(154),_services_Context__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(727);class ResourceTemplateView extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.innerHTML=_templates_ResourceTemplateView_html__WEBPACK_IMPORTED_MODULE_4__.Z,this._template=this._shadow.getElementById("template"),this._resource=null,this._templateEditorButton=this._shadow.querySelector('m2-round-button[class~="fab"]'),this._templateEditorButton.onclick=this.showEditor,this._emptyMsg=this._shadow.getElementById("emptyMsg")}clear(){for(;this._template.firstChild;)this._template.removeChild(this._template.lastChild)}buildTemplate=e=>{this.clear(),e.forEach((e=>{const t=this.createFieldset(e.label);e.row.forEach((e=>{const o=this.createSection();e.forEach((e=>{o.appendChild(this.createField(e.name,e.placeholder))})),t.appendChild(o)})),this._template.appendChild(t)}))};createFieldset=e=>{const t=document.createElement("fieldset"),o=document.createElement("legend");return o.innerText=e,t.appendChild(o),t};createSection=()=>document.createElement("section");createField=(e,t)=>{const o=document.createElement("m2-textfield");return o.id=e,o.setAttribute("placeholder",t),o.setAttribute("readonly",""),o};setValues=e=>{Array.from(this._shadow.querySelectorAll("m2-textfield")).forEach((t=>{let o="";t.id&&(o=this.calcValue(e,t.id)),t.setAttribute("value",o)}))};calcValue=(resource,id)=>{let value=resource;const path=id.split(".");return path.every(((expr,idx)=>(value=eval("value[expr]"),null!=value&&(Array.isArray(value)&&(value=idx==path.length-1?value.join(", "):value[0]),!0)))),value||""};set source(e){if(!e)return;const t=JSON.parse(localStorage.getItem("templates")||"{}")[e.resourceType];this._emptyMsg.hidden=t,t?(this.buildTemplate(t),this.cleanEmpty(),this.setValues(e)):this.clear(),this._resource=e}cleanEmpty=()=>{Array.from(this._template.querySelectorAll("section:not(:has(m2-textfield))")).forEach((e=>e.remove())),Array.from(this._template.querySelectorAll("fieldset:not(:has(section))")).forEach((e=>e.remove()))};showEditor=()=>{this._editor=document.createElement("resource-template-editor-dialog"),this._editor.source=this._resource,this._editor.onClose=()=>{this.source=this._resource},_services_Context__WEBPACK_IMPORTED_MODULE_3__.Z.appContainer.appendChild(this._editor)}}customElements.define("resource-template-view",ResourceTemplateView)},136:()=>{class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML='<style>main{align-items:center;display:flex;flex-direction:row;padding:.5em;flex-wrap:wrap;justify-content:flex-end}#barMiddle{flex-grow:1;margin:0;overflow:hidden;padding-left:.5em;font-size:1.17em;font-weight:700}#barRight{white-space:nowrap}</style> <main> <section id="barLeft"> <slot name="left"></slot> </section> <section id="barMiddle"> <slot name="middle"></slot> </section> <section id="barRight"> <slot name="right"></slot> </section> </main>'}}window.customElements.define("m2-app-bar",e)},696:()=>{class e extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>button{background:0 0;border:1px solid transparent;border-radius:4px;font:inherit;padding:5px 16px;text-transform:uppercase}button:not([disabled]){color:var(--primary-color);cursor:pointer}button:not([disabled]):hover{background-color:var(--hover-color);cursor:pointer}button[disabled]{color:var(--text-color-disabled)}</style> <button type="button"> <slot></slot> </button>',this._input=e.querySelector("button")}static get observedAttributes(){return["value","disabled"]}attributeChangedCallback(e,t,o){"value"==e?this._input.innerText=o:"disabled"==e&&(null===o?this._input.removeAttribute("disabled"):this._input.setAttribute("disabled",""))}}window.customElements.define("m2-button",e)},714:()=>{class e extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}div{height:100%;overflow:auto}table{border-collapse:collapse;min-width:100%;white-space:nowrap}thead{background-color:var(--background-color);box-shadow:0 2px 4px var(--border-color);position:sticky;top:0}td,th{height:56px;padding:1px 16px;text-align:left}th{text-transform:capitalize;cursor:grab}tbody tr{border-bottom:1px solid var(--border-color,gray);cursor:pointer}tbody tr td::first-line{font-size:medium}tbody tr td{font-size:smaller}tbody tr.selected,tbody tr:hover{background-color:var(--hover-color,rgb(0 0 0 / 4%))}tr.drag th.over{background-color:var(--hover-color,rgb(0 0 0 / 4%))}</style> <div> <table> <thead> <tr id="header"></tr> </thead> <tbody id="body"></tbody> </table> </div>',this._header=e.getElementById("header"),this._header.ondragstart=this.onDragStart,this._header.ondragover=this.onDragOver,this._header.ondragenter=this.onDragEnter,this._header.ondragleave=this.onDragLeave,this._header.ondragend=this.onDragEnd,this._header.ondrop=this.onDragDrop,this._body=e.getElementById("body"),this._body.onclick=this.bodyClick}_onColumnReorder=()=>{};get onColumnReorder(){return this._onColumnReorder}set onColumnReorder(e){this._onColumnReorder=e}addColumn=e=>{const t=document.createElement("th");t.dataset.id=e,t.setAttribute("draggable","true"),t.appendChild(document.createTextNode(e)),this._header.appendChild(t)};addRow=(e,t)=>{let o=document.createElement("tr");o.id=e,Object.entries(t).forEach((([,e])=>{o.insertAdjacentHTML("beforeend",`<td>${e}</td>`)})),this._body.appendChild(o)};bodyClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("tr");t&&(this._body.querySelector("tr[class~=selected]")?.classList.remove("selected"),t.classList.add("selected"),this.dispatchEvent(new CustomEvent("rowclick",{bubbles:!1,cancelable:!1,detail:{resourceId:t.id}})))};clear=()=>{for(;this._header.firstChild;)this._header.removeChild(this._header.lastChild);this.removeAll()};removeAll=()=>{for(;this._body.firstChild;)this._body.removeChild(this._body.lastChild)};onDragStart=e=>{const t=e.target.closest("th");t.style.opacity="0.4",this._header.classList.add("drag"),this.dragSrcEl=t};onDragEnter=e=>{e.target.closest("th")?.classList.add("over")};onDragLeave=e=>{e.target.closest("th")?.classList.remove("over")};onDragOver=e=>{e.preventDefault();const t=e.target.closest("th");return this.dragSrcEl==t?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move",!1};onDragDrop=e=>{e.stopPropagation();let t=e.target.closest("th");if(this.dragSrcEl!=t){const e=Array.from(this._header.childNodes);e.findIndex((e=>e==this.dragSrcEl))<e.findIndex((e=>e==t))&&(t=t.nextSibling),this._header.insertBefore(this.dragSrcEl,t),this.dragSrcEl=null,this._onColumnReorder(Array.from(this._header.childNodes).map((e=>e.dataset.id)))}return!1};onDragEnd=e=>{e.target.closest("th").style.opacity="1",this._header.classList.remove("drag"),this._header.childNodes.forEach((e=>e.classList.remove("over")))}}customElements.define("m2-data-table",e)},840:()=>{class e extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{position:absolute;top:0;left:0;background-color:rgba(0,0,0,32%);min-height:100%;min-width:100%}.surface{background-color:var(--background-color,#fff);border-radius:4px;height:60%;max-width:50%;position:absolute;top:1em;right:1em}.surface.centered{left:50%;right:unset;top:50%;transform:translateX(-50%) translateY(-50%)}.surface.fullscreen{width:95%;height:95%;max-width:unset}.overlay{background-color:rgba(255,255,255,4%);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:var(--font-family);height:100%}#title{margin:.5em 0}#content{overflow:hidden;flex:1 1 auto;height:0}@media (max-width:480px){.surface,.surface.centered,.surface.fullscreen{top:0;left:0;right:unset;bottom:unset;transform:unset;height:100%;width:100%;max-height:unset;max-width:unset}.overlay{background-color:transparent}}</style> <main> <div class="surface"> <div class="overlay"> <section id="header"> <m2-app-bar> <section slot="left"> <slot name="appBarLeft"></slot> </section> <h3 id="title" slot="middle"></h3> <section slot="right"> <slot name="appBarRight"></slot> </section> </m2-app-bar> </section> <section id="content"> <slot></slot> </section> </div> </div> </main>',e.querySelector("main").addEventListener("click",(e=>this.onClose(e))),this._surface=e.querySelector(".surface"),this._surface.addEventListener("click",(e=>e.stopPropagation())),this._title=e.getElementById("title")}connectedCallback(){window.addEventListener("hashchange",(e=>this.onClose(e)))}_onClose=()=>{this.hidden=!0};get onClose(){return this._onClose}set onClose(e){this._onClose=e}static get observedAttributes(){return["data-title","centered","fullscreen"]}attributeChangedCallback(e,t,o){"centered"==e?this._surface.classList.add("centered"):"fullscreen"==e?this._surface.classList.add("fullscreen"):"data-title"===e&&(this._title.innerText=o)}}window.customElements.define("m2-dialog",e)},453:()=>{class e extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML='<style>main{background-color:var(--border-color);overflow:hidden}.thumb{height:.2em;width:50%;background-color:var(--primary-color);left:-50%;position:relative;animation:loading 2s ease-in .5s infinite}@keyframes loading{0%{transform:translateX(0)}to{transform:translateX(400%)}}</style> <main> <div class="thumb"/> </main>'}}customElements.define("m2-linear-progress",e)},718:()=>{class e extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;padding:.7em;font-size:smaller}main:focus-within{border-bottom-color:var(--primary-color,#000)}#text{background:0 0;border:0 none;color:var(--text-color-normal);flex:1 1 auto;font-family:inherit;font-size:inherit}#text:focus{outline:0}#clear{cursor:pointer;font-size:inherit;line-height:unset}</style> <main> <input id="text" type="text" placeholder="Type to filter" spellcheck="false"/> <i id="clear" class="material-symbols-sharp" title="clear">close</i> </main>',this._text=e.getElementById("text"),this._text.addEventListener("input",(()=>{this._onChange(this._text.value)})),e.querySelector("main").addEventListener("mousedown",(e=>{this._text.focus()})),e.getElementById("clear").onclick=this.clearClick}clearClick=()=>{this._text.value&&(this._text.value="",this._onChange(this._text.value))};clear(){this.clearClick()}_onChange=()=>{};get onChange(){return this._onChange}set onChange(e){this._onChange=e}}customElements.define("m2-list-filter",e);class t extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;flex-direction:column;height:100%}m2-list-filter{box-shadow:0 3px 4px var(--border-color)}main>section{overflow:auto;flex:1 1 auto;height:0}main>section>*{cursor:pointer}</style> <main> <m2-list-filter></m2-list-filter> <section id="list"> <slot></slot> </section> </main>',this._list=e.getElementById("list"),this._slot=e.querySelector("slot"),this._slot.addEventListener("slotchange",this.slotChange),this._filter=e.querySelector("m2-list-filter"),this._filter.onChange=this.filterChange}connectedCallback(){this._filter.hidden=this._slot.children.length<=10}_onFilter=e=>{};get onFilter(){return this._onFilter}set onFilter(e){this._onFilter=e}filterChange=e=>{""==e&&(this._list.scrollTop=0),this._onFilter(e)};slotChange=()=>{this._filter.hidden="function"!=typeof this._onFilter||this._slot.assignedNodes().length<=10};clear=()=>{this._slot.assignedNodes().forEach((e=>this.removeChild(e))),this._filter.clear(),this._list.scrollTop=0}}customElements.define("m2-list",t)},889:()=>{class e extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{background-color:inherit;display:flex;flex-direction:row;align-items:center;gap:.5em}.text{flex:1 1 auto;overflow:hidden}#primary{display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:var(--text-color-normal,#000)}#primary:first-letter{text-transform:uppercase}#secondary{display:block;font-size:smaller;color:var(--text-color-disabled);overflow-wrap:break-word}</style> <main> <span id="icon" class="material-symbols-sharp"></span> <span class="text"> <span id="primary"></span> <span id="secondary"></span> </span> <section> <slot name="trailling"></slot> </section> </main>',this._icon=e.getElementById("icon"),this._primary=e.getElementById("primary"),this._secondary=e.getElementById("secondary")}static get observedAttributes(){return["data-primary","data-secondary","data-icon"]}attributeChangedCallback(e,t,o){switch(e){case"data-icon":this._icon.innerText=o;break;case"data-primary":this._primary.innerHTML=o;break;case"data-secondary":this._secondary.innerHTML=o}}}customElements.define("m2-list-item",e)},19:()=>{class e extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}button{padding:8px;border:0 none;color:inherit;background-color:transparent;border-radius:50%;user-select:none}button:not([disabled]):hover{background-color:var(--hover-color,rgb(0 0 0 /5%));cursor:pointer}button[disabled]{color:var(--text-color-disabled)}</style> <button class="material-symbols-sharp" type="button"></button>',this._main=e.querySelector("button")}static get observedAttributes(){return["data-icon","disabled"]}attributeChangedCallback(e,t,o){"data-icon"===e?this._main.innerText=o:"disabled"===e&&(null===o?this._main.removeAttribute("disabled"):this._main.setAttribute("disabled",""))}}customElements.define("m2-round-button",e)},489:(e,t,o)=>{o(19),o(136);class r extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{background-color:var(--background-color,#fff);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:var(--font-family);height:100%;width:400px}header{padding-bottom:3px;border-bottom:1px solid var(--border-color)}header h3{margin:0}#content{overflow:auto;flex:1 1 auto;height:0}@media (max-width:480px){main{top:0;left:0;height:100%;width:100%}}</style> <main> <header slot="header"> <m2-app-bar> <section slot="left"> <slot name="appBarLeft"></slot> </section> <h3 id="title" slot="middle">Side panel</h3> <section slot="right"> <slot name="appBarRight"></slot> </section> </m2-app-bar> </header> <section id="content"> <slot name="main"></slot> </section> </main>',this._title=e.getElementById("title")}static get observedAttributes(){return["data-title"]}attributeChangedCallback(e,t,o){"data-title"==e&&(this._title.innerText=o)}}window.customElements.define("m2-side-panel",r)},147:()=>{class e extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}#field{background-color:var(--hover-color,#d3d3d3);border-bottom:1px solid rgba(0,0,0,42%);display:flex;font-size:1em;position:relative}main:focus-within{border-bottom-color:var(--primary-color,#000)}input{background:0 0;border:0 none;border-bottom:1px solid transparent;caret-color:var(--primary-color,black);color:var(--text-color-normal,#000);flex:auto;font:inherit;padding:15px}input[readonly]{cursor:default}input:focus{outline:0;padding:23px 15px 7px 15px;border-color:var(--primary-color)}input::placeholder{font-size:1em;color:var(--text-color-disabled,#000)}input::selection{color:#fff;background:var(--primary-color)}input:focus::placeholder{visibility:hidden}input:not(:placeholder-shown){padding:23px 15px 7px 15px}label{color:var(--text-color-disabled,#000);font-size:12px;left:15px;pointer-events:none;position:absolute;top:6px;visibility:hidden}input:focus+label,input:not(:placeholder-shown)+label{visibility:visible}input:focus+label{color:var(--primary-color,#000)}input:invalid+label,input:invalid:focus{color:var(--background-error);border-color:var(--background-error)}input:required+label::after{content:\'*\'}#helper{font-size:smaller;margin:0 0 1em 1em}</style> <main> <section id="field"> <input type="text" placeholder="" spellcheck="false"> <label></label> </section> <section id="helper"></section> </main>',this._label=e.querySelector("label"),this._labelInnerText="",this._input=e.querySelector('input[type="text"]'),this._helper=e.getElementById("helper")}static get observedAttributes(){return["placeholder","readonly","required","value","helper"]}attributeChangedCallback(e,t,o){switch(e){case"placeholder":this._labelInnerText=o,this._input.setAttribute("placeholder",o),this._label.innerText=o;break;case"readonly":case"required":null==o?this._input.removeAttribute(e):this._input.setAttribute(e,"");break;case"value":this._input.setAttribute("value",o);break;case"helper":this._helper.innerText=o}this._input.hasAttribute("required")&&this._input.setAttribute("placeholder",`${this._labelInnerText}*`)}checkValidity=function(){return this._input.checkValidity()};focus=function(){this._input.focus()};get value(){return this._input.value}set value(e){this._input.value=e}}window.customElements.define("m2-textfield",e)},727:(e,t,o)=>{o.d(t,{Z:()=>r});const r=new class{_server=null;_serverChangeListener=[];_appContainer=null;_dispatchServerChange=()=>{this._serverChangeListener.forEach((e=>{e.call()}))};addListener=e=>{this._serverChangeListener.push(e)};get server(){return this._server}set server(e){e!=this._server&&(this._server=e,this._dispatchServerChange())}get appContainer(){return this._appContainer}set appContainer(e){this._appContainer=e}}},323:(e,t,o)=>{o.d(t,{Z:()=>i});var r=o(727);const i=new class{server_url="https://hl7.org/fhir";helpUrl(e){return`${this.server_url}/${r.Z.server.release}/${e.toLowerCase()}.html`}historyUrl(){return`${this.server_url}/${r.Z.server.release}//http.html#history.html`}async structureDefinition(e){const t=new URL(`${this.server_url}/${r.Z.server.release}/${e.toLowerCase()}.profile.json`);return(await fetch(t,{cache:"force-cache"})).json()}}},571:(e,t,o)=>{o.d(t,{Z:()=>r});const r=new class{KEY="preferences";get(e,t=null){const o=localStorage.getItem(this.KEY);let r=null;return null===o?t:(r=JSON.parse(o),r[e]||t)}set(e,t){const o=localStorage.getItem(this.KEY);let r=null;r=null!==o?JSON.parse(o):{},r[e]=t,localStorage.setItem(this.KEY,JSON.stringify(r))}}},655:(e,t,o)=>{o.d(t,{Z:()=>a});class r extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{background-color:#fff;border-radius:4px;box-shadow:0 11px 15px -7px rgb(0 0 0 / 20%),0 24px 38px 3px rgb(0 0 0 / 14%),0 9px 46px 8px rgb(0 0 0 / 12%);bottom:1em;margin:0 1em;min-width:344px;position:absolute}.overlay{align-items:center;background-color:rgba(0,0,0,85%);color:#fff;display:flex;flex-direction:row;font-family:var(--font-family);min-height:48px;padding:0 1em}main.error .overlay{background-color:var(--background-error)}#message{flex-grow:1;overflow:hidden;padding:0 1em;text-overflow:ellipsis;white-space:nowrap}slot[name=right]{margin-left:1em}@media (max-width:480px){main{min-width:unset;width:calc(100% - 2em)}}</style> <main> <div class="overlay"> <div id="message"> <slot></slot> </div> <slot name="right"></slot> </div> </main>',this._main=e.querySelector("main")}set type(e="info"){this._main.classList.add(e)}}customElements.define("m2-snackbar",r);var i=o(727);const a=new class{error(e){this.show(e,void 0,void 0,"error")}clear(){Array.from(i.Z.appContainer.querySelectorAll("m2-snackbar")).forEach((e=>e.remove()))}show(e,t,o=4e3,r="info"){let a=document.createElement("m2-snackbar");a.type=r,a.appendChild(document.createTextNode(e)),t&&(t.setAttribute("slot","right"),a.appendChild(t)),i.Z.appContainer.appendChild(a),setTimeout((()=>{a?.remove()}),o)}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__webpack_require__),o.exports}__webpack_require__.d=(e,t)=>{for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{__webpack_require__(136),__webpack_require__(840);var e=__webpack_require__(571);class t extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<m2-round-button title="" data-icon=""></m2-round-button>',e.addEventListener("click",this.onClick),this._themeButton=e.querySelector("m2-round-button")}connectedCallback(){this.setColorScheme(e.Z.get("colorScheme","auto"))}onClick=t=>{const o=["light","dark","auto"];let r=e.Z.get("colorScheme","auto"),i=o.findIndex((e=>e===r))+1;r=o[i%3],e.Z.set("colorScheme",r),this.setColorScheme(r)};setColorScheme=e=>{let t="",o=e;switch(e){case"dark":t="brightness_4";break;case"light":t="light_mode";break;default:"auto"===e&&(o=window?.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),t="brightness_auto"}this._themeButton.setAttribute("data-icon",t),this._themeButton.title=`Theme ${e}`,document.body.setAttribute("color-scheme",o)};get value(){return e.Z.get("colorScheme","auto")}}customElements.define("m2-color-scheme",t);class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"closed"}).innerHTML="<style>main{height:.7em;width:.7em;color:var(--primary-color);display:inline-block;border:.15em solid;border-radius:50%;border-top-color:transparent;animation:rotate 1s linear infinite}@keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style> <main/>"}}customElements.define("m2-circular-progress",o);class r extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{padding:1em}a{color:var(--primary-color)}</style> <m2-dialog id="aboutDialog" data-title="About FHIR Browser"> <m2-round-button id="closeButton" slot="appBarLeft" title="close" data-icon="close"></m2-round-button> <main> <p> FHIR Browser is and <a target="_blank" href="https://github.com/hprieurgarrouste/fhirBrowser.git">open source</a> utility developed by and intended for FHIR developers<br/>and all IT professionals who work with a FHIR server. <br/>Its purpose is to help users analyze FHIR servers and learn about their content. </p> <p> All content on the website is published under Creative Commons License <a target="_blank" href="https://github.com/hprieurgarrouste/fhirBrowser/blob/master/licence.md">CC-BY-NC-ND 4.0</a> </p> </main> </m2-dialog>',e.getElementById("closeButton").onclick=this.appDialogClose,e.querySelector("m2-dialog").onClose=e=>{e.preventDefault(),e.stopPropagation(),this.appDialogClose()}}appDialogClose=()=>this.hidden=!0}customElements.define("about-dialog",r),__webpack_require__(131);class i extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}header{display:flex;flex-direction:row;flex-wrap:nowrap}header>section{background-color:transparent;color:inherit;cursor:pointer;font:inherit;height:3em;line-height:3em;text-transform:uppercase;text-align:center;white-space:nowrap;width:100%;flex-grow:1;border-bottom:2px solid transparent;font-size:smaller}header>section:hover{background-color:var(--hover-color,rgba(0,0,0,5%))}header>section[selected]{border-bottom-color:var(--primary-color,#000);font-weight:700;color:var(--primary-color,#000)}::slotted(section){flex:1 1 auto;height:0;position:relative}</style> <main> <header></header> <slot></slot> </main>",e.onclick=e=>{e.preventDefault(),e.stopPropagation()},this._header=e.querySelector("header"),this._header.onclick=this.headerClick,this._slot=e.querySelector("slot"),this._slot.addEventListener("slotchange",this.slotChanged)}clear=()=>{for(;this._header.firstChild;)this._header.removeChild(this._header.lastChild)};slotChanged=()=>{this.clear(),this._slot.assignedElements().forEach((e=>{e.hidden=!0;const t=document.createElement("section");t.dataset.caption=e.dataset.caption,t.innerText=e.dataset.caption,this._header.appendChild(t)})),this.value||(this.value=this._header.querySelector("section:nth-child(1)")?.dataset.caption)};headerClick=({target:e})=>{this.value=e.dataset.caption,this.dispatchEvent(new CustomEvent("select",{bubbles:!1,cancelable:!1,detail:{caption:this.value}}))};get value(){return this._header.querySelector("section[selected]")?.dataset?.caption}set value(e){this._header.querySelector("section[selected]")?.removeAttribute("selected"),this._slot.assignedElements().forEach(((t,o)=>{t.dataset.caption==e?(t.hidden=!1,this._header.querySelector(`section:nth-child(${o+1})`)?.setAttribute("selected","")):t.hidden=!0}))}}customElements.define("m2-tabs",i),__webpack_require__(889);const a={account:"account_balance_wallet",accountreport:"account_balance_wallet",activitydefinition:"quiz",adverseevent:"emergency_home",allergyintolerance:"allergy",appointment:"today",appointmentresponse:"event_available",auditevent:"browse_activity",basic:"shapes",binary:"data_object",biologicallyderivedproduct:"fork_right",bodystructure:"skeleton",bundle:"format_paragraph",capabilitystatement:"campaign",careplan:"flowsheet",careteam:"groups",catalogentry:"description",chargeitem:"sell",chargeitemdefinition:"sell",claim:"request_quote",claimresponse:"task",clinicalimpression:"comment",codesystem:"data_array",communication:"mail",communicationrequest:"outgoing_mail",compartmentdefinition:"category",composition:"blender",conceptmap:"integration_instructions",condition:"coronavirus",consent:"done",contract:"contract",coverage:"shield",coverageeligibilityrequest:"policy",coverageeligibilityresponse:"verified_user",detectedissue:"bug_report",device:"electrical_services",devicedefinition:"inventory_2",devicemetric:"health_metrics",devicerequest:"unknown_document",deviceusestatement:"home_iot_device",diagnosticreport:"diagnosis",documentmanifest:"dataset",documentreference:"bookmarks",effectevidencesynthesis:"clinical_notes",encounter:"medical_services",enrollmentrequest:"contact_support",enrollmentresponse:"support_agent",endpoint:"location_on",episodeofcare:"blood_pressure",evidence:"search_check",evidencevariable:"troubleshoot",eventdefinition:"event_note",examplescenario:"video_library",explanationofbenefit:"speaker_notes",familymemberhistory:"family_restroom",familimemberhistory:"history",flag:"flag",goal:"sports_score",graphdefinition:"bar_chart",group:"group",guidanceresponse:"mark_email_read",healthcareservice:"mixture_med",implementationguide:"developer_guide",imagingstudy:"radiology",immunization:"immunology",immunizationevaluation:"microbiology",immunizationrecommendation:"mixture_med",insuranceplan:"payments",invoice:"receipt_long",library:"local_library",linkage:"link",list:"list",location:"pin_drop",manifest:"dataset",measure:"scale",measurereport:"lab_profile",media:"perm_media",medicinalproduct:"pill",medicinalproductauthorization:"pill",medicinalproductcontraindication:"pill_off",medicinalproductindication:"pill",medicinalproductingredient:"pill",medicinalproductinteraction:"pill",medicinalproductmanufactured:"pill",medicinalproductpackaged:"pill",medicinalproductpharmaceutical:"pill",medicinalproductundesirableeffect:"sick",medication:"medication",medicationadministration:"medication_liquid",medicationdispense:"prescriptions",medicationknowledge:"medication",medicationrequest:"medication",medicationstatement:"medication",messagedefinition:"developer_guide",messageheader:"code",molecularsequence:"genetics",namingsystem:"import_contacts",nutritionorder:"restaurant",observation:"description",observationdefinition:"file_present",operationdefinition:"function",operationoutcome:"function",organization:"local_hospital",organizationaffiliation:"account_tree",parameters:"settings",patient:"personal_injury",paymentnotice:"credit_card",paymentreconciliation:"credit_score",person:"person",plandefinition:"view_list",practitioner:"stethoscope",practitionerrole:"medical_information",procedure:"checklist",provenance:"deployed_code_history",questionnaire:"assignment",questionnaireresponse:"assignment_turned_in",relatedperson:"family_restroom",requestgroup:"group_work",researchdefinition:"lab_panel",researchelementdefinition:"labs",researchstudy:"biotech",researchsubject:"biotech",resource:"description",riskevidencesynthesis:"feedback",riskassessment:"problem",schedule:"calendar_month",searchparameter:"screen_search_desktop",servicerequest:"ecg",slot:"view_agenda",specimen:"colorize",specimendefinition:"colorize",structuredefinition:"developer_guide",structuremap:"table",subscription:"loyalty",substance:"science",substancenucleicacid:"science",substancepolymer:"science",substanceprotein:"science",substancereferenceinformation:"science",substancesourcematerial:"science",substancespecification:"science",supplydelivery:"deployed_code",supplyrequest:"deployed_code_history",task:"task",terminologycapabilities:"developer_guide",testreport:"integration_instructions",testscript:"code_blocks",valueset:"data_array",verificationresult:"new_releases",visionprescription:"ophthalmology"};__webpack_require__(718);class s extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML="<style>main{padding:.1em .5em;border-radius:1em;white-space:nowrap;color:var(--text-color-normal);background-color:inherit;border:1px solid var(--border-color);text-decoration:none;text-align:center;font-size:x-small;display:inline-block;min-width:2.4em}</style> <main></main>",this._content=e.querySelector("main"),this._value=null}connectedCallback(){this.render()}render=()=>{if(!this._content)return;if(null==this._value||null==this._value||0==this._value.length)return this._content.innerText="?",void(this.title=this._value);const e=function(e,t=0){const o=[{suffix:"T",threshold:1e12},{suffix:"B",threshold:1e9},{suffix:"M",threshold:1e6},{suffix:"K",threshold:1e3},{suffix:"",threshold:1}].find((t=>Math.abs(e)>=t.threshold));return o?(e/o.threshold).toFixed(t)+o.suffix:e}(this._value);this._content.innerText=e,this.title=this._value!=e?this._value:""};get value(){return this._value}set value(e){this._value=e,this.render()}}window.customElements.define("m2-badge",s);class l extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML="<style>main{padding:.75em 1em;background-color:inherit}main:hover,main[selected]{background-color:var(--hover-color,rgba(0,0,0,5%))}</style> <main> <slot></slot> </main>",this._main=e.querySelector("main")}static get observedAttributes(){return["selected"]}attributeChangedCallback(e,t,o){"selected"===e&&(null===o?this._main.removeAttribute("selected"):this._main.setAttribute("selected",""))}}customElements.define("m2-list-row",l);var n=__webpack_require__(727);class c extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML="<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}</style> <main> <m2-list></m2-list> </main>",this._list=e.querySelector("m2-list"),this._list.onFilter=this.appListFilter,this._list.onclick=this.appListClick,this._recent=new Set}load=e=>{this._list.clear(),this._recent.clear(),e?.rest[0]?.resource.filter((e=>e.interaction.map((e=>e.code)).includes("search-type"))).forEach((e=>{const t=document.createElement("m2-list-item");t.setAttribute("data-primary",e.type),t.setAttribute("data-icon",a[e.type.toLowerCase()]);const o=document.createElement("m2-list-row");o.setAttribute("data-type",e.type),o.appendChild(t),this._list.appendChild(o)}))};appListClick=({target:e})=>{const t=e.closest("m2-list-row");t&&(this._list.querySelector("m2-list-row[selected]")?.removeAttribute("selected"),t.setAttribute("selected",""),location.hash=`#/${t.dataset.type}?_summary=true&_format=json`)};appListFilter=e=>{this._list.childNodes.forEach((t=>t.hidden=!t.dataset.type.toLowerCase().includes(e.toLowerCase()))),this._list.querySelector("m2-list-row[selected]")?.scrollIntoView()};get value(){return this._list.querySelector("m2-list-row[selected]").dataset.type}set value(e){this.selectRow(this._list.querySelector(`m2-list-row[data-type="${e}"]`))}selectRow=e=>{const t=this._list.querySelector("m2-list-row[selected]");if("m2-list-row"!=e?.localName)return t?.removeAttribute("selected"),void(this._list.scrollTop=0);e!=t&&(t?.removeAttribute("selected"),e.setAttribute("selected",""),e.scrollIntoView());const o=e.querySelector("m2-list-item");o.querySelector('m2-badge[slot="trailling"]')||this.getCount(e.dataset.type).then((({total:e})=>{o.querySelector('m2-badge[slot="trailling"]')||o.appendChild(this.makeBadge(e))})),this._recent.add(e.dataset.type),this._recent.size>10&&this._recent.delete(this._recent.values().next().value)};getCount=async e=>{const t=new URL(`${n.Z.server.url}/${e}`);return t.searchParams.set("_summary","count"),t.searchParams.set("_format","json"),(await fetch(t,{headers:n.Z.server.headers})).json()};makeBadge=e=>{const t=document.createElement("m2-badge");return t.slot="trailling",t.value=null==e?"?":e,t}}customElements.define("server-resources",c);class d extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}m2-list>*{cursor:default}</style> <main> <m2-list></m2-list> </main>",this._list=e.querySelector("m2-list")}load=e=>{const t=(e,t)=>{if(void 0===t)return;const o=document.createElement("m2-list-item");o.setAttribute("data-primary",e);const r=document.createElement("m2-list-row");o.setAttribute("data-secondary",t),r.appendChild(o),this._list.appendChild(r)};this._list.clear(),t("copyright",e.copyright),t("description",e.description),t("fhirVersion",`${e.fhirVersion} (${n.Z.server.release})`);const o=document.createElement("UL");e.format.forEach((e=>{const t=document.createElement("LI");t.innerText=e,o.appendChild(t)})),t("format",o.outerHTML),e.implementation&&(t("implementation description",e.implementation.description),t("implementation name",e.implementation.name),t("implementation url",e.implementation.url)),t("language",e.language),t("name",e.name),t("publisher",e.publisher),e.software&&(t("software name",e.software.name),t("software version",e.software.version),t("software release date",e.software.releaseDate))}}customElements.define("server-capabilities",d);class h extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{display:flex;flex-direction:column;height:100%}header{padding:1em}m2-tabs{flex:1 1 auto}m2-tabs>section{border-top:1px solid var(--border-color)}</style> <main> <header> <m2-list-item id="serverTitle"></m2-list-item> </header> <m2-tabs> <section data-caption="Resource Types"> <server-resources></server-resources> </section> <section data-caption="Details"> <server-capabilities></server-capabilities> </section> </m2-tabs> </main>',this._serverTitle=e.getElementById("serverTitle"),this._appTabs=e.querySelector("m2-tabs"),this._serverResources=e.querySelector("server-resources"),this._serverCapabilities=e.querySelector("server-capabilities")}connectedCallback(){n.Z.addListener(this.serverChanged)}serverChanged=()=>{const e=n.Z.server;this._serverTitle.setAttribute("data-primary",e.serverCode),this._serverTitle.setAttribute("data-secondary",e.capabilities?.implementation?.description||e.capabilities?.software?.name||e.url),this._serverResources.load(e.capabilities),this._serverCapabilities.load(e.capabilities)};set value(e){this._appTabs.value="Resource Types",this._serverResources.value=e}}customElements.define("server-panel",h),__webpack_require__(19),__webpack_require__(489);var u=__webpack_require__(323);class p extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}</style> <m2-side-panel data-title="History"> <m2-round-button id="help" title="Help" data-icon="help" slot="appBarLeft"></m2-round-button> <m2-round-button id="close" title="Close" data-icon="close" slot="appBarRight"></m2-round-button> <main slot="main"> <m2-linear-progress></m2-linear-progress> <m2-list></m2-list> </main> </m2-side-panel>',e.getElementById("help").onclick=this.helpClick,this._list=e.querySelector("m2-list"),this._list.onclick=this.appListClick,this._progress=e.querySelector("m2-linear-progress"),e.getElementById("close").onclick=this.sidePanelClose,this._resourceType=null,this._resourceId=null}appListClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("m2-list-row");if(t){if(t.hasAttribute("selected"))return;this._list.querySelector("m2-list-row[selected]")?.removeAttribute("selected"),t.setAttribute("selected",""),location.hash=`#/${this._resourceType}/${this._resourceId}/_history/${t.dataset.versionid}`}else e.preventDefault(),e.stopPropagation()};helpClick=e=>{window.open(u.Z.historyUrl,"FhirBrowserHelp"),e.preventDefault(),e.stopPropagation()};sidePanelClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};load(e,t){e.interaction.find((({code:e})=>"vread"==e))&&(e.type==this._resourceType&&t==this._resourceId||(this._progress.hidden=!1,this._list.clear(),this._readResource(e.type,t).then((t=>{this._resourceType=e.type,this._resourceId=t.id;const o=t.meta?.versionId;this._readHistory(e.type,t.id).then((e=>{"Bundle"==e.resourceType&&"history"==e.type&&e.total>0&&e.entry.filter((e=>e?.resource?.meta)).sort(((e,t)=>{const o=new Date(e.resource.meta.lastUpdated);return new Date(t.resource.meta.lastUpdated)-o})).forEach((e=>{const t=document.createElement("m2-list-row");t.setAttribute("data-versionid",e.resource.meta.versionId),o==e.resource.meta.versionId&&t.setAttribute("selected","");const r=new Date(e.resource.meta.lastUpdated),i=document.createElement("m2-list-item");i.setAttribute("data-icon","history"),i.setAttribute("data-primary",`${r.toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"})}`),i.setAttribute("data-secondary",`${r.toLocaleString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"})}`),t.appendChild(i),this._list.appendChild(t)})),this._progress.hidden=!0}))}))))}_readResource=async(e,t)=>await n.Z.server.fetch(`/${e}/${t}`,{_format:"json"});_readHistory=async(e,t)=>await n.Z.server.fetch(`/${e}/${t}/_history`,{_format:"json",_summary:"text"})}customElements.define("resource-history",p);class m extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}</style> <m2-side-panel data-title="References"> <m2-round-button id="close" title="Close" data-icon="close" slot="appBarRight"></m2-round-button> <main slot="main"> <m2-list></m2-list> </main> </m2-side-panel>',this._list=e.querySelector("m2-list"),this._list.onclick=this.appListClick,this._list.onFilter=this.appListFilter,e.getElementById("close").onclick=this.sidePanelClose,this._resourceId=null}appListClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("m2-list-row");t&&(location.hash=`#/${t.dataset.target}?${t.dataset.search}=${this._resourceId}`)};appListFilter=e=>{const t=e.toLowerCase();this._list.childNodes.forEach((e=>{e.hidden=!(e.dataset.target.toLowerCase().includes(t)||e.dataset.search.toLowerCase().includes(t))}))};sidePanelClose=e=>{this.hidden=!0,e.preventDefault(),e.stopPropagation()};load(e,t){this._resourceId=t,this._list.clear();const o=n.Z.server.references(e.type);return o&&Object.entries(o).forEach((([e,t])=>{t.forEach((t=>{const o=document.createElement("m2-list-item");o.setAttribute("data-icon",a[e.toLowerCase()]),o.setAttribute("data-primary",`${e}.${t.name}`),o.setAttribute("data-secondary",t.documentation.length>100?`${t.documentation.substring(0,100)}...`:t.documentation);const r=document.createElement("m2-list-row");r.setAttribute("data-target",e),r.setAttribute("data-search",t.name),r.appendChild(o),this._list.appendChild(r)}))})),this._list.children.length>0}}customElements.define("resource-references",m);class _ extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{position:relative;display:inline-block;width:36px;height:20px;top:2px}main input{opacity:0;width:0;height:0}span{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--text-color-disabled);-webkit-transition:.4s;transition:.4s;border-radius:34px}span:before{position:absolute;content:"";height:14px;width:14px;left:3px;bottom:3px;background-color:#fff;-webkit-transition:.4s;transition:.4s;border-radius:50%}.checked span{background-color:var(--primary-color)}.focus span{box-shadow:0 0 1px var(--primary-color)}.checked span:before{transform:translateX(15px)}</style> <main> <span></span> </main>',e.addEventListener("click",this.clickHandler),this._main=e.querySelector("main")}static get observedAttributes(){return["data-checked"]}attributeChangedCallback(e,t,o){"data-checked"==e&&(null===o?this._main.classList.remove("checked"):this._main.classList.add("checked"))}clickHandler=e=>{this.hasAttribute("data-checked")?this.removeAttribute("data-checked"):this.setAttribute("data-checked","")}}window.customElements.define("m2-switch",_),__webpack_require__(898);var b=__webpack_require__(655);class g extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"closed"});t.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;flex-direction:column;height:100%}#content,resource-template-view{flex:1 1 auto;height:0;box-shadow:inset 0 3px 4px var(--border-color)}#content{--indent:32px;color:var(--text-color-normal,#000);font-family:monospace;overflow:auto;padding:1em;white-space:nowrap}#content dl{margin:0;padding-left:var(--indent)}#content dt{list-style-type:none}#content span{color:var(--json-viewer-values-color,#000);cursor:inherit}#content span.key{color:var(--json-viewer-properties-color,#000)}#content span.key::before{content:\'"\'}#content span.key::after{content:\'": \'}#content dt.array>span.value>dl>dt>span.key::before{content:\'\'}#content dt.array>span.value>dl>dt>span.key::after{content:\': \'}#content span.value a{color:inherit}#content span.value.string::before{content:\'"\'}#content span.value.string::after{content:\'"\'}#content dt.array>span.value::before{content:\'[\'}#content dt.array>span.value::after{content:\']\'}#content dt.object>span.value::before{content:\'{\'}#content dt.object>span.value::after{content:\'}\'}#content dt,#content dt.array>span.value::after,#content dt.object>span.value::after{padding-left:var(--indent)}#content dt.array,#content dt.object{padding-left:0}#content dt.array::before,#content dt.object::before{cursor:pointer;content:\'expand_less \';font-family:\'Material Symbols Sharp\';font-weight:700;line-height:inherit;vertical-align:middle;color:var(--text-color-disabled,#000)}#content dt:not(:last-child)::after{content:","}#content dt.collapsed::before{content:\'expand_more \'}#content dt.collapsed>span dl{display:none}#content dt.array.collapsed span.value::after{content:\'...]\';padding-left:0}#content dt.object.collapsed span.value::after{content:\'...}\';padding-left:0}footer{border-top:1px solid var(--border-color);padding:.5em;display:flex;flex-flow:row nowrap}footer>section:nth-child(2){flex-grow:1}footer span{display:inline-block}footer span:not(:last-child){border-right:1px solid var(--border-color);padding-right:.5em;margin-right:.25em}@media (max-width:480px){#content{line-height:2em}}</style> <main> <div id="content"></div> <resource-template-view hidden></resource-template-view> <footer> <section> <m2-round-button id="template-toggle" title="Template" data-icon="wysiwyg"></m2-round-button> </section> <section></section> <section> <span> <m2-round-button id="sort-toggle" title="Sort" data-icon="sort_by_alpha"></m2-round-button> </span> <span> <m2-round-button id="share" title="Share" data-icon="share"></m2-round-button> <m2-round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></m2-round-button> <m2-round-button id="download" title="Download" data-icon="download"></m2-round-button> </span> </section> </footer> </main>',this._resource=null,this._content=t.getElementById("content"),this._content.onclick=this.contentClick,this._preferences=e.Z.get("jsonView",{sorted:!1,template:!1}),this._sort=this._preferences.sorted,this._sortToggle=t.getElementById("sort-toggle"),this._sortToggle.onclick=this.sortToggleClick,this._templateToggle=t.getElementById("template-toggle"),this._template=!1,this._templateToggle.hidden=!0,this._templateView=t.querySelector("resource-template-view"),t.getElementById("download").onclick=this.downloadClick,t.getElementById("copy").onclick=this.copyClick,t.getElementById("share").onclick=this.shareClick}connectedCallback(){this.sortChange(),this.showTemplate()}sortToggleClick=()=>{this._sort=!this._sort,this._preferences.sorted=this._sort,e.Z.set("jsonView",this._preferences),this.sortChange()};sortChange=()=>{this._sortToggle.style.color=this._sort?"var(--primary-color)":"unset",this._resource&&(this.source=this._resource)};templateToggleClick=()=>{this._template=!this._template,this._preferences.template=this._template,e.Z.set("jsonView",this._preferences),this.showTemplate()};showTemplate=()=>{this._templateToggle.style.color=this._template?"var(--primary-color)":"unset",this._templateView.hidden=!this._template,this._content.hidden=this._template,this._sortToggle.style.visibility=this._template?"hidden":"visible"};contentClick=({target:e,offsetX:t,offsetY:o,ctrlKey:r})=>{if(e.classList.contains("array")||e.classList.contains("object")){const i=e.childNodes[0];if(i&&t<i.offsetLeft&&o<i.offsetHeight&&(e.classList.toggle("collapsed"),r)){const t=e.classList.contains("collapsed");Array.from(e.querySelectorAll("dt")).filter((e=>e.classList.contains("object")||e.classList.contains("array"))).forEach((e=>{t?e.classList.add("collapsed"):e.classList.remove("collapsed")}))}}};clear=()=>{this._content.scrollTo(0,0),this._content.innerHTML="Loading...",this._content.style.cursor="wait",this._resource=null};get resourceType(){return this._resource.resourceType}get resourceId(){return this._resource.id}get source(){return this._resource}set source(e){this._content.scrollTo(0,0),this._content.innerHTML="",this._content.appendChild(document.createTextNode("{")),this._content.appendChild(this.parse(e)),this._content.appendChild(document.createTextNode("}")),this._content.style.cursor="default",this._resource=e,this._templateView.source=e}parse=e=>{let t=document.createElement("dl"),o=Object.entries(e);return this._sort&&(o=o.sort()),o.forEach((([e,o])=>{const r=document.createElement("dt"),i=document.createElement("span");i.className="key",i.innerText=e,r.appendChild(i);const a=document.createElement("span");if(a.classList.add("value"),null===o)a.innerText="null";else if("string"==typeof o)if(a.classList.add("string"),"reference"===e){let e=o.replace(`${n.Z.server.url}`,"");e.startsWith("/")||e.startsWith("?")||(e=`/${e}`);let t=document.createElement("a");t.setAttribute("href",`#${e}`),t.appendChild(document.createTextNode(o)),a.appendChild(t)}else a.innerText=o;else"object"==typeof o?(r.classList.add(Array.isArray(o)?"array":"object"),a.appendChild(this.parse(o))):a.innerText=o;r.appendChild(a),t.appendChild(r)})),t};downloadClick=()=>{const e=JSON.stringify(this._resource),t=new File([e],this.resourceId,{type:"data:text/json;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${this.resourceType}#${t.name}.json`,r.click(),r.remove(),window.URL.revokeObjectURL(o)};copyClick=()=>{const e=JSON.stringify(this._resource);navigator.clipboard.writeText(e).then((function(){b.Z.show("Copying to clipboard was successful")}),(function(e){b.Z.error("Could not copy text")}))};shareClick=()=>{const e=JSON.stringify(this._resource),t=`${this.resourceType}.${this.resourceId}.txt`,o=new File([e],t,{type:"text/plain"});navigator.share({title:t,files:[o]})}}customElements.define("resource-json-view",g);class f extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;flex-direction:column;height:100%}#content{color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;white-space:pre;margin:0;box-shadow:inset 0 3px 4px var(--border-color)}footer{border-top:1px solid var(--border-color);padding:.5em;display:flex;flex-flow:row nowrap}footer>section:nth-child(2){flex-grow:1}footer span{display:inline-block}footer span:not(:last-child){border-right:1px solid var(--border-color);padding-right:.5em;margin-right:.25em}@media (max-width:480px){#content{line-height:2em}}</style> <main> <pre id="content"></pre> <footer> <section></section> <section></section> <section> <span> <m2-round-button id="share" title="Share" data-icon="share"></m2-round-button> <m2-round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></m2-round-button> <m2-round-button id="download" title="Download" data-icon="download"></m2-round-button> </span> </section> </footer> </main>',this._content=e.getElementById("content"),e.getElementById("download").onclick=this.downloadClick,e.getElementById("copy").onclick=this.copyClick,e.getElementById("share").onclick=this.shareClick,this._resource=null}clear=()=>{this._content.scrollTo(0,0),this._content.innerHTML="Loading...",this._content.style.cursor="wait",this._resource=null};get resourceType(){return this._resource.match(/rdf:type\s*fhir:(\w+)/)[1]}get resourceId(){return this._resource.match(/fhir:Resource.id\s*\[\s*fhir:value\s*"([^"]+)"\s*\]/)[1]}get source(){return this._resource}set source(e){this._content.scrollTo(0,0),this._content.innerText=e,this._content.style.cursor="default",this._resource=e}downloadClick=()=>{const e=this._resource,t=new File([e],this.resourceId,{type:"data:text/plain;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${this.resourceType}#${t.name}.txt`,r.click(),r.remove(),window.URL.revokeObjectURL(o)};copyClick=()=>{const e=this._resource;navigator.clipboard.writeText(e).then((function(){SnackbarService.show("Copying to clipboard was successful")}),(function(e){SnackbarService.error("Could not copy text")}))};shareClick=()=>{const e=this._resource,t=`${this.resourceType}.${this.resourceId}.txt`,o=new File([e],t,{type:"text/plain"});navigator.share({title:t,files:[o]})}}customElements.define("resource-ttl-view",f);class y extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"closed"});t.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{display:flex;flex-direction:column;height:100%}#content{--indent:32px;color:var(--text-color-normal,#000);flex:1 1 auto;font-family:monospace;height:0;overflow:auto;padding:1em;margin:0;white-space:nowrap;box-shadow:inset 0 3px 4px var(--border-color)}#content dl{margin:0;padding-left:var(--indent)}#content #content>dl{padding-left:0}#content dt{list-style-type:none}#content span.key{color:var(--xml-viewer-nodes-color,#000)}#content span.key::before{content:\'<\'}#content span.key::after{content:\'>\'}#content span.attributes{color:var(--xml-viewer-attributes-color,#000)}#content span.values{color:var(--xml-viewer-values-color,#000)}#content span.values a{color:inherit}#content span.key.end{padding-left:var(--indent)}#content dt,#content dt.object>span.value::after{padding-left:var(--indent)}#content dt.object{padding-left:0}#content dt.object::before{cursor:pointer;content:\'expand_less \';font-family:\'Material Symbols Sharp\';font-weight:700;line-height:inherit;vertical-align:middle;color:var(--text-color-disabled,#000)}#content dt.collapsed::before{content:\'expand_more \'}#content dt.collapsed>span dl{display:none}#content dt.object.collapsed span.value::after{content:\'...\';padding-left:0}#content dt.object.collapsed span.key.end{padding-left:0}footer{border-top:1px solid var(--border-color);padding:.5em;display:flex;flex-flow:row unwrap}footer>section:nth-child(2){flex-grow:1}footer span{display:inline-block}footer span:not(:last-child){border-right:1px solid var(--border-color);padding-right:.5em;margin-right:.25em}@media (max-width:480px){#content{line-height:2em}}</style> <main> <div id="content"></div> <footer> <section></section> <section></section> <section> <span> <m2-round-button id="sort-toggle" title="Sort" data-icon="sort_by_alpha"></m2-round-button> </span> <span><m2-round-button id="share" title="Share" data-icon="share"></m2-round-button> <m2-round-button id="copy" title="Copy to clipboard" data-icon="content_copy"></m2-round-button> <m2-round-button id="download" title="Download" data-icon="download"></m2-round-button> </span> </section> </footer> </main>',this._resource=null,this._content=t.getElementById("content"),this._content.onclick=this.contentClick,this._preferences=e.Z.get("xmlView",{sorted:!1}),this._sort=this._preferences.sorted,this._sortToggle=t.getElementById("sort-toggle"),this._sortToggle.onclick=this.sortToggleClick,t.getElementById("download").onclick=this.downloadClick,t.getElementById("copy").onclick=this.copyClick,t.getElementById("share").onclick=this.shareClick}connectedCallback(){this.sortChange()}sortToggleClick=()=>{this._sort=!this._sort,e.Z.set("xmlView",{sorted:this._sort}),this.sortChange()};sortChange=()=>{this._sortToggle.style.color=this._sort?"var(--primary-color)":"unset",this._resource&&(this.source=this._resource)};contentClick=({target:e,offsetX:t,offsetY:o,ctrlKey:r})=>{if(e.classList.contains("object")){const i=e.childNodes[0];if(i&&t<i.offsetLeft&&o<i.offsetHeight&&(e.classList.toggle("collapsed"),r)){const t=e.classList.contains("collapsed");Array.from(e.querySelectorAll("dt")).filter((e=>e.classList.contains("object"))).forEach((e=>{t?e.classList.add("collapsed"):e.classList.remove("collapsed")}))}}};clear=()=>{this._content.scrollTo(0,0),this._content.innerHTML="Loading...",this._content.style.cursor="wait",this._resource=null};get resourceType(){return this._resource?.documentElement?.nodeName}get resourceId(){return this._resource?.documentElement?.querySelector("id[value]")?.getAttribute("value")}get source(){return this._resource}set source(e){this._content.scrollTo(0,0),this._content.innerHTML=this.parse(e).outerHTML,this._content.style.cursor="default",this._resource=e}parse=e=>{let t=document.createElement("dl"),o=Array.from(e.children);return this._sort&&o.sort(((e,t)=>e.nodeName.localeCompare(t.nodeName))),o.forEach((e=>{const o=document.createElement("dt");let r=document.createElement("span");r.className="key",r.innerText=e.nodeName,o.appendChild(r),e.attributes.length&&Array.from(e.attributes).forEach((t=>{let o=document.createElement("span");o.className="attributes",o.innerText=` ${t.nodeName}=`,r.appendChild(o);let i=document.createElement("span");if(i.className="values","reference"===e.nodeName&&"value"===t.nodeName){let e=t.nodeValue.replace(`${n.Z.server.url}`,"");e.startsWith("/")||e.startsWith("?")||(e=`/${e}`);let o=document.createElement("a");o.setAttribute("href",`#${e}`),o.appendChild(document.createTextNode(`"${t.nodeValue}"`)),i.appendChild(o)}else i.innerText=`"${t.nodeValue}"`;o.appendChild(i)}));const i=document.createElement("span");i.classList.add("value"),e.children.length?(o.classList.add("object"),i.innerHTML=this.parse(e).outerHTML,o.appendChild(i),r=document.createElement("span"),r.className="key end",r.innerText=`/${e.nodeName}`,o.appendChild(r)):r.innerHTML+="/",t.appendChild(o)})),t};downloadClick=()=>{const e=(new XMLSerializer).serializeToString(this._resource),t=new File([e],this.resourceId,{type:"data:text/xml;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${this.resourceType}#${t.name}.xml`,r.click(),r.remove(),window.URL.revokeObjectURL(o)};copyClick=()=>{const e=(new XMLSerializer).serializeToString(this._resource);navigator.clipboard.writeText(e).then((function(){SnackbarService.show("Copying to clipboard was successful")}),(function(e){SnackbarService.error("Could not copy text")}))};shareClick=()=>{const e=(new XMLSerializer).serializeToString(this._resource),t=`${this.resourceType}.${this.resourceId}.txt`,o=new File([e],t,{type:"text/plain"});navigator.share({title:t,files:[o]})}}customElements.define("resource-xml-view",y);class v extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}#resourceCnt{display:flex;flex-direction:column;height:100%;flex:auto;width:0}main{flex:1 1 auto;height:0}#title{margin:0;overflow:hidden;text-overflow:ellipsis}#formView,#jsonView,#ttlView,#xmlView{flex:1 1 auto;height:0}#header.error{background-color:var(--background-error,transparent);color:#fff}#error{padding:1em}resource-history,resource-references{border-left:1px solid var(--border-color)}@media (max-width:480px){resource-history,resource-references{background-color:var(--background-color,#fff);position:relative;width:100%}}</style> <div id="wrapper"> <section id="resourceCnt"> <header> <m2-app-bar id="header"> <m2-round-button slot="left" id="help" title="Help" data-icon="help"></m2-round-button> <h3 slot="middle" id="title"></h3> <m2-round-button slot="right" id="referencesToggle" title="References" data-icon="article_shortcut"></m2-round-button> <m2-round-button slot="right" id="historyToggle" title="History" data-icon="history"></m2-round-button> </m2-app-bar> </header> <main> <m2-tabs></m2-tabs> </main> </section> <resource-references slot="main" hidden></resource-references> <resource-history slot="main" hidden></resource-history> </div>',e.getElementById("help").onclick=this.helpClick,this._referencesToggle=e.getElementById("referencesToggle"),this._referencesToggle.onclick=this.referenceToggleClick,this._referencesPanel=e.querySelector("resource-references"),this._historyDisabled=null,this._historyToggle=e.getElementById("historyToggle"),this._historyToggle.onclick=this.historyToggleClick,this._historyPanel=e.querySelector("resource-history"),this._tabs=e.querySelector("m2-tabs"),this._tabs.addEventListener("select",this.tabSelect),this._title=e.getElementById("title"),this._resourceType=null,this._resourceId=null,this._views={}}connectedCallback(){n.Z.addListener(this.serverChanged),new MutationObserver(this.panelHiddenObserver).observe(this._referencesPanel,{attributes:!0}),new MutationObserver(this.panelHiddenObserver).observe(this._historyPanel,{attributes:!0})}panelHiddenObserver=e=>{e.forEach((({type:e,attributeName:t,target:o})=>{"attributes"==e&&"hidden"==t&&(o==this._historyPanel?this._historyToggle.hidden=this._historyDisabled||!o.hidden:o==this._referencesPanel&&(this._referencesToggle.hidden=!o.hidden))}))};tabSelect=({detail:e})=>{const t=e.caption,o=location.hash.match(/\?([^?]+)$/);if(o?.length>0){const e=new URLSearchParams(o[1]);e.set("_format",t),location.hash=location.hash.replace(/\?[^?]+$/,`?${e.toString()}`)}else location.hash=`${location.hash}?_format=${t}`};referenceToggleClick=()=>{this._referencesPanel.hidden&&(this._historyPanel.hidden=!0,this._referencesPanel.load(this._resourceType,this._resourceId)),this._referencesPanel.hidden=!this._referencesPanel.hidden};historyToggleClick=()=>{this._historyPanel.hidden&&(this._referencesPanel.hidden=!0,this._historyPanel.load(this._resourceType,this._resourceId)),this._historyPanel.hidden=!this._historyPanel.hidden};helpClick=()=>{window.open(`${u.Z.helpUrl(this._resourceType.type)}#resource`,"FhirBrowserHelp")};serverChanged=()=>{for(;this._tabs.firstChild;)this._tabs.removeChild(this._tabs.lastChild);this._views={};const e=n.Z.server;if(e.isFormatEnable("json")){const e=document.createElement("resource-json-view"),t=document.createElement("section");t.dataset.caption="json",t.appendChild(e),this._tabs.appendChild(t),this._views.json=e}if(e.isFormatEnable("xml")){const e=document.createElement("resource-xml-view"),t=document.createElement("section");t.dataset.caption="xml",t.appendChild(e),this._tabs.appendChild(t),this._views.xml=e}if(e.isFormatEnable("ttl")){const e=document.createElement("resource-ttl-view"),t=document.createElement("section");t.dataset.caption="ttl",t.appendChild(e),this._tabs.appendChild(t),this._views.ttl=e}};set source(e){let t;if(t=e instanceof Document?"xml":"object"==typeof e?"json":"ttl",t){const o=this._views[t];o.source=e;let r=o.resourceType;this._title.innerText=r;const i=o.resourceId;i==this._resourceId&&r==this._resourceType?.type||(this._resourceType=n.Z.server.capabilities.rest[0].resource.find((e=>e.type===r)),this._resourceId=i,Object.entries(this._views).filter((([e])=>e!=t)).forEach((([,e])=>e.clear()))),this._tabs.value=t}window.matchMedia("(max-width: 480px)").matches&&(this._referencesPanel.hidden=!0,this._historyPanel.hidden=!0),this._historyDisabled=null==this._resourceType?.interaction.find((({code:e})=>"vread"==e)),this._historyDisabled?(this._historyPanel.hidden=!0,this._historyToggle.hidden=!0):this._historyToggle.hidden=!this._historyPanel.hidden,this._historyPanel.hidden||this._historyPanel.load(this._resourceType,this._resourceId),this._referencesPanel.hidden||this._referencesPanel.load(this._resourceType,this._resourceId)}get resourceType(){return this._resourceType}}customElements.define("fhir-resource",v),__webpack_require__(696);class w extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML="<style>main{display:flex;flex-direction:column;height:100%}m2-list{flex:1 1 auto;height:0}</style> <main> <m2-list></m2-list> </main>",this._list=e.querySelector("m2-list"),this._list.onclick=this.appListClick}appListClick=e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest("m2-list-row");t&&(this.value=t.dataset.id,this.dispatchEvent(new CustomEvent("serverchanged",{bubbles:!0,cancelable:!0,detail:{serverCode:t.dataset.id}})))};load(e){this._list.clear(),Object.keys(e).sort(((e,t)=>e.localeCompare(t))).forEach((t=>{const o=document.createElement("m2-list-item");o.setAttribute("data-primary",t),o.setAttribute("data-secondary",e[t].url);const r=document.createElement("m2-list-row");r.setAttribute("data-id",t),r.appendChild(o),this._list.appendChild(r)}))}get value(){return this._list.querySelector("m2-list-row[selected]")?.dataset.id}set value(e){this._list.querySelector("m2-list-row[selected]")?.removeAttribute("selected");const t=this._list.querySelector(`m2-list-row[data-id="${e}"]`);t&&(t.setAttribute("selected","true"),t.scrollIntoView())}}customElements.define("server-list",w);class x extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{position:absolute;top:0;left:0;background-color:rgba(0,0,0,32%);min-height:100%;min-width:100%}.surface{background-color:var(--background-color,#fff);border-radius:4px;position:absolute;left:50%;top:50%;transform:translateX(-50%) translateY(-50%)}.overlay{background-color:rgba(255,255,255,4%);color:var(--text-color-normal,#fff);display:flex;flex-direction:column;font-family:var(--font-family);height:100%}h2{margin:.5em 1em}footer{padding:9px 16px;text-align:right;overflow:visible}@media (max-width:480px){.surface{width:90%}.overlay{background-color:transparent}}</style> <main> <div class="surface"> <div class="overlay"> <h2></h2> <slot></slot> <footer> <m2-button id="btnCancel">cancel</m2-button> <m2-button id="btnOk">ok</m2-button> </footer> </div> </div> </main>',e.querySelector("main").onclick=this.onClose,e.querySelector(".surface").onclick=e=>e.stopPropagation(),this._title=e.querySelector("h2"),this._btnOk=e.getElementById("btnOk"),this._btnOk.onclick=this.validateClick,e.getElementById("btnCancel").onclick=this.onClose}onClose=e=>{this.hidden=!0};validateClick=e=>{this.onValidate(e),this.hidden=!0};_onValidate=e=>{};get onValidate(){return this._onValidate}set onValidate(e){this._onValidate=e}static get observedAttributes(){return["data-title","data-ok-text"]}attributeChangedCallback(e,t,o){"data-title"===e?this._title.innerText=o:"data-ok-text"===e&&this._btnOk.setAttribute("value",o)}}window.customElements.define("m2-confirm",x),__webpack_require__(147);class k extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%;font-family:var(--font-family)}#content{flex:1 1 auto;height:0;padding:1em;overflow-y:auto;min-width:40em}#formDialog footer{border-top:1px solid var(--border-color)}footer{padding:9px 16px;text-align:right;overflow:hidden}p{margin:0;padding:1em}.authMethod{display:flex;flex-flow:row wrap;gap:1em;padding-bottom:1em}.authMethod label{font-family:inherit;font-size:inherit;margin-right:1em;white-space:nowrap}@media (max-width:480px){#content{min-width:unset}}</style> <m2-dialog id="formDialog" centered> <m2-round-button slot="appBarRight" id="formDelete" title="Delete" data-icon="delete"></m2-round-button> <main> <section id="content"> <m2-textfield id="key" placeholder="Code" required></m2-textfield> <m2-textfield id="url" placeholder="Url" required></m2-textfield> <div class="authMethod"> <label for="authNo">No Auth <input type="radio" id="authNo" name="authMethod" value="No Auth" checked="checked"/> </label> <label for="authApi">API Key <input type="radio" id="authApi" name="authMethod" value="API Key"/> </label> <label for="authBasic">Basic <input type="radio" id="authBasic" name="authMethod" value="Basic"/> </label> <label for="authOauth">OAuth 2 <input type="radio" id="authOauth" name="authMethod" value="OAuth 2"/> </label> </div> <section id="apiSection" hidden> <m2-textfield id="apiKey" placeholder="Key" required></m2-textfield> <m2-textfield id="apiValue" placeholder="Value" required></m2-textfield> </section> <section id="basicSection" hidden> <m2-textfield id="basicUsername" placeholder="Username" required></m2-textfield> <m2-textfield id="basicPassword" placeholder="Password" required></m2-textfield> </section> <section id="oauthSection" hidden> <m2-textfield id="oauthTokenurl" placeholder="Access Token URL" required></m2-textfield> <m2-textfield id="oauthClientid" placeholder="Client ID" required></m2-textfield> <m2-textfield id="oauthClientsecret" placeholder="Client Secret" required></m2-textfield> <m2-textfield id="oauthGranttype" placeholder="Grant Type" value="client_credentials" required readonly="readonly"></m2-textfield> </section> </section> <footer> <m2-button id="formCancel">cancel</m2-button> <m2-button id="formOk">apply</m2-button> </footer> </main> </m2-dialog> <m2-confirm data-ok-text="delete" hidden> <p>Delete this configuration?</p> </m2-confirm>',this._appDialog=e.querySelector("m2-dialog"),this._appDialog.onClose=this.appDialogClose,this._content=e.getElementById("content"),e.querySelectorAll('input[name="authMethod"]').forEach((e=>{e.addEventListener("change",this.authMethodChange)})),e.querySelector("main").onkeydown=this.mainKeyDown,this._key=e.getElementById("key"),this._url=e.getElementById("url"),this._authNo=e.getElementById("authNo"),this._authApi=e.getElementById("authApi"),this._authBasic=e.getElementById("authBasic"),this._authOauth=e.getElementById("authOauth"),this._apiSection=e.getElementById("apiSection"),this._apiKey=e.getElementById("apiKey"),this._apiValue=e.getElementById("apiValue"),this._basicSection=e.getElementById("basicSection"),this._basicUsername=e.getElementById("basicUsername"),this._basicPassword=e.getElementById("basicPassword"),this._oauthSection=e.getElementById("oauthSection"),this._oauthTokenurl=e.getElementById("oauthTokenurl"),this._oauthClientid=e.getElementById("oauthClientid"),this._oauthClientsecret=e.getElementById("oauthClientsecret"),this._oauthGranttype=e.getElementById("oauthGranttype"),this._appConfirm=e.querySelector("m2-confirm"),this._appConfirm.onValidate=this.deleteConfirm,e.getElementById("formOk").onclick=this.formOkClick,e.getElementById("formCancel").onclick=this.formCancelClick,this._formDelete=e.getElementById("formDelete"),this._formDelete.onclick=this.formDeleteClick}static get observedAttributes(){return["data-title"]}attributeChangedCallback(e,t,o){"data-title"==e&&this._appDialog.setAttribute("data-title",o)}appDialogClose=e=>{this.onCancel(e),e.preventDefault(),e.stopPropagation()};formOkClick=e=>{this.checkValidity()&&this.onOk(e)&&(this.hidden=!0)};formCancelClick=e=>{this.onCancel(e)};formDeleteClick=()=>{this._appConfirm.hidden=!1};deleteConfirm=e=>{this.onDelete(e),this.hidden=!0};mainKeyDown=e=>{["Enter","NumpadEnter"].includes(e.code)&&this.checkValidity()&&this.onOk(e)&&(this.hidden=!0)};authMethodChange=()=>{const e=this._content.querySelector("input[name='authMethod']:checked").value;this._apiSection.hidden="API Key"!==e,this._basicSection.hidden="Basic"!==e,this._oauthSection.hidden="OAuth 2"!==e};_onOk=e=>{this.hidden=!0};get onOk(){return this._onOk}set onOk(e){this._onOk=e}_onCancel=e=>{this.hidden=!0};get onCancel(){return this._onCancel}set onCancel(e){this._onCancel=e}_onDelete=()=>{this.hidden=!0};get onDelete(){return this._onDelete}set onDelete(e){this._onDelete=e}checkValidity=function(){if(e(this._key)&&e(this._url))switch(this._content.querySelector("input[name='authMethod']:checked")){case this._authNo:return!0;case this._authApi:return e(this._apiKey)&&e(this._apiValue);case this._authBasic:return e(this._basicUsername)&&e(this._basicPassword);case this._authOauth:return e(this._oauthTokenurl)&&e(this._oauthClientid)&&e(this._oauthClientsecret)&&e(this._oauthGranttype)}return!1;function e(e){return!!e.checkValidity()||(e.focus(!0),!1)}};get value(){const e=this._content.querySelector("input[name='authMethod']:checked");let t={serverCode:this._key.value,url:this._url.value,auth:{method:"noauth",setup:{}}};switch(e){case this._authApi:t.auth.method="apikey",t.auth.setup.key=this._apiKey.value,t.auth.setup.value=this._apiValue.value;break;case this._authBasic:t.auth.method="basic",t.auth.setup.username=this._basicUsername.value,t.auth.setup.password=this._basicPassword.value;break;case this._authOauth:t.auth.method="oauth2",t.auth.setup.access_token_url=this._oauthTokenurl.value,t.auth.setup.client_id=this._oauthClientid.value,t.auth.setup.client_secret=this._oauthClientsecret.value,t.auth.setup.grant_type=this._oauthGranttype.value}return t}set value({serverCode:e,server:t}){switch(e?(this._appDialog.setAttribute("data-title",e),this._formDelete.hidden=!1):(this._appDialog.setAttribute("data-title","New"),this._formDelete.hidden=!0),this.clear(),this._key.value=e,this._url.value=t.url,t?.auth?.method){case"apikey":this._authApi.checked=!0,this._apiKey.value=t.auth.setup.key,this._apiValue.value=t.auth.setup.value;break;case"basic":this._authBasic.checked=!0,this._basicUsername.value=t.auth.setup.username,this._basicPassword.value=t.auth.setup.password;break;case"oauth2":this._authOauth.checked=!0,this._oauthTokenurl.value=t.auth.setup.access_token_url,this._oauthClientid.value=t.auth.setup.client_id,this._oauthClientsecret.value=t.auth.setup.client_secret,this._oauthGranttype.value=t.auth.setup.grant_type;break;default:this._authNo.checked=!0}this.authMethodChange()}clear(){this._content.querySelectorAll("m2-textfield").forEach((e=>e.value="")),this._oauthGranttype.value="client_credentials"}}customElements.define("server-form",k);const E=new class{KEY="conf";setAll(e){localStorage.setItem(this.KEY,JSON.stringify(e))}async getAll(){let e=localStorage.getItem(this.KEY);return null===e?await fetch("./default.conf",{cache:"reload"}).then((e=>e.json())).then((e=>(localStorage.setItem(this.KEY,JSON.stringify(e)),e))):JSON.parse(e)}async get(e){return await this.getAll().then((t=>t[e]))}};class C extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>main{border-top:1px solid var(--border-color);display:flex;flex-direction:column;height:100%;min-width:400px}#list{flex:1 1 auto;height:0}#setupAdd{position:absolute;bottom:4em;right:1em;background-color:var(--primary-color);border-radius:100%;color:#fff;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}footer{border-top:1px solid var(--border-color);padding:9px 16px;text-align:right;overflow:hidden}m2-dialog #setupToggle,m2-dialog.edit #setupAdd,m2-dialog.edit footer{display:block}m2-dialog #setupAdd,m2-dialog footer,m2-dialog.edit #setupToggle{display:none}#setupClose{display:none}@media (max-width:480px){main{min-width:none}#setupClose{display:block}}</style> <m2-dialog id="serverDialog" data-title="Connections"> <m2-round-button slot="appBarLeft" id="setupClose" title="close" data-icon="close"></m2-round-button> <m2-round-button slot="appBarRight" id="setupToggle" title="setup" data-icon="edit"></m2-round-button> <main> <section id="list"> <server-list></server-list> <m2-round-button id="setupAdd" title="add" data-icon="add"></m2-round-button> </section> <footer> <m2-button id="setupCancel">cancel</m2-button> <m2-button id="setupOk">save</m2-button> </footer> </main> </m2-dialog> <server-form hidden></server-form>',this._editMode=!1,this._list=e.querySelector("server-list"),this._list.addEventListener("serverchanged",this.serverListClick),this._form=e.querySelector("server-form"),this._form.onOk=this.serverFormOk,this._form.onDelete=this.serverFormDelete,this._appDialog=e.querySelector("m2-dialog"),this._appDialog.onClose=e=>{e.preventDefault(),e.stopPropagation(),this.appDialogClose()},e.getElementById("setupAdd").onclick=this.setupAddClick,e.getElementById("setupCancel").onclick=this.setupCancel,e.getElementById("setupOk").onclick=this.setupOk,e.getElementById("setupClose").onclick=this.appDialogClose,e.getElementById("setupToggle").onclick=()=>{this.editMode=!0}}connectedCallback(){this.editMode=!1,this.loadConf()}loadConf=()=>{E.getAll().then((e=>{this._conf=e,this._list.load(e),this._list.value=n.Z.server?.serverCode}))};setupOk=()=>{E.setAll(this._conf),this.editMode=!1,this.loadConf()};setupCancel=()=>{this.editMode=!1,this.loadConf()};setupAddClick=()=>{this.value="",this._form.value={serverCode:"",server:{url:""}},this._form.hidden=!1};serverListClick=e=>{const t=e.detail.serverCode,o=this._conf[t];this.editMode?(this._form.value={serverCode:t,server:o},this._form.hidden=!1):(this.editMode=!1,this.hidden=!0,e.preventDefault(),e.stopPropagation(),this._onSelect({code:t,configuration:o}))};_onSelect=()=>{};get onSelect(){return this._onSelect}set onSelect(e){this._onSelect=e}serverFormDelete=()=>{const e=this._form.value.serverCode;return delete this._conf[e],this._list.load(this._conf),!0};serverFormOk=()=>{const e=this._form.value,t=this.value,o=e.serverCode;if(delete e.serverCode,t)delete this._conf[t];else if(this._conf[o])return b.Z.show("this configuration already exists",void 0,void 0,"error"),!1;return this._conf[o]=e,this._list.load(this._conf),!0};appDialogClose=()=>{this.editMode=!1,this.hidden=!0};get value(){return this._list.value}set value(e){this._list.value=e}get editMode(){return this._editMode}set editMode(e){this._editMode=e,e?this._appDialog.classList.add("edit"):this._appDialog.classList.remove("edit")}}customElements.define("server-dialog",C);class T extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}.surface{background-color:var(--background-color,#fff);border-radius:4px;box-shadow:1px 1px 5px 1px var(--border-color)}.overlay{background-color:rgba(255,255,255,4%);color:var(--text-color-normal,#fff);font-family:var(--font-family);height:100%}main{padding:1em}header{background-color:inherit;display:flex;flex-direction:row;align-items:center}header>i:not(:empty){padding-right:.5em}header .text{flex:1 1 auto;overflow:hidden}#primary{display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:var(--text-color-normal,#000);text-transform:lowercase;font-weight:700}#primary:first-letter{text-transform:uppercase}#secondary{display:block;font-size:smaller;color:var(--text-color-disabled);overflow-wrap:break-word}</style> <div class="surface"> <div class="overlay"> <main> <header> <i class="material-symbols-sharp"></i> <span class="text"> <span id="primary"></span> <span id="secondary"></span> </span> <section> <slot name="media"></slot> </section> </header> <m2-list-item></m2-list-item> <section> <slot></slot> </section> </main> </div> </div>',this._headerIcon=e.querySelector("header>i"),this._headerPrimary=e.getElementById("primary"),this._headerSecondary=e.getElementById("secondary")}static get observedAttributes(){return["data-primary","data-secondary","data-icon"]}attributeChangedCallback(e,t,o){switch(e){case"data-icon":this._headerIcon.innerText=o;break;case"data-primary":this._headerPrimary.innerText=o;break;case"data-secondary":this._headerSecondary.innerText=o}}}customElements.define("m2-card",T);class S extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}#wrapper{display:flex;flex-direction:row;height:100%;overflow:hidden}main{display:flex;flex-direction:column;height:100%;flex:auto;width:0}#title{margin:0;overflow:hidden;text-overflow:ellipsis}main>section{padding:1em;flex:1 1 auto;height:0;overflow:auto}#issue{display:flex;flex-direction:row;flex-wrap:wrap;gap:1em}#issue m2-card{max-width:40%}#text{font-size:smaller;font-family:monospace}#text table{width:100%;border-collapse:collapse}#text table,#text td,#text th{border:1px solid var(--border-color)}</style> <div id="wrapper"> <main> <header> <m2-app-bar> <m2-round-button id="help" title="Help" data-icon="help" slot="left"></m2-round-button> <h3 slot="middle" id="title">OperationOutcome</h3> </m2-app-bar> </header> <section> <h4>Issue</h4> <section id="issue"></section> <h4>Text</h4> <section id="text"></section> </section> </main> </div>',this._resource=null,e.getElementById("help").onclick=this.helpClick,this._main=e.querySelector("main"),this._content=this._main.querySelector("main>section"),this._issue=e.getElementById("issue"),this._text=e.getElementById("text")}helpClick=()=>{window.open(u.Z.helpUrl(this._resource.resourceType),"FhirBrowserHelp")};clear=()=>{this._content.scrollTo(0,0),this._issue.innerHTML="",this._text.innerHTML="",this._main.style.cursor="wait",this._resource=null};get resourceType(){return this._resource.resourceType}get resourceId(){return null}get source(){return this._resource}set source(e){const t={information:"info",warning:"warning",error:"error",fatal:"dangerous"};this.clear(),e.issue.forEach((e=>{const o=document.createElement("p");o.innerText=e.diagnostics;const r=document.createElement("m2-card");r.setAttribute("data-icon",t[e.severity]||"error"),r.setAttribute("data-primary",e.code),r.setAttribute("data-secondary",e.severity),r.appendChild(o),this._issue.appendChild(r)})),this._text.innerHTML=e.text?.div||"",this._main.style.cursor="default",this._resource=e}}customElements.define("fhir-operation-outcome",S);class L{_url="";_method=L.None;_headers={};_apiKey=null;_apiValue=null;_basicUsername=null;_basicPassword=null;_oauthTokenurl=null;_oauthclientid=null;_oauthClientsecret=null;_oauthGranttype=null;static METHODS={None:"noauth",APIKey:"apikey",Basic:"basic",OAuth2:"oauth2"};constructor(e=null){if(null!=e)switch(this.url=e.url,this.method=e.auth?.method||L.METHODS.None,this.headers=e.headers,this._method){case L.METHODS.APIKey:this.apiKey=e.auth.setup?.key,this.apiValue=e.auth.setup?.value;break;case L.METHODS.Basic:this.basicUsername=e.auth.setup?.username,this.basicPassword=e.auth.setup?.password;break;case L.METHODS.OAuth2:this.oauthTokenUrl=e.auth.setup?.access_token_url,this.oauthClientId=e.auth.setup?.client_id,this.oauthClientSecret=e.auth.setup?.client_secret,this.oauthGrantType=e.auth.setup?.grant_type;case L.METHODS.None:}}toString=()=>{const e={url:this._url,auth:{method:this._method,setup:{}}};switch(this._method){case L.METHODS.APIKey:e.auth.setup.key=this._apiKey,e.auth.setup.value=this._apiValue;break;case L.METHODS.Basic:e.auth.setup.username=this._basicUsername,e.auth.setup.password=this._basicPassword;break;case L.METHODS.OAuth2:e.auth.setup.access_token_url=this._oauthTokenurl,e.auth.setup.client_id=this._oauthclientid,e.auth.setup.client_secret=this._oauthClientsecret,e.auth.setup.grant_type=this._oauthGranttype;case L.METHODS.None:}return e};get url(){return this._url}set url(e){new URL(e),this._url=e}get method(){return this._method}set method(e=L.METHODS.None){if(!Object.entries(L.METHODS).find((([,t])=>t==e)))throw new Error(`authentication method '${e}' not supported`);this._method=e}get headers(){return this._headers}set headers(e){this._headers=e}get apiKey(){return this._apiKey}set apiKey(e){this._apiKey=e}get apiValue(){return this._apiValue}set apiValue(e){this._apiValue=e}get basicUsername(){return this._basicUsername}set basicUsername(e){this._basicUsername=e}get basicPassword(){return this._basicPassword}set basicPassword(e){this._basicPassword=e}get oauthTokenUrl(){return this._oauthTokenurl}set oauthTokenUrl(e){this._oauthTokenurl=e}get oauthClientId(){return this._oauthclientid}set oauthClientId(e){this._oauthclientid=e}get oauthClientSecret(){return this._oauthClientsecret}set oauthClientSecret(e){this._oauthClientsecret=e}get oauthGrantType(){return this._oauthGranttype}set oauthGrantType(e){this._oauthGranttype=e}}class M{_code=null;_serverConfiguration=null;_capabilities=null;_fhirReferences=null;_headers={};constructor(e="",t=null){null!=t&&(this._code=e,this._serverConfiguration=t,Object.assign(this._headers,t.headers))}get serverCode(){return this._code}get url(){return this._serverConfiguration.url}get headers(){return this._headers}get capabilities(){return this._capabilities}get release(){return{"5.0.0":"R5","4.6.0":"R5","4.5.0":"R5","4.4.0":"R5","4.3.0":"R4B","4.2.0":"R5","4.1.0":"R4B","4.0.1":"R4","3.5.0":"R4","3.3.0":"R4","3.2.0":"R4","3.0.2":"STU3","3.0.1":"STU3","3.0.0":"STU3"}[this._capabilities.fhirVersion]||null}connect=async()=>{switch(this._serverConfiguration.method){case L.METHODS.APIKey:this._headers[this._serverConfiguration.apiKey]=this._serverConfiguration.apiValue;break;case L.METHODS.Basic:let e=btoa(`${this._serverConfiguration.basicUsername}:${this._serverConfiguration.basicPassword}`);this._headers.Authorization=`Basic ${e}`;break;case L.METHODS.OAuth2:this._oauth2_getToken().then((e=>{this._headers.Authorization=`${e.token_type} ${e.access_token}`}));case L.METHODS.None:}this._capabilities=await this._fetchCapabilities(),this._references=await this._parseReferences(this._capabilities)};fetch=async(e,t={})=>{const o=new URL(`${this._serverConfiguration.url}${e}`);return Object.entries(t).forEach((([e,t])=>o.searchParams.set(e,t))),(await fetch(o,{headers:this._headers})).json()};_oauth2_getToken=async()=>{const e={"Content-type":"application/x-www-form-urlencoded"};if("client_credentials"==this._serverConfiguration.oauthGrantType){const t=btoa(`${this._serverConfiguration.oauthClientId}:${this._serverConfiguration.oauthClientSecret}`);e.Authorization=`Basic ${t}`}const t={grant_type:this._serverConfiguration.oauthGrantType};return(await fetch(this._serverConfiguration.oauthTokenUrl,{headers:e,method:"POST",body:new URLSearchParams(t).toString()})).json()};_fetchCapabilities=async()=>{const e=new URL(`${this._serverConfiguration.url}/metadata`);e.searchParams.set("_format","json");try{const t=await fetch(e,{cache:"reload",headers:this._headers});return t.ok?t.json():Promise.reject(t)}catch(e){return Promise.reject(e)}};references=e=>this._references[e];_parseReferences=async e=>{const t={},o=e.rest[0].resource,r=await this._fetchAllReferences();return e.rest[0].resource.forEach((e=>{const i=r[this.release][e.type];if(i){const r=structuredClone(i);Object.entries(r).forEach((([e,t])=>{let i=o.find((t=>e==t.type));i&&i.searchParam?(r[e].forEach(((t,o)=>{const a=i.searchParam.find((e=>t==e.name));a?r[e][o]={name:t,documentation:a.documentation}:r[e].splice(o,1)})),0===r[e].length&&delete r[e]):delete r[e]})),0!==Object.keys(r).length&&(t[e.type]=r)}})),t};_fetchAllReferences=async()=>{if(!this._fhirReferences){const e=await fetch("./assets/references.json");this._fhirReferences=await e.json()}return this._fhirReferences};isFormatEnable(e){let t=[];switch(e){case"json":t.push("json"),t.push("application/fhir+json"),t.push("html/json");break;case"xml":t.push("xml"),t.push("application/fhir+xml"),t.push("html/xml");break;case"ttl":t.push("ttl"),t.push("application/x-turtle"),t.push("html/turtle")}return this._capabilities.format.some((e=>t.includes(e)))}}"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js");class A extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});e.innerHTML='<style>@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp&family=Roboto+Flex);*{scrollbar-width:thin;scrollbar-color:var(--scroll-color) var(--background-color)}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--background-color)}::-webkit-scrollbar-thumb{background-color:var(--scroll-color);border-radius:20px}:host{background-color:var(--background-color,#fff);color:var(--text-color-normal,rgb(0,0,0,87%));display:flex;flex-direction:column;font-family:var(--font-family);font-size:1rem;font-weight:400;height:100vh;line-height:1.5}header{background-color:var(--primary-color,#000);color:#fff}h3{margin:0}main{flex:1 1 auto;height:0;overflow:hidden}main>div{display:flex;flex-direction:row;height:100%}server-panel{border-right:1px solid var(--border-color,gray);flex:none;transition:all .3s;margin-left:0;width:300px}server-panel.hidden{transition:all .3s;margin-left:-300px}#bdy{flex:1 1 auto;overflow:hidden;width:0;position:relative;block-size:100%;display:grid;grid-auto-flow:column;grid-auto-columns:100%;grid-auto-rows:100%}#waiting{align-items:center;background-color:rgba(0,0,0,32%);display:flex;font-size:5em;justify-content:center;left:0;min-height:100%;min-width:100%;position:absolute;top:0;visibility:hidden}@media (max-width:480px){server-panel{background-color:var(--background-color,#fff);position:static;width:100%}server-panel.hidden{margin-left:-100%}}</style> <header> <m2-app-bar id="header" caption=""> <m2-round-button slot="left" id="navigation" title="Menu" data-icon="menu" hidden></m2-round-button> <span id="appTitle" slot="middle">FHIR Browser</span> <m2-color-scheme slot="right"></m2-color-scheme> <m2-round-button slot="right" id="serverDialogToggle" title="Connections" data-icon="database"></m2-round-button> <m2-round-button slot="right" id="aboutDialogToggle" title="About" data-icon="help"></m2-round-button> </m2-app-bar> </header> <main> <div> <server-panel class="hidden"></server-panel> <div id="bdy" style="visibility:hidden"> <fhir-bundle id="bundle"></fhir-bundle> <fhir-resource id="resource"></fhir-resource> <fhir-operation-outcome></fhir-operation-outcome> </div> </div> </main> <server-dialog hidden></server-dialog> <div id="waiting"> <m2-circular-progress></m2-circular-progress> </div>',n.Z.appContainer=e,this._shadow=e,this._serverPanel=e.querySelector("server-panel"),this._body=e.getElementById("bdy"),this._navigationToggle=e.getElementById("navigation"),this._navigationToggle.onclick=()=>this._serverPanel.classList.toggle("hidden"),this._waiting=e.getElementById("waiting"),this._serverDialog=e.querySelector("server-dialog"),this._serverDialog.onSelect=this.connect,e.getElementById("serverDialogToggle").onclick=()=>{this._serverDialog.value=n.Z.server.serverCode,this._serverDialog.hidden=!1},e.getElementById("aboutDialogToggle").onclick=this.aboutDialogToggleClick,this._bundleView=e.querySelector("fhir-bundle"),this._resourceView=e.querySelector("fhir-resource"),this._operationOutcomeView=e.querySelector("fhir-operation-outcome")}aboutDialogToggleClick=()=>{let e=this._shadow.querySelector("about-dialog");e?e.hidden=!1:(e=document.createElement("about-dialog"),this._shadow.appendChild(e))};fetchHash=async e=>{b.Z.clear();const t=new URL(`${n.Z.server.url}${e}`),o=setTimeout((()=>{this._waiting.style.visibility="visible"}),500);try{const e=await fetch(t,{headers:n.Z.server.headers});e.ok||b.Z.error(`${e.status} ${e.statusText}`),this._body.style.visibility="visible";const o=e.headers.get("Content-Type");let r,i;if(o.includes("json"))i=await e.json(),r=i.resourceType;else if(o.includes("xml"))i=(new DOMParser).parseFromString(await e.text(),"application/xml"),r=i.documentElement.nodeName;else{i=await e.text();const t=i.match(/rdf:type\s+fhir:(\w+)/);t&&(r=t[1])}if(!r)throw new Error("Unknown response format");"OperationOutcome"==r?(this._bundleView.hidden=!0,this._resourceView.hidden=!0,this._operationOutcomeView.hidden=!1,this._operationOutcomeView.source=i):"Bundle"==r?(this._bundleView.hidden=!1,this._resourceView.hidden=!0,this._operationOutcomeView.hidden=!0,this._bundleView.source=i,this._serverPanel.value=this._bundleView.resourceType.type):(this._bundleView.hidden=!0,this._resourceView.hidden=!1,this._operationOutcomeView.hidden=!0,this._resourceView.source=i,this._serverPanel.value=this._resourceView.resourceType.type)}catch(e){b.Z.show(e,void 0,void 0,"error")}finally{clearTimeout(o),this._waiting.style.visibility="hidden"}};locationHandler=()=>{let e=window.location.hash.replace("#","").trim();e.length?(window.matchMedia("(max-width: 480px)").matches&&this._serverPanel.classList.add("hidden"),this.fetchHash(e)):(this._body.style.visibility="hidden",this._serverPanel.classList.remove("hidden"))};connectedCallback(){window.addEventListener("hashchange",this.locationHandler);const t=e.Z.get("server");t?E.get(t).then((e=>{this.connect({code:t,configuration:e})})):this._serverDialog.hidden=!1}connect=({code:t,configuration:o})=>{this._waiting.style.visibility="visible";const r=new L(o),i=new M(t,r);i.connect().then((()=>{n.Z.server=i,b.Z.show(`Connected to "${t}" server.`),e.Z.set("server",t),this._navigationToggle.hidden=!1,location.hash?location.hash="":this.locationHandler()})).catch((e=>{b.Z.error(`An error occurred while connecting to the server "${t}"`),console.log(e)})).finally((()=>{this._waiting.style.visibility="hidden"}))}}customElements.define("fhir-browser",A)})()})();